<!DOCTYPE html>
<!-- saved from url=(0040)https://bbs.kanxue.com/thread-281889.htm -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="XiunoBBS 4.0">
	<meta name="keywords" content="[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?">
	<meta name="description" content="[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?">
	<meta name="application-name" content="[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?-Android安全-看雪-安全社区|安全招聘|kanxue.com">
	<meta name="csrf-token" content="7ed2325bb406617b71ea0810435ffc74">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<title>[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?-Android安全-看雪-安全社区|安全招聘|kanxue.com</title>

	<link rel="shortcut icon" href="https://bbs.kanxue.com/view/img/favicon.ico">
	<link rel="icon" sizes="32x32" href="https://bbs.kanxue.com/view/img/favicon.ico">
	<link rel="Bookmark" href="https://bbs.kanxue.com/view/img/favicon.ico">
	<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bootstrap.css">

	<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bootstrap-bbs.css">
	
	<!-- <link rel="stylesheet" href="/view/css/bootstrap-icon.css"> -->
	<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/kanxue.css">

	<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/iconfont.css">

	<style>
		
		@media only screen and (max-width: 780px) {
			.card > .card-body {
				padding: 0.3rem 0.5rem;
			}
			#body {
				padding: 0.5rem 0.5rem;
			}
			.container {
				padding-left: 0;
				padding-right: 0; 
			}
		}
		.content_box ul.nav .nav-link.active {
			border-bottom: 3px solid #0099ee;
		}
		.avatar-3 {
			width: 3.5rem;
			height: 3.5rem;
			border-radius: 3.5rem;
		}
		.avatar-2_4 {
			width: 2.4rem;
			height: 2.4rem;
			border-radius: 2.4rem;
		}
		main#body {
			/* background: #e9ecef; */
			background: #f7f9fa;
		}
		@media only screen and (max-width: 993px) {
			.changeThemeBox {
				display: none;
			}
		}
	</style>
	
	<style>
		/* .photo_frame {
			padding: 0.36rem;
		}

		.photo_frame::after {
			content: '';
			
			background-size: 102%;
			background-position: right top;
			background-repeat: no-repeat;
			width: 100%;
			height: 100%;
			
			display: inline-block;
			vertical-align: middle;
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			z-index: 1;
		}
		
		.photo_frame_image1::after {
			background-image: url(view/img/20photo_frame1.png);
		}
	
		.photo_frame_image2::after {
			background-image: url(view/img/20photo_frame2.png);
		}
		.photo_frame_image3::after {
			background-image: url(view/img/20photo_frame3.png);
		} */

	</style>
	<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/vip.css">
	    <link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/user_tree.css" type="text/css">
    <link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/folder-tree.css" type="text/css">
<style>
/*
box-shadow: 0 0 5px red;
*/
@keyframes xndigest {
	0% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
	20% { color: orange; text-shadow: 0 0 3px #FFE1AD;} 
	40% { color: green; text-shadow: 0 0 3px #B3FFAF;} 
	65% { color: blue; text-shadow: 0 0 3px #AFE4FF;} 
	80% { color: purple; text-shadow: 0 0 3px #FFC9F3;} 
	100% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
}

/*水晶闪烁效果 占内存*/
i.icon-diamond.flash{color: #D53D38;  /*animation: xndigest 5s linear infinite;*/ }

i.icon-digest-1 {  text-shadow: 0 0 3px #AFE4FF; }
i.icon-digest-2 {  text-shadow: 0 0 3px #FFF177; }
i.icon-digest-3 {  text-shadow: 0 0 3px #FF8D8D; }
.icon-digest-1:before { content: "\f219";  color: #5BC0DE;} /* "\f0a5" */
.icon-digest-2:before { content: "\f219";  color: #ECA541;}
.icon-digest-3:before { content: "\f219"; color: #D53D38;}
.icon-digest-3:afteer { content: "精"; color: #D53D38;}
</style><style>
.deleted div.subject > a { text-decoration: line-through; color: grey !important; }
.deleted div.message { text-decoration: line-through; color: grey !important; }
</style><style>
/*
.toggle_more {
	max-height: 100px;
}
*/
.update_log_list a.update_log_history, 
.update_log_list a.update_log_delete {
	display: none;
}

.update_log_list > li:hover {
	background: var(--gray-300);
}
.update_log_list > li:hover > a.update_log_history, 
.update_log_list > li:hover > a.update_log_delete {
	display: inline-block;
}

</style><style>
.icon-new { width: 26px; height: 12px; display: inline-block; background: url(view/img/new.gif)}
</style>

<link rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/layer.css" id="layuicss-skinlayercss"><script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/f.txt"></script><script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/syntax.js.下载"></script><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A9wSqI5i0iwGdf6L1CERNdmsTPgVu44ewj8QxTBYgsv1LCPUVF7YmWOvTappqB1139jAymxUW/RO8zmMqo4zlAAAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A+d7vJfYtay4OUbdtRPZA3y7bKQLsxaMEPmxgfhBGqKXNrdkCQeJlUwqa6EBbSfjwFtJWTrWIioXeMW+y8bWAgQAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MzY4MTI4MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"></head>

<body><svg aria-hidden="true" style="position: absolute; width: 0px; height: 0px; overflow: hidden;"><symbol id="icon-group_101" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#93E4D8"></path><path d="M569.6 224v588.8h57.6V224zM1004.8 505.6v300.8h-57.6v-25.6h-204.8v32h-57.6V505.6h320z m-57.6 57.6h-70.4v160h70.4V563.2z m-128 0h-76.8v160h76.8V563.2zM851.2 364.8l-44.8 32c32 32 64 64 83.2 96l44.8-32c-19.2-25.6-44.8-57.6-83.2-96zM460.8 300.8V704h64V300.8z" fill="#FFFFFF"></path><path d="M761.6 358.4h256v-64h-224l12.8-44.8c0-6.4 6.4-12.8 6.4-19.2l-57.6-12.8c-32 89.6-70.4 153.6-108.8 204.8l38.4 51.2c32-32 57.6-76.8 76.8-115.2zM1363.2 268.8v480h-57.6V704h-76.8v57.6h-64V268.8h198.4zM1305.6 512h-76.8v140.8h76.8V512z m0-192h-76.8v134.4h76.8V320zM1459.2 460.8l-51.2 32c38.4 57.6 70.4 115.2 89.6 160l51.2-38.4c-19.2-44.8-51.2-96-89.6-153.6z" fill="#FFFFFF"></path><path d="M1600 806.4h-115.2l-12.8-57.6h108.8c12.8 0 25.6-6.4 25.6-25.6V390.4h-211.2v-57.6h211.2V224h64v108.8h70.4v57.6h-70.4v345.6c-6.4 51.2-32 70.4-70.4 70.4z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_102" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#81E2ED"></path><path d="M608 499.2c12.8 25.6 32 51.2 51.2 83.2l38.4-51.2c-25.6-32-57.6-64-83.2-96v-32h70.4v-57.6H608V224h-64v121.6H460.8v57.6h83.2C524.8 473.6 492.8 544 448 601.6l25.6 64c32-44.8 57.6-102.4 70.4-160v300.8h64V499.2z" fill="#FFFFFF"></path><path d="M972.8 243.2v38.4c-12.8 51.2-25.6 102.4-32 140.8h76.8v32c-12.8 83.2-44.8 160-83.2 217.6 32 32 70.4 64 115.2 89.6l-44.8 51.2c-38.4-32-76.8-57.6-108.8-96-38.4 38.4-83.2 70.4-134.4 96l-38.4-57.6c51.2-25.6 96-51.2 128-89.6-32-44.8-57.6-89.6-70.4-140.8-19.2 121.6-57.6 217.6-108.8 281.6l-51.2-38.4c70.4-83.2 108.8-224 108.8-409.6v-57.6h-64v-57.6h307.2z m-64 57.6h-121.6v89.6c12.8 89.6 51.2 166.4 102.4 236.8 32-44.8 51.2-96 64-147.2h-89.6c12.8-38.4 25.6-83.2 32-134.4l12.8-44.8zM1644.8 608v204.8h-57.6v-25.6h-256v25.6h-57.6V608h371.2z m-57.6 51.2h-256v76.8h256v-76.8z" fill="#FFFFFF"></path><path d="M1363.2 326.4l57.6 12.8c-6.4 12.8-12.8 25.6-25.6 32h230.4v51.2c-25.6 32-57.6 64-102.4 89.6 64 25.6 134.4 38.4 217.6 38.4l-12.8 57.6c-102.4-6.4-192-25.6-268.8-64-76.8 32-166.4 57.6-281.6 76.8l-25.6-57.6c96-12.8 179.2-32 243.2-57.6-25.6-12.8-51.2-32-70.4-51.2l-76.8 57.6-38.4-44.8c57.6-38.4 108.8-83.2 153.6-140.8z m185.6 96h-185.6c32 25.6 57.6 44.8 96 57.6 38.4-12.8 70.4-32 89.6-57.6z" fill="#FFFFFF"></path><path d="M1715.2 262.4v128h-64V320h-409.6v76.8h-64v-128H1408l-19.2-38.4 70.4-12.8c6.4 12.8 12.8 32 19.2 44.8h236.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_7" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#C1D5E4"></path><path d="M563.2 486.4v51.2h435.2v-51.2H563.2zM512 576v57.6h249.6v102.4c0 12.8-6.4 19.2-19.2 19.2-19.2 0-32 0-51.2-6.4l12.8 57.6h57.6c38.4 0 64-19.2 64-57.6V633.6h230.4V576H512z m409.6 76.8l-32 44.8c44.8 25.6 89.6 64 128 108.8l32-51.2c-32-38.4-76.8-76.8-128-102.4z m-294.4 0c-32 38.4-70.4 70.4-121.6 102.4l38.4 51.2c51.2-32 89.6-70.4 128-115.2l-44.8-38.4zM512 262.4V320h96c-32 38.4-64 70.4-108.8 96l32 51.2c32-25.6 64-57.6 83.2-102.4v102.4h57.6V364.8c12.8 12.8 32 32 51.2 57.6l32-51.2c-19.2-12.8-51.2-32-76.8-51.2H768v-57.6h-89.6v-51.2h-64v51.2H512z m281.6 0V320h64c-25.6 38.4-57.6 70.4-96 96l32 51.2c32-32 57.6-70.4 83.2-115.2v115.2h57.6V345.6c19.2 38.4 51.2 76.8 83.2 115.2l38.4-51.2c-38.4-25.6-70.4-57.6-89.6-89.6h89.6v-57.6h-108.8v-51.2h-57.6v51.2h-96z m691.2-44.8h64v204.8h192v57.6h-192v243.2h230.4v57.6h-569.6v-57.6h102.4V326.4h64v390.4h121.6V217.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_104" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#72D6FF"></path><path d="M460.8 384v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320H1024V384h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H460.8zM1216 480v332.8h64V384c25.6-44.8 44.8-89.6 57.6-140.8l-57.6-25.6c-25.6 96-70.4 185.6-128 262.4l19.2 64c12.8-25.6 32-44.8 44.8-64zM1644.8 371.2c-12.8 44.8-25.6 83.2-44.8 115.2l51.2 19.2c19.2-32 32-70.4 44.8-115.2l-51.2-19.2zM1395.2 371.2l-51.2 19.2c12.8 32 25.6 70.4 38.4 108.8l51.2-12.8c-12.8-44.8-25.6-76.8-38.4-115.2z" fill="#FFFFFF"></path><path d="M1337.6 294.4h160V224h57.6v70.4h160v57.6h-160v70.4c0 32 0 64-6.4 89.6H1728v57.6h-160c38.4 70.4 96 134.4 179.2 185.6l-44.8 51.2c-83.2-64-140.8-134.4-179.2-211.2-32 96-102.4 166.4-198.4 211.2l-38.4-51.2c96-25.6 160-89.6 185.6-179.2h-153.6v-57.6h166.4c6.4-25.6 6.4-51.2 6.4-76.8V352h-160v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_114" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFA966"></path><path d="M1030.4 352h-121.6c19.2-25.6 44.8-64 64-102.4l-64-25.6c-19.2 44.8-44.8 89.6-70.4 128H601.6l38.4-19.2c-19.2-38.4-38.4-70.4-57.6-102.4l-57.6 25.6c19.2 25.6 44.8 57.6 64 89.6H473.6v153.6h57.6V409.6h435.2v96h57.6V352z" fill="#FFFFFF"></path><path d="M576 448v51.2h256l-19.2 12.8c-25.6 12.8-51.2 25.6-83.2 38.4v51.2h-256v57.6h256v76.8c0 12.8-6.4 25.6-19.2 25.6H633.6l12.8 57.6h83.2c38.4 0 57.6-19.2 57.6-57.6v-102.4H1024v-57.6h-236.8V576c51.2-25.6 96-51.2 134.4-76.8V448H576zM736 217.6l-57.6 25.6c19.2 32 44.8 64 64 102.4l51.2-25.6c-19.2-38.4-38.4-70.4-57.6-102.4zM1459.2 224v64H1600v57.6h-140.8v64H1536c51.2-38.4 96-76.8 134.4-121.6l19.2-25.6 44.8 32c-25.6 32-51.2 57.6-83.2 89.6l-25.6 19.2h115.2v57.6h-192l-25.6 12.8c-19.2 12.8-38.4 25.6-64 32l-19.2 6.4h217.6v294.4h-64v-12.8h-256v25.6h-64V588.8l-102.4 38.4-25.6-57.6c89.6-19.2 172.8-51.2 249.6-89.6l32-12.8h-268.8v-64h230.4v-57.6H1216v-57.6h172.8v-64h70.4z m147.2 454.4h-256v57.6h256v-57.6z m0-102.4h-256v57.6h256V576z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_21" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#63AFFF"></path><path d="M729.6 217.6C652.8 300.8 563.2 371.2 448 422.4l32 57.6c108.8-57.6 204.8-128 268.8-211.2 76.8 89.6 160 160 268.8 211.2l32-57.6c-102.4-44.8-198.4-115.2-275.2-204.8h-44.8z" fill="#FFFFFF"></path><path d="M736 390.4v332.8H627.2V480h-57.6v243.2H480v64h537.6v-64h-217.6V582.4h166.4v-57.6h-166.4V390.4zM1356.8 224v499.2h-185.6v64h569.6v-64h-185.6V224h-64v499.2h-76.8V224z" fill="#FFFFFF"></path><path d="M1670.4 339.2c-25.6 115.2-57.6 211.2-96 281.6l57.6 19.2c38.4-83.2 70.4-179.2 96-288l-57.6-12.8zM1235.2 339.2c32 83.2 64 185.6 89.6 294.4l-57.6 12.8c-19.2-102.4-51.2-198.4-83.2-288l51.2-19.2z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_118" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FF997D"></path><path d="M473.6 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 313.6l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-51.2h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H473.6zM1190.4 300.8V640h57.6V300.8z" fill="#FFFFFF"></path><path d="M1292.8 211.2v307.2c0 108.8-38.4 192-108.8 243.2l44.8 38.4c76.8-57.6 121.6-153.6 121.6-281.6V211.2h-57.6zM1388.8 230.4h358.4v57.6h-153.6v70.4H1728v313.6c0 38.4-19.2 64-51.2 64h-44.8l-12.8-57.6 38.4 6.4c12.8-6.4 19.2-12.8 19.2-25.6V416H1600v384h-57.6v-384h-76.8v320H1408V358.4h134.4V288h-153.6v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_2" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#798FEC"></path><path d="M1011.2 505.6v204.8h-256V505.6h256z m-57.6 51.2h-140.8v102.4h140.8V556.8z" fill="#FFFFFF"></path><path d="M480 294.4H576V211.2h57.6v83.2h89.6v51.2H633.6v83.2h89.6v57.6h-76.8v76.8h76.8v57.6h-76.8v96h6.4c32 12.8 115.2 19.2 236.8 19.2h19.2c57.6 0 96 0 128-6.4l-6.4 64h-108.8c-160 0-262.4-6.4-307.2-25.6-32-12.8-57.6-38.4-83.2-76.8-6.4 38.4-19.2 76.8-32 108.8l-44.8-38.4c25.6-76.8 38.4-153.6 44.8-243.2l51.2 6.4c0 38.4-6.4 70.4-6.4 96 12.8 25.6 32 44.8 44.8 57.6v-192H473.6v-57.6h96V345.6H480v-51.2z" fill="#FFFFFF"></path><path d="M742.4 294.4v-57.6H1024c0 115.2-6.4 179.2-19.2 204.8-19.2 25.6-38.4 32-64 32h-51.2l-12.8-51.2h51.2c12.8 0 25.6-6.4 25.6-19.2 6.4-12.8 6.4-51.2 6.4-108.8h-83.2c-6.4 44.8-19.2 76.8-32 102.4-19.2 32-44.8 57.6-76.8 83.2l-44.8-44.8c32-19.2 51.2-38.4 70.4-64 12.8-19.2 19.2-44.8 25.6-76.8h-76.8zM1312 217.6h57.6V384h38.4v64h-147.2v70.4h121.6v281.6h-57.6V576h-64c-6.4 89.6-25.6 166.4-51.2 211.2l-51.2-32c25.6-57.6 38.4-153.6 38.4-281.6V230.4h57.6V384h51.2V217.6z" fill="#FFFFFF"></path><path d="M1708.8 217.6l25.6 51.2c-76.8 19.2-153.6 32-249.6 38.4v83.2h230.4v51.2c-6.4 89.6-32 160-70.4 217.6 32 38.4 64 70.4 108.8 89.6l-32 51.2c-44.8-25.6-83.2-51.2-115.2-96-32 38.4-70.4 70.4-121.6 96l-25.6-51.2c44.8-25.6 83.2-51.2 115.2-89.6-32-57.6-57.6-128-70.4-204.8h-12.8v51.2c0 121.6-25.6 224-64 294.4l-44.8-44.8c32-57.6 51.2-140.8 51.2-249.6V256c102.4 0 192-12.8 275.2-38.4zM1664 454.4h-108.8c12.8 64 32 115.2 51.2 153.6 32-51.2 44.8-102.4 57.6-153.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_8" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#CDA6F4"></path><path d="M550.4 268.8l185.6 512H832l185.6-512h-83.2l-147.2 422.4-153.6-422.4H550.4z m518.4 0v512h76.8v-512h-76.8z m172.8 0v512h76.8V582.4h134.4c121.6 0 185.6-51.2 185.6-153.6 0-102.4-57.6-153.6-179.2-153.6h-217.6z m83.2 64h128c38.4 0 64 6.4 83.2 19.2 19.2 12.8 25.6 38.4 25.6 64s-12.8 64-25.6 76.8c-19.2 12.8-44.8 19.2-83.2 19.2h-128V332.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_6" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#C1D5E4"></path><path d="M774.4 416V448h179.2v-38.4c19.2 19.2 38.4 44.8 64 64l32-51.2c-76.8-57.6-128-128-160-204.8h-51.2c-38.4 83.2-89.6 153.6-160 211.2l32 51.2 64-64z m166.4-19.2h-147.2c25.6-32 51.2-76.8 76.8-121.6 12.8 44.8 38.4 83.2 70.4 121.6z m-243.2 326.4v57.6h345.6v-57.6H960c25.6-64 44.8-140.8 57.6-230.4l-57.6-12.8c-19.2 96-38.4 179.2-57.6 243.2h-204.8zM768 499.2l-51.2 19.2c19.2 57.6 38.4 115.2 51.2 172.8l51.2-12.8c-19.2-64-32-128-51.2-179.2z m96-19.2l-51.2 19.2c19.2 51.2 32 108.8 44.8 166.4l51.2-12.8c-12.8-64-32-121.6-44.8-172.8zM620.8 294.4l-25.6 211.2h-64l25.6-166.4h-57.6l-25.6 217.6h160v32c0 70.4-6.4 115.2-6.4 128-6.4 19.2-25.6 25.6-51.2 25.6-6.4 0-25.6 0-44.8-6.4l12.8 51.2h44.8c38.4 0 70.4-12.8 83.2-32 12.8-25.6 19.2-108.8 19.2-256h-38.4l32-262.4H473.6v57.6h147.2z m-12.8 307.2c-44.8 12.8-89.6 25.6-147.2 32l6.4 57.6c51.2-12.8 96-25.6 140.8-38.4v-51.2z m934.4-300.8v422.4H1472V396.8h-57.6v326.4h-57.6v57.6h390.4v-57.6h-134.4V518.4H1728v-57.6h-115.2V300.8H1728v-57.6h-358.4v57.6h172.8z m-294.4-76.8l-38.4 38.4c44.8 32 76.8 64 102.4 96l32-44.8c-25.6-32-57.6-57.6-96-89.6z m-89.6 179.2h140.8v262.4c19.2-12.8 32-32 57.6-51.2l12.8 64c-38.4 38.4-76.8 70.4-121.6 96l-25.6-57.6c12.8-6.4 12.8-19.2 12.8-32V460.8h-89.6v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_110" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFC55F"></path><path d="M460.8 403.2v64h160c-12.8 44.8-25.6 83.2-44.8 128h307.2c-32 38.4-76.8 70.4-128 102.4-32-12.8-76.8-25.6-121.6-38.4l-32 44.8c102.4 25.6 198.4 64 294.4 108.8l32-51.2c-32-12.8-64-25.6-102.4-38.4 64-44.8 108.8-89.6 134.4-128v-57.6h-294.4c12.8-25.6 19.2-44.8 25.6-70.4h345.6v-64H704l12.8-38.4c0-6.4 6.4-12.8 6.4-25.6h281.6v-57.6h-268.8c6.4-19.2 6.4-44.8 12.8-70.4h-64l-12.8 70.4H505.6v57.6h153.6l-19.2 64H460.8zM1548.8 563.2c32 83.2 76.8 160 147.2 217.6l44.8-51.2c-64-44.8-115.2-108.8-140.8-179.2 38.4-19.2 76.8-38.4 108.8-57.6l-38.4-38.4c-51.2 32-102.4 57.6-160 70.4-12.8-25.6-25.6-44.8-44.8-64l19.2-19.2c6.4-6.4 12.8-6.4 12.8-12.8h140.8v-57.6h-377.6v57.6h140.8c-12.8 6.4-25.6 12.8-44.8 19.2-51.2 19.2-108.8 38.4-166.4 51.2l38.4 51.2c76.8-25.6 134.4-44.8 179.2-64h6.4c6.4 6.4 12.8 12.8 19.2 25.6-57.6 44.8-140.8 76.8-243.2 102.4l32 51.2c102.4-32 179.2-64 236.8-108.8 6.4 12.8 12.8 25.6 12.8 38.4-70.4 57.6-166.4 102.4-294.4 134.4l32 51.2c108.8-32 204.8-76.8 268.8-128v19.2c0 38.4-6.4 57.6-12.8 70.4-6.4 12.8-32 12.8-70.4 12.8h-32l19.2 51.2h19.2c57.6 0 96-12.8 115.2-32 12.8-19.2 19.2-57.6 19.2-108.8 0-32-6.4-64-12.8-96 12.8 0 19.2-6.4 25.6-6.4z" fill="#FFFFFF"></path><path d="M1472 211.2c6.4 19.2 12.8 32 19.2 57.6h243.2v121.6h-57.6v-64h-428.8v64h-64V268.8h249.6c-6.4-19.2-12.8-32-19.2-44.8l57.6-12.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_4" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#93ABF4"></path><path d="M595.2 217.6V384h-51.2V230.4h-57.6v236.8c0 128-12.8 224-38.4 288l44.8 38.4c25.6-51.2 44.8-121.6 51.2-217.6h64v224h57.6V518.4H544v-32V448h140.8V384h-32V217.6h-57.6z" fill="#FFFFFF"></path><path d="M992 217.6l32 51.2c-76.8 25.6-160 38.4-249.6 38.4v83.2h236.8v51.2c-19.2 89.6-44.8 160-83.2 224 32 38.4 64 70.4 108.8 89.6l-32 51.2c-44.8-25.6-83.2-57.6-115.2-96-32 38.4-70.4 70.4-115.2 96l-32-51.2c44.8-25.6 83.2-57.6 115.2-96-32-57.6-57.6-121.6-70.4-204.8h-12.8v51.2c0 121.6-25.6 224-64 294.4l-44.8-44.8c32-57.6 51.2-140.8 51.2-249.6V256c102.4 0 192-12.8 275.2-38.4z m-44.8 236.8h-102.4c12.8 57.6 25.6 108.8 51.2 153.6 25.6-44.8 44.8-96 51.2-153.6zM1414.4 377.6h-230.4V320h230.4c-12.8-32-19.2-64-38.4-89.6l57.6-19.2c12.8 38.4 25.6 70.4 38.4 102.4h236.8v57.6h-230.4v134.4h204.8v57.6h-204.8v160h256v57.6h-569.6v-57.6h256V569.6h-211.2V512H1408V377.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_107" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#96C7F9"></path><path d="M486.4 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-179.2 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-57.6h-256c6.4-38.4 6.4-83.2 6.4-121.6v-44.8h-64v57.6c0 38.4 0 70.4-6.4 108.8H486.4zM1292.8 396.8c-19.2 44.8-44.8 76.8-70.4 115.2l-38.4-51.2c44.8-57.6 83.2-134.4 115.2-230.4l57.6 12.8-38.4 96h134.4V204.8h64v128H1728v64h-211.2v147.2h243.2v57.6h-243.2v192h-64v-192h-268.8v-64h268.8V396.8h-160z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_117" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFA966"></path><path d="M1030.4 352h-121.6c19.2-25.6 44.8-64 64-102.4l-64-25.6c-19.2 44.8-44.8 89.6-70.4 128H601.6l38.4-19.2c-19.2-38.4-38.4-70.4-57.6-102.4l-57.6 25.6c19.2 25.6 44.8 57.6 64 89.6H473.6v153.6h57.6V409.6h435.2v96h57.6V352z" fill="#FFFFFF"></path><path d="M576 448v51.2h256l-19.2 12.8c-25.6 12.8-51.2 25.6-83.2 38.4v51.2h-256v57.6h256v76.8c0 12.8-6.4 25.6-19.2 25.6H633.6l12.8 57.6h83.2c38.4 0 57.6-19.2 57.6-57.6v-102.4H1024v-57.6h-236.8V576c51.2-25.6 96-51.2 134.4-76.8V448H576zM736 217.6l-57.6 25.6c19.2 32 44.8 64 64 102.4l51.2-25.6c-19.2-38.4-38.4-70.4-57.6-102.4zM1459.2 224v64H1600v57.6h-140.8v64H1536c51.2-38.4 96-76.8 134.4-121.6l19.2-25.6 44.8 32c-25.6 32-51.2 57.6-83.2 89.6l-25.6 19.2h115.2v57.6h-192l-25.6 12.8c-19.2 12.8-38.4 25.6-64 32l-19.2 6.4h217.6v294.4h-64v-12.8h-256v25.6h-64V588.8l-102.4 38.4-25.6-57.6c89.6-19.2 172.8-51.2 249.6-89.6l32-12.8h-268.8v-64h230.4v-57.6H1216v-57.6h172.8v-64h70.4z m147.2 454.4h-256v57.6h256v-57.6z m0-102.4h-256v57.6h256V576z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_115" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFA966"></path><path d="M1030.4 352h-121.6c19.2-25.6 44.8-64 64-102.4l-64-25.6c-19.2 44.8-44.8 89.6-70.4 128H601.6l38.4-19.2c-19.2-38.4-38.4-70.4-57.6-102.4l-57.6 25.6c19.2 25.6 44.8 57.6 64 89.6H473.6v153.6h57.6V409.6h435.2v96h57.6V352z" fill="#FFFFFF"></path><path d="M576 448v51.2h256l-19.2 12.8c-25.6 12.8-51.2 25.6-83.2 38.4v51.2h-256v57.6h256v76.8c0 12.8-6.4 25.6-19.2 25.6H633.6l12.8 57.6h83.2c38.4 0 57.6-19.2 57.6-57.6v-102.4H1024v-57.6h-236.8V576c51.2-25.6 96-51.2 134.4-76.8V448H576zM736 217.6l-57.6 25.6c19.2 32 44.8 64 64 102.4l51.2-25.6c-19.2-38.4-38.4-70.4-57.6-102.4zM1459.2 224v64H1600v57.6h-140.8v64H1536c51.2-38.4 96-76.8 134.4-121.6l19.2-25.6 44.8 32c-25.6 32-51.2 57.6-83.2 89.6l-25.6 19.2h115.2v57.6h-192l-25.6 12.8c-19.2 12.8-38.4 25.6-64 32l-19.2 6.4h217.6v294.4h-64v-12.8h-256v25.6h-64V588.8l-102.4 38.4-25.6-57.6c89.6-19.2 172.8-51.2 249.6-89.6l32-12.8h-268.8v-64h230.4v-57.6H1216v-57.6h172.8v-64h70.4z m147.2 454.4h-256v57.6h256v-57.6z m0-102.4h-256v57.6h256V576z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_116" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFA966"></path><path d="M1030.4 352h-121.6c19.2-25.6 44.8-64 64-102.4l-64-25.6c-19.2 44.8-44.8 89.6-70.4 128H601.6l38.4-19.2c-19.2-38.4-38.4-70.4-57.6-102.4l-57.6 25.6c19.2 25.6 44.8 57.6 64 89.6H473.6v153.6h57.6V409.6h435.2v96h57.6V352z" fill="#FFFFFF"></path><path d="M576 448v51.2h256l-19.2 12.8c-25.6 12.8-51.2 25.6-83.2 38.4v51.2h-256v57.6h256v76.8c0 12.8-6.4 25.6-19.2 25.6H633.6l12.8 57.6h83.2c38.4 0 57.6-19.2 57.6-57.6v-102.4H1024v-57.6h-236.8V576c51.2-25.6 96-51.2 134.4-76.8V448H576zM736 217.6l-57.6 25.6c19.2 32 44.8 64 64 102.4l51.2-25.6c-19.2-38.4-38.4-70.4-57.6-102.4zM1459.2 224v64H1600v57.6h-140.8v64H1536c51.2-38.4 96-76.8 134.4-121.6l19.2-25.6 44.8 32c-25.6 32-51.2 57.6-83.2 89.6l-25.6 19.2h115.2v57.6h-192l-25.6 12.8c-19.2 12.8-38.4 25.6-64 32l-19.2 6.4h217.6v294.4h-64v-12.8h-256v25.6h-64V588.8l-102.4 38.4-25.6-57.6c89.6-19.2 172.8-51.2 249.6-89.6l32-12.8h-268.8v-64h230.4v-57.6H1216v-57.6h172.8v-64h70.4z m147.2 454.4h-256v57.6h256v-57.6z m0-102.4h-256v57.6h256V576z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_103" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#81E2ED"></path><path d="M608 499.2c12.8 25.6 32 51.2 51.2 83.2l38.4-51.2c-25.6-32-57.6-64-83.2-96v-32h70.4v-57.6H608V224h-64v121.6H460.8v57.6h83.2C524.8 473.6 492.8 544 448 601.6l25.6 64c32-44.8 57.6-102.4 70.4-160v300.8h64V499.2z" fill="#FFFFFF"></path><path d="M972.8 243.2v38.4c-12.8 51.2-25.6 102.4-32 140.8h76.8v32c-12.8 83.2-44.8 160-83.2 217.6 32 32 70.4 64 115.2 89.6l-44.8 51.2c-38.4-32-76.8-57.6-108.8-96-38.4 38.4-83.2 70.4-134.4 96l-38.4-57.6c51.2-25.6 96-51.2 128-89.6-32-44.8-57.6-89.6-70.4-140.8-19.2 121.6-57.6 217.6-108.8 281.6l-51.2-38.4c70.4-83.2 108.8-224 108.8-409.6v-57.6h-64v-57.6h307.2z m-64 57.6h-121.6v89.6c12.8 89.6 51.2 166.4 102.4 236.8 32-44.8 51.2-96 64-147.2h-89.6c12.8-38.4 25.6-83.2 32-134.4l12.8-44.8zM1644.8 608v204.8h-57.6v-25.6h-256v25.6h-57.6V608h371.2z m-57.6 51.2h-256v76.8h256v-76.8z" fill="#FFFFFF"></path><path d="M1363.2 326.4l57.6 12.8c-6.4 12.8-12.8 25.6-25.6 32h230.4v51.2c-25.6 32-57.6 64-102.4 89.6 64 25.6 134.4 38.4 217.6 38.4l-12.8 57.6c-102.4-6.4-192-25.6-268.8-64-76.8 32-166.4 57.6-281.6 76.8l-25.6-57.6c96-12.8 179.2-32 243.2-57.6-25.6-12.8-51.2-32-70.4-51.2l-76.8 57.6-38.4-44.8c57.6-38.4 108.8-83.2 153.6-140.8z m185.6 96h-185.6c32 25.6 57.6 44.8 96 57.6 38.4-12.8 70.4-32 89.6-57.6z" fill="#FFFFFF"></path><path d="M1715.2 262.4v128h-64V320h-409.6v76.8h-64v-128H1408l-19.2-38.4 70.4-12.8c6.4 12.8 12.8 32 19.2 44.8h236.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_105" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#72D6FF"></path><path d="M460.8 384v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320H1024V384h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H460.8zM1216 480v332.8h64V384c25.6-44.8 44.8-89.6 57.6-140.8l-57.6-25.6c-25.6 96-70.4 185.6-128 262.4l19.2 64c12.8-25.6 32-44.8 44.8-64zM1644.8 371.2c-12.8 44.8-25.6 83.2-44.8 115.2l51.2 19.2c19.2-32 32-70.4 44.8-115.2l-51.2-19.2zM1395.2 371.2l-51.2 19.2c12.8 32 25.6 70.4 38.4 108.8l51.2-12.8c-12.8-44.8-25.6-76.8-38.4-115.2z" fill="#FFFFFF"></path><path d="M1337.6 294.4h160V224h57.6v70.4h160v57.6h-160v70.4c0 32 0 64-6.4 89.6H1728v57.6h-160c38.4 70.4 96 134.4 179.2 185.6l-44.8 51.2c-83.2-64-140.8-134.4-179.2-211.2-32 96-102.4 166.4-198.4 211.2l-38.4-51.2c96-25.6 160-89.6 185.6-179.2h-153.6v-57.6h166.4c6.4-25.6 6.4-51.2 6.4-76.8V352h-160v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_106" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#72D6FF"></path><path d="M460.8 384v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320H1024V384h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H460.8zM1216 480v332.8h64V384c25.6-44.8 44.8-89.6 57.6-140.8l-57.6-25.6c-25.6 96-70.4 185.6-128 262.4l19.2 64c12.8-25.6 32-44.8 44.8-64zM1644.8 371.2c-12.8 44.8-25.6 83.2-44.8 115.2l51.2 19.2c19.2-32 32-70.4 44.8-115.2l-51.2-19.2zM1395.2 371.2l-51.2 19.2c12.8 32 25.6 70.4 38.4 108.8l51.2-12.8c-12.8-44.8-25.6-76.8-38.4-115.2z" fill="#FFFFFF"></path><path d="M1337.6 294.4h160V224h57.6v70.4h160v57.6h-160v70.4c0 32 0 64-6.4 89.6H1728v57.6h-160c38.4 70.4 96 134.4 179.2 185.6l-44.8 51.2c-83.2-64-140.8-134.4-179.2-211.2-32 96-102.4 166.4-198.4 211.2l-38.4-51.2c96-25.6 160-89.6 185.6-179.2h-153.6v-57.6h166.4c6.4-25.6 6.4-51.2 6.4-76.8V352h-160v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_108" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#96C7F9"></path><path d="M486.4 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-179.2 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-57.6h-256c6.4-38.4 6.4-83.2 6.4-121.6v-44.8h-64v57.6c0 38.4 0 70.4-6.4 108.8H486.4zM1292.8 396.8c-19.2 44.8-44.8 76.8-70.4 115.2l-38.4-51.2c44.8-57.6 83.2-134.4 115.2-230.4l57.6 12.8-38.4 96h134.4V204.8h64v128H1728v64h-211.2v147.2h243.2v57.6h-243.2v192h-64v-192h-268.8v-64h268.8V396.8h-160z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_109" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#96C7F9"></path><path d="M486.4 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-179.2 256-320 51.2 134.4 134.4 243.2 256 320l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-57.6h-256c6.4-38.4 6.4-83.2 6.4-121.6v-44.8h-64v57.6c0 38.4 0 70.4-6.4 108.8H486.4zM1292.8 396.8c-19.2 44.8-44.8 76.8-70.4 115.2l-38.4-51.2c44.8-57.6 83.2-134.4 115.2-230.4l57.6 12.8-38.4 96h134.4V204.8h64v128H1728v64h-211.2v147.2h243.2v57.6h-243.2v192h-64v-192h-268.8v-64h268.8V396.8h-160z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_119" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FF997D"></path><path d="M473.6 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 313.6l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-51.2h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H473.6zM1190.4 300.8V640h57.6V300.8z" fill="#FFFFFF"></path><path d="M1292.8 211.2v307.2c0 108.8-38.4 192-108.8 243.2l44.8 38.4c76.8-57.6 121.6-153.6 121.6-281.6V211.2h-57.6zM1388.8 230.4h358.4v57.6h-153.6v70.4H1728v313.6c0 38.4-19.2 64-51.2 64h-44.8l-12.8-57.6 38.4 6.4c12.8-6.4 19.2-12.8 19.2-25.6V416H1600v384h-57.6v-384h-76.8v320H1408V358.4h134.4V288h-153.6v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_120" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FF997D"></path><path d="M473.6 371.2v57.6h236.8c-32 147.2-115.2 256-249.6 320l38.4 51.2c128-70.4 217.6-172.8 256-320 51.2 134.4 134.4 243.2 256 313.6l38.4-51.2c-128-76.8-211.2-179.2-256-320h243.2v-51.2h-256c6.4-38.4 6.4-76.8 6.4-121.6v-38.4h-64v57.6c0 38.4 0 70.4-6.4 108.8H473.6zM1190.4 300.8V640h57.6V300.8z" fill="#FFFFFF"></path><path d="M1292.8 211.2v307.2c0 108.8-38.4 192-108.8 243.2l44.8 38.4c76.8-57.6 121.6-153.6 121.6-281.6V211.2h-57.6zM1388.8 230.4h358.4v57.6h-153.6v70.4H1728v313.6c0 38.4-19.2 64-51.2 64h-44.8l-12.8-57.6 38.4 6.4c12.8-6.4 19.2-12.8 19.2-25.6V416H1600v384h-57.6v-384h-76.8v320H1408V358.4h134.4V288h-153.6v-57.6z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_111" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFC55F"></path><path d="M460.8 403.2v64h160c-12.8 44.8-25.6 83.2-44.8 128h307.2c-32 38.4-76.8 70.4-128 102.4-32-12.8-76.8-25.6-121.6-38.4l-32 44.8c102.4 25.6 198.4 64 294.4 108.8l32-51.2c-32-12.8-64-25.6-102.4-38.4 64-44.8 108.8-89.6 134.4-128v-57.6h-294.4c12.8-25.6 19.2-44.8 25.6-70.4h345.6v-64H704l12.8-38.4c0-6.4 6.4-12.8 6.4-25.6h281.6v-57.6h-268.8c6.4-19.2 6.4-44.8 12.8-70.4h-64l-12.8 70.4H505.6v57.6h153.6l-19.2 64H460.8zM1548.8 563.2c32 83.2 76.8 160 147.2 217.6l44.8-51.2c-64-44.8-115.2-108.8-140.8-179.2 38.4-19.2 76.8-38.4 108.8-57.6l-38.4-38.4c-51.2 32-102.4 57.6-160 70.4-12.8-25.6-25.6-44.8-44.8-64l19.2-19.2c6.4-6.4 12.8-6.4 12.8-12.8h140.8v-57.6h-377.6v57.6h140.8c-12.8 6.4-25.6 12.8-44.8 19.2-51.2 19.2-108.8 38.4-166.4 51.2l38.4 51.2c76.8-25.6 134.4-44.8 179.2-64h6.4c6.4 6.4 12.8 12.8 19.2 25.6-57.6 44.8-140.8 76.8-243.2 102.4l32 51.2c102.4-32 179.2-64 236.8-108.8 6.4 12.8 12.8 25.6 12.8 38.4-70.4 57.6-166.4 102.4-294.4 134.4l32 51.2c108.8-32 204.8-76.8 268.8-128v19.2c0 38.4-6.4 57.6-12.8 70.4-6.4 12.8-32 12.8-70.4 12.8h-32l19.2 51.2h19.2c57.6 0 96-12.8 115.2-32 12.8-19.2 19.2-57.6 19.2-108.8 0-32-6.4-64-12.8-96 12.8 0 19.2-6.4 25.6-6.4z" fill="#FFFFFF"></path><path d="M1472 211.2c6.4 19.2 12.8 32 19.2 57.6h243.2v121.6h-57.6v-64h-428.8v64h-64V268.8h249.6c-6.4-19.2-12.8-32-19.2-44.8l57.6-12.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_112" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFC55F"></path><path d="M460.8 403.2v64h160c-12.8 44.8-25.6 83.2-44.8 128h307.2c-32 38.4-76.8 70.4-128 102.4-32-12.8-76.8-25.6-121.6-38.4l-32 44.8c102.4 25.6 198.4 64 294.4 108.8l32-51.2c-32-12.8-64-25.6-102.4-38.4 64-44.8 108.8-89.6 134.4-128v-57.6h-294.4c12.8-25.6 19.2-44.8 25.6-70.4h345.6v-64H704l12.8-38.4c0-6.4 6.4-12.8 6.4-25.6h281.6v-57.6h-268.8c6.4-19.2 6.4-44.8 12.8-70.4h-64l-12.8 70.4H505.6v57.6h153.6l-19.2 64H460.8zM1548.8 563.2c32 83.2 76.8 160 147.2 217.6l44.8-51.2c-64-44.8-115.2-108.8-140.8-179.2 38.4-19.2 76.8-38.4 108.8-57.6l-38.4-38.4c-51.2 32-102.4 57.6-160 70.4-12.8-25.6-25.6-44.8-44.8-64l19.2-19.2c6.4-6.4 12.8-6.4 12.8-12.8h140.8v-57.6h-377.6v57.6h140.8c-12.8 6.4-25.6 12.8-44.8 19.2-51.2 19.2-108.8 38.4-166.4 51.2l38.4 51.2c76.8-25.6 134.4-44.8 179.2-64h6.4c6.4 6.4 12.8 12.8 19.2 25.6-57.6 44.8-140.8 76.8-243.2 102.4l32 51.2c102.4-32 179.2-64 236.8-108.8 6.4 12.8 12.8 25.6 12.8 38.4-70.4 57.6-166.4 102.4-294.4 134.4l32 51.2c108.8-32 204.8-76.8 268.8-128v19.2c0 38.4-6.4 57.6-12.8 70.4-6.4 12.8-32 12.8-70.4 12.8h-32l19.2 51.2h19.2c57.6 0 96-12.8 115.2-32 12.8-19.2 19.2-57.6 19.2-108.8 0-32-6.4-64-12.8-96 12.8 0 19.2-6.4 25.6-6.4z" fill="#FFFFFF"></path><path d="M1472 211.2c6.4 19.2 12.8 32 19.2 57.6h243.2v121.6h-57.6v-64h-428.8v64h-64V268.8h249.6c-6.4-19.2-12.8-32-19.2-44.8l57.6-12.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_113" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#FFC55F"></path><path d="M460.8 403.2v64h160c-12.8 44.8-25.6 83.2-44.8 128h307.2c-32 38.4-76.8 70.4-128 102.4-32-12.8-76.8-25.6-121.6-38.4l-32 44.8c102.4 25.6 198.4 64 294.4 108.8l32-51.2c-32-12.8-64-25.6-102.4-38.4 64-44.8 108.8-89.6 134.4-128v-57.6h-294.4c12.8-25.6 19.2-44.8 25.6-70.4h345.6v-64H704l12.8-38.4c0-6.4 6.4-12.8 6.4-25.6h281.6v-57.6h-268.8c6.4-19.2 6.4-44.8 12.8-70.4h-64l-12.8 70.4H505.6v57.6h153.6l-19.2 64H460.8zM1548.8 563.2c32 83.2 76.8 160 147.2 217.6l44.8-51.2c-64-44.8-115.2-108.8-140.8-179.2 38.4-19.2 76.8-38.4 108.8-57.6l-38.4-38.4c-51.2 32-102.4 57.6-160 70.4-12.8-25.6-25.6-44.8-44.8-64l19.2-19.2c6.4-6.4 12.8-6.4 12.8-12.8h140.8v-57.6h-377.6v57.6h140.8c-12.8 6.4-25.6 12.8-44.8 19.2-51.2 19.2-108.8 38.4-166.4 51.2l38.4 51.2c76.8-25.6 134.4-44.8 179.2-64h6.4c6.4 6.4 12.8 12.8 19.2 25.6-57.6 44.8-140.8 76.8-243.2 102.4l32 51.2c102.4-32 179.2-64 236.8-108.8 6.4 12.8 12.8 25.6 12.8 38.4-70.4 57.6-166.4 102.4-294.4 134.4l32 51.2c108.8-32 204.8-76.8 268.8-128v19.2c0 38.4-6.4 57.6-12.8 70.4-6.4 12.8-32 12.8-70.4 12.8h-32l19.2 51.2h19.2c57.6 0 96-12.8 115.2-32 12.8-19.2 19.2-57.6 19.2-108.8 0-32-6.4-64-12.8-96 12.8 0 19.2-6.4 25.6-6.4z" fill="#FFFFFF"></path><path d="M1472 211.2c6.4 19.2 12.8 32 19.2 57.6h243.2v121.6h-57.6v-64h-428.8v64h-64V268.8h249.6c-6.4-19.2-12.8-32-19.2-44.8l57.6-12.8z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_5" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#A6DEF4"></path><path d="M768 672c83.2 32 166.4 76.8 243.2 128l32-51.2c-70.4-44.8-153.6-83.2-243.2-121.6 6.4 0 6.4-6.4 12.8-12.8h224v-57.6h-198.4c12.8-38.4 19.2-83.2 19.2-128V352h-57.6v76.8c0 44.8-12.8 89.6-25.6 128H492.8v57.6h249.6l-12.8 12.8c-44.8 51.2-121.6 89.6-243.2 121.6l32 51.2c115.2-32 198.4-70.4 249.6-128z" fill="#FFFFFF"></path><path d="M582.4 435.2l-32 44.8c44.8 19.2 89.6 38.4 128 70.4l32-51.2c-38.4-25.6-83.2-44.8-128-64zM646.4 345.6l-32 44.8c44.8 19.2 83.2 38.4 128 70.4l32-51.2c-38.4-25.6-83.2-44.8-128-64z" fill="#FFFFFF"></path><path d="M1030.4 262.4h-230.4c-6.4-19.2-12.8-38.4-25.6-57.6l-64 12.8c6.4 12.8 12.8 32 19.2 51.2H492.8v128h57.6V320h416v76.8h57.6V262.4zM1555.2 499.2c-96 57.6-211.2 108.8-345.6 147.2l25.6 57.6c134.4-44.8 243.2-96 332.8-147.2l-12.8-57.6zM1312 352l-44.8 44.8c57.6 44.8 96 76.8 128 115.2l38.4-44.8c-25.6-38.4-70.4-70.4-121.6-115.2z" fill="#FFFFFF"></path><path d="M1491.2 793.6l-19.2-57.6h108.8c19.2 0 32-6.4 38.4-25.6 6.4-12.8 12.8-51.2 12.8-102.4V524.8 294.4h-409.6v-51.2h480l-6.4 166.4c0 115.2-6.4 192-6.4 224v6.4c0 57.6-12.8 102.4-25.6 121.6-12.8 19.2-38.4 32-70.4 32h-102.4z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_1" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#A69FF4"></path><path d="M691.2 249.6v57.6h307.2v-57.6zM665.6 428.8v57.6h115.2c-25.6 83.2-44.8 147.2-70.4 198.4-6.4 12.8-25.6 19.2-44.8 25.6l12.8 57.6 96-12.8c83.2-12.8 147.2-19.2 192-32 6.4 19.2 12.8 44.8 19.2 64l57.6-12.8c-25.6-89.6-57.6-172.8-96-243.2l-57.6 19.2 57.6 115.2c-57.6 12.8-115.2 25.6-172.8 32 25.6-51.2 44.8-121.6 70.4-211.2h192v-57.6h-371.2zM454.4 371.2v57.6h70.4v217.6l-76.8 19.2 12.8 64c76.8-19.2 140.8-44.8 204.8-76.8v-64c-25.6 12.8-57.6 25.6-76.8 38.4v-192h64v-64h-64V211.2h-64v160H454.4zM1420.8 371.2h-230.4v-57.6h230.4c-12.8-32-25.6-64-38.4-89.6l64-19.2c12.8 38.4 25.6 70.4 38.4 102.4h236.8v57.6h-230.4v134.4h204.8v57.6h-204.8v160h256v57.6h-569.6v-57.6h256V563.2h-198.4v-57.6h198.4V371.2z" fill="#FFFFFF"></path></symbol><symbol id="icon-group_0" viewBox="0 0 2176 1024"><path d="M512 64h1152c249.6 0 448 198.4 448 448s-198.4 448-448 448H512c-249.6 0-448-198.4-448-448s198.4-448 448-448z" fill="#AAE3C5"></path><path d="M870.4 358.4h172.8v-57.6h-153.6l19.2-76.8-57.6-12.8c-12.8 83.2-38.4 153.6-76.8 198.4l38.4 44.8c19.2-25.6 38.4-57.6 57.6-96zM499.2 224l-44.8 38.4c38.4 32 64 57.6 83.2 83.2l44.8-44.8c-19.2-25.6-51.2-51.2-83.2-76.8zM492.8 384l-38.4 38.4c38.4 32 70.4 64 89.6 89.6l44.8-44.8c-25.6-25.6-57.6-51.2-96-83.2zM524.8 556.8C505.6 633.6 480 704 448 774.4l57.6 25.6c25.6-64 51.2-140.8 76.8-217.6l-57.6-25.6z" fill="#FFFFFF"></path><path d="M633.6 371.2v32c0 166.4-25.6 281.6-76.8 358.4l44.8 38.4c44.8-70.4 76.8-166.4 83.2-294.4h44.8v102.4c0 57.6-6.4 89.6-6.4 102.4 0 19.2-6.4 32-19.2 32h-51.2l12.8 51.2h44.8c38.4 0 57.6-19.2 64-57.6v-12.8c6.4-44.8 6.4-134.4 6.4-275.2h-89.6V371.2h108.8v-57.6h-70.4c-12.8-38.4-19.2-70.4-25.6-102.4l-64 12.8c6.4 25.6 19.2 57.6 25.6 89.6H582.4v57.6h51.2zM844.8 416v51.2h108.8l-12.8 19.2c-12.8 12.8-25.6 32-38.4 44.8v38.4h-89.6v51.2h89.6V704c0 25.6-6.4 32-12.8 32h-51.2l12.8 57.6h57.6c32 6.4 51.2-19.2 51.2-64V627.2h83.2v-57.6H960v-32c25.6-19.2 44.8-44.8 64-70.4v-51.2h-179.2zM1644.8 601.6v204.8h-57.6v-25.6h-256v25.6h-57.6V601.6h371.2z m-57.6 51.2h-256v76.8h256v-76.8z" fill="#FFFFFF"></path><path d="M1363.2 320l57.6 12.8c-6.4 12.8-12.8 25.6-25.6 32h230.4v51.2c-25.6 32-57.6 64-102.4 89.6 64 25.6 134.4 38.4 217.6 38.4l-12.8 57.6c-102.4-6.4-192-25.6-268.8-64-76.8 32-166.4 57.6-281.6 76.8l-25.6-57.6c96-12.8 179.2-32 243.2-57.6-25.6-19.2-51.2-32-76.8-57.6l-76.8 57.6-38.4-44.8c64-32 115.2-76.8 160-134.4z m192 96h-185.6c32 25.6 57.6 44.8 96 57.6 32-12.8 64-32 89.6-57.6z" fill="#FFFFFF"></path><path d="M1715.2 256v128h-64V313.6h-409.6v76.8h-64v-128H1408l-19.2-38.4 64-12.8c6.4 12.8 12.8 32 19.2 44.8h243.2z" fill="#FFFFFF"></path></symbol></svg>
	
	
<style>
	.top-banner {
		height: 100px;
		overflow: hidden;
		display: none;
		background:#0d1e28 url('');
		background-repeat: no-repeat;
		background-position: center center;
		background-size: cover;
	}
	@media only screen and (max-width: 780px) {
		.top-banner-section {
			display: none;
		}
	}
</style>
<!-- 顶部广告条 -->
<!-- 顶部广告条结束 -->	

	<style>
.btn-default {
    color: #333;
    background-color: #fff;
    border-color: #ccc;
}
#header {
    /* border-top: 3px solid #0099ee; */
    box-shadow: 0px 2px 10px 0px rgba(0, 0, 0, 0.1), 0 1px rgba(0, 0, 0, 0.1);
    background: #fafafa;
}

#header .container {
    height: 64px;
    line-height: 64px;
}

#header .navbar {
    padding: 0;
}

#header nav li.nav-item {
    line-height: 34px;
}

#header nav a.nav-link {
    font-size: 16px;
    color: #757575;
    font-weight: 500;
    text-decoration: none;
}
#header .login_btn,  #header .reg_btn{
	font-size: 13px;
	padding: 4px 16px;
	
	font-weight: 500;
	color: #0099ee;
	text-decoration: none;
	border: 1px solid #0099ee;
}
#header .reg_btn {
	color: #fff;
	background: #0099ee;
}
#header nav a.nav-link,
#header nav .dropdown {
    padding: 0 1rem;
}

#header nav a.nav-link:hover {
    background-color: #F3F3F3;
}

#header nav li.nav-item.active a {
    color: #0099ee;
    font-weight: 600;
}

#header nav .home_seach_form {
    border: 1px solid #ccc;
    border-radius: 4px;
}

#header nav .dropdown a.dropdown-item:hover {
    color: #0099ee;
    text-decoration: none;
    background-color: #f3f3f3;
}

.dropup .dropdown-toggle::after {
    display: none !important;
}

.bottom-nav {
    /* display: none; */
    background-color: #fafafa;
    box-shadow: 0 -1px rgba(0,0,0,0.1), 0 -2px 10px rgba(0,0,0,0.1);
}
.bottom-nav .opts-group {
    position: relative;
    display: inline-block;
    /* padding-top: 6px; */
    line-height: 20px;
    color: #9e9e9e;
    cursor: pointer;
}
.bottom-nav .opts-group.active {
    color: #0099ee;
}

@media only screen and (min-width: 992px) {
    .bottom-nav, .header_seach_but {
        display: none !important;
    }
    
}
@media only screen and (max-width: 992px) {
    .nav-logo {
        margin-right: 0 !important;
    }

	.nav_user_item {
		width: 96px;
	}
	.nav_user_item .login_btn,  .nav_user_item .reg_btn {
		padding: 3px 6px !important;
	}
}

.seach_li {
    margin-left: 40px;
}

@media only screen and (max-width: 1200px) {
    .seach_li {
        margin-left: 0px !important;
        width: 100%;
        max-width: 120px !important;
    }
}
.dropdown i.angle-down {
    display: inline-block;
    transition: transform linear .2s, -webkit-transform linear .2s, -o-transform linear .2s;
    
}
.dropdown.active i.angle-down {
    transform: rotate(180deg);
}

</style>

<header id="header">
    <div class="container" style="padding-right: 15px;padding-left: 15px;">
        <nav class="navbar navbar-expand-lg navbar-light">
            <a href="https://bbs.kanxue.com/search.htm" class="header_seach_but" style="display:block; width: 96px;"><i class="icon-search" aria-hidden="true"></i></a>
            <a class="navbar-brand nav-logo" href="https://bbs.kanxue.com/" style="line-height: 0px;" title="看雪-安全社区|安全招聘|kanxue.com">
                <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/kanxuelogo.png" height="25" alt="看雪-安全社区|安全招聘|kanxue.com">
            </a>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/">首页</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/course.htm">课程</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/question-list.htm">问答</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://ctf.kanxue.com/">CTF</a>
                    </li>
                    <!-- <li class="nav-item  position-relative">
                        <div class="dropdown">
                            <a class="dropdown-toggle nav-link px-0" href="#" role="button" id="ctfdropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                CTF
                            </a>
                            <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="//passport.kanxue.com/pc/view/img/hot.png" alt="">
                            <div class="dropdown-menu " aria-labelledby="ctfdropdownMenuLink">
                                <a class="dropdown-item" style="color: #212529; font-weight: 400;" href="//ctf.kanxue.com">CTF竞赛</a>
                                <a class="dropdown-item" style="color: #212529; font-weight: 400;" href="//ctf.kanxue.com/itembank.htm">题库</a>
                                
                            </div>
                        </div>
                    </li> -->
                    <li class="nav-item active">
                        <a class="nav-link" href="https://bbs.kanxue.com/">社区</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://job.kanxue.com/">招聘</a>
                    </li>
                    <li class="nav-item position-relative">
                            <a class="nav-link" href="https://www.kanxue.com/conference.htm" target="_blank">峰会</a>
                            <!-- <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="//passport.kanxue.com/pc/view/img/hot.png" alt=""> -->
                    </li>
                    <li class="nav-item">
                        <div class="dropdown">
                            <a class="dropdown-toggle nav-link px-0" href="https://bbs.kanxue.com/thread-281889.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                发现
                            </a>
                            <div class="dropdown-menu " aria-labelledby="dropdownMenuLink">
                                <!-- <a class="dropdown-item" href="//ctf.kanxue.com">CTF</a> -->
                                <!-- <a class="dropdown-item" href="//ce.kanxue.com">众测</a> -->
                                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                                <!-- <a class="dropdown-item" href="//www.kanxue.com/conference.htm">峰会</a> -->
                                <a class="dropdown-item" href="https://www.kanxue.com/mrt.htm">看雪20年</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
                                <a class="dropdown-item " href="https://www.kanxue.com/certificate.htm">证书查询</a>
                            </div>
                        </div>
                    </li>
                    <li class="seach_li">
                        <form class="form-inline my-2 my-lg-0 mr-auto" action="https://bbs.kanxue.com/search.htm" id="search_form" style="margin-right: 20px; max-width: 150px;">
                            <div class="input-group home_seach_form">
                                <input type="text" class="form-control border-0" name="keyword" placeholder="社区关键词 回车搜索">
                                <div class="input-group-append">
                                    <button class="btn px-2" type="submit" id="button-addon2">
                                        <i class="icon-search"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </li>
                </ul>
                
            </div>
            <div class="text-right nav_user_item" style="white-space: nowrap;">
                                    
                    <span class="dropdown px-0 pm_message_box">
                        <a class="py-2 pm_message_btn" href="javascript:;" style="text-decoration: none; color: #929292;">
                            消息 
                            <span class="pm_totals hidden-sm"></span>
                            <i class="icon-angle-down angle-down" style="height: 10px; line-height: 10px;"></i>
                        </a>
                        <div class="dropdown-menu px-3" style="right: 0; left: auto;">
                            <a class="d-block" style="line-height: 35px;text-decoration: none;" href="https://www.kanxue.com/pm-list-1-1.htm">
                            短信息 <span class="newpms"></span>
                            </a>
                            <a class="d-block" style="line-height: 35px;text-decoration: none;" href="https://www.kanxue.com/pm-system_read-1.htm">
                            系统通知 <span class="system_pms"></span>
                            </a>
                        </div>
                    </span>
                    <span class="ml-2 xn-toggle pointer " data-target="#toggle_user_new" style="display: inline-block;
                    line-height: initial;">
                        <a class=" px-0"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png" class="avatar-2_4"></a>
                    </span>
                    
                    <div class="text-center" id="toggle_user_new" style="line-height: 34px;">
                        <div class="row m-0 mt-3 align-items-center">
                            <div class="col">
                                <span class="d-inline-block ">
                                    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png" class="avatar-4 mb-0">
                                </span>
                                <br> 
                                <span class="">mb_zwojibcx</span>
                            </div>
                        </div>
                        <hr class="my-3">
                        <!-- <div class="row mx-0 mb-2">
                            <div class="col-6">
                                <a href="//bbs.kanxue.com/homepage-1021299.htm" class="text-muted"><i class="icon-user"></i> 我的主页</a>
                            </div>
                            
                            <div class="col-6">
                                <a href="//passport.kanxue.com/user-center.htm" class="text-muted"><i class="icon-cog"></i> 个人中心</a>
                            </div>
                        </div> -->
                        <div class="row mx-0 mb-3">
                            <div class="col-6">
                                <a href="https://passport.kanxue.com/user-center.htm" class="text-muted"><i class="icon-user"></i> 个人中心</a>
                            </div>
                            <div class="col-6">
                                <a href="https://www.kanxue.com/user-center-orderlist-1021299.htm" class="text-muted"><i class="icon-book"></i> 我的课程</a>
                            </div>
                            <div class="col-6">
                                <a href="https://bbs.kanxue.com/my-wallet.htm" class="text-muted"><i class="icon-credit-card"></i> 社区钱包</a>
                            </div>
                                                        <div class="col-6">
                                <a href="https://www.kanxue.com/member.htm" class="text-muted"><i class="icon-vimeo"></i> 我的会员</a>
                            </div>
                                                    </div>
                        <hr class="my-3">
                        <div class="row m-0 mb-3">
                            <div class="col-12">
                                <a href="javascript:void(0);" class="text-muted logout"><i class="icon icon-power-off"></i> 退出</a>
                            </div>
                        </div>
                    </div>
                            </div>
            
        </nav>
    </div>
</header>
<div class="position-fixed w-100 header_fiexd bottom-nav" style="width: 100%; height: 50px; bottom: 0; z-index: 2; background: #fafafa;">
    <div class="row mx-0 text-center align-items-center" style="height: 50px;">
        <a href="https://www.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group " style="max-width: 20%;">
            <div>
                <i class="icon-home"></i>
            </div>
            <div>
                首页
            </div>
        </a>
        <a href="https://bbs.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group active" style="max-width: 20%;">
            <div>
                <i class="icon-comments"></i>
            </div>
            <div>
                社区
            </div>
        </a>
        
        <a href="https://www.kanxue.com/course.htm" class="d-inline-blok col px-0 header_nav_a opts-group" style="max-width: 20%;">
            <div>
                <i class="icon-book"></i>
            </div>
            <div>
                课程
            </div>
        </a>
        <a href="https://job.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group" style="max-width: 20%;">
            <div>
                <i class="icon-clipboard"></i>
            </div>
            <div>
                招聘
            </div>
        </a>
        
        <div class=" dropup d-inline-blok col px-0" style="max-width: 20%;">
            <a class="dropdown-toggle d-inline-block header_nav_a opts-group" href="https://bbs.kanxue.com/thread-281889.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <div>

                    <i class="icon-list"></i>
                </div>
                <div>
                    发现
                </div>
            </a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" href="https://www.kanxue.com/question-list.htm">问答</a>

                <a class="dropdown-item" href="https://ctf.kanxue.com/">CTF</a>
                <!-- <a class="dropdown-item" href="//ctf.kanxue.com/itembank.htm">题库</a> -->
                <!-- <a class="dropdown-item" href="//ce.kanxue.com">众测</a> -->
                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                <a class="dropdown-item" href="https://www.kanxue.com/conference.htm">峰会</a>
                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
                <a class="dropdown-item" href="https://www.kanxue.com/certificate.htm">证书查询</a>
            </div>
        </div>
       
    </div>
</div>





		<main id="body"> 
	
	<div class="container">
			
		


<link rel="stylesheet" type="text/css" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/syntax.css">
<link type="text/css" rel="stylesheet" href="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/katex.min.css">
<style>
	mark.encrypted {
		width: 10px;
		visibility: hidden;
		display : inline-block;
		overflow: hidden;
	}

	@font-face{
		font-family:'DIN-Medium';
		src:url('plugin/chao_new_style/view/font/DIN Medium.ttf');
	}
	.item-count {
		font-family: DIN-Medium;
		font-weight: 600;
		color: #18191a;
	}
	a:hover {
		color: #03a7ff
	}
	.text-grey {
    color: #797c80 !important;
}
div.message fieldset.fieldset>legend {
    background: #555;
}
div.message fieldset.fieldset.toc {
	background: #fdfdfd!important;
	border-radius: 5px;
	border: #eee solid 1px;
}
div.message fieldset.toc ul {
    margin-top: 0;

}
	#header {
		background: #fff;
		box-shadow: 0 2px 4px 0 rgba(114,144,179,.06);
		position: sticky;
		top: 0;
		z-index: 99;
	}
	#header nav a.nav-link {
		font-size: 16px;
		color: #797c80 !important;
		font-weight: 500;
		text-decoration: none;
	}
	#header .nav-item.active a.nav-link {
		color: #09a9ff !important;
	}
	main#body {
		background: #f7f9fa!important;
	}
	.card {
		border-radius: 5px;
		box-shadow: 0 0 2px 0 rgba(98,124,153,.1)!important;
	}
	.text-muted {
		color: #aaaeb3 !important;
	}
	@font-face{
		font-family:'DIN-Medium';
		src:url('plugin/chao_new_style/view/font/DIN Medium.ttf');
	}
	.table thead th {
		vertical-align: bottom;
		border-bottom: unset !important;
	}

	.postlist tr.post:first-child td {
		border-top: unset !important;
	}

	.postlist tr.post,
	.postlist tr.post:last-child td {
		border-bottom: unset !important;
	}

	.qqFace img:hover {
		border-color: #0066cc !important;
	}

	.btn-0099ee {
		background-color: #0099ee;
		color: #fff !important;
	}

	.btn-followed {
		background-color: #c0c5cc;
		color: #fff !important;
	}

	.thread-poptip-box {
		display: none;
		top: 0%;
		left: 100%;
		z-index: 5;
		width: 380px;
		border-radius: 5px;
		box-shadow: 0 4px 12px 0 rgba(37, 77, 157, .1) !important;
		color: #494b4d !important;
		transition: all 500ms;
	}

	.thread-poptip-box1 {
		display: none;
		top: 100%;
		right: 0;
		z-index: 1;
		width: 380px;
		border-radius: 5px;
		box-shadow: 0 4px 12px 0 rgba(37, 77, 157, .1) !important;
		color: #494b4d !important;
		transition: all 500ms;
	}

	@media screen and (min-width: 992px) {
		.post_online_time {
			cursor: pointer;
		}

		img.huoyue_num {
			transition: all 200ms ease;
		}

		img.huoyue_num:hover {
			transform: scale(1.5);
		}
	}

	svg.icon {
		width: 3rem;
		height: 1.3rem;
		vertical-align: middle;
		fill: currentColor;
		overflow: hidden;
	}

	.breadcrumb {
		background-color: unset !important;
		border: unset !important;
		box-shadow: unset !important;
	}
	.breadcrumb .breadcrumb-item a{
		color: #aaaeb3;
	}
	.breadcrumb:hover {
		background-color: unset !important;
	}

	.nav .active {
		font-weight: 800;
		color: #0099ee !important;
	}

	.card>.card-header {
		color: #161616;
		text-shadow: unset !important;
		padding: 0.6rem 1rem;
		border-bottom: 1px solid #eeeeee;
		background: #fff !important;
	}

	div.btn-group.mod-button {
		flex-wrap: wrap;
	}

	div.btn-group.mod-button button {
		margin-top: 0.5rem;
	}

	.collection_thumb_left i {
		font-size: 22px;
	}
</style>
<style>
	/* 收藏点赞区样式 */
	.card_collection {
		border-radius: 5px;
		width: 70px;
		vertical-align: middle;
		display: inline-block;
	}

	.card_collection div {
		margin-bottom: 0px;
		font-size: 14px;
	}

	.card_collection div>a>i {
		font-size: 22px;
	}

	.card_collection div a {
		text-decoration: none;
	}

	.alipay-bg {
		width: 60px;
		height: 20px;
		display: inline-block;
		vertical-align: middle;
		background: url(view/img/reward_alipay.png) 0 0 no-repeat;
	}

	.color4A4A4A {
		color: #C4C4C4;
	}
	.color515a6e {
		color: #515a6e;
	}
	.colorff842a {
		color: #ff842a;
	}
	.bbsshare_modal {
		position: absolute;
		z-index: 2;
		top: 0;
		right: -155px;
	}

	.likes_box_hide {
		display: none;
	}

	.likes_box_show {
		display: inline;
	}

	.position-sticky {
		position: -webkit-sticky;
		position: sticky;
	}

	/* 右侧目录样式 */


	.is-collapsible {
		max-height: 1000px;
		overflow: hidden;
		transition: all 300ms ease-in-out
	}

	.is-collapsed {
		max-height: 0
	}

	.is-position-fixed {
		position: fixed !important;
		top: 0
	}

	.is-active-link {
		font-weight: 700
	}

	.js-toc {
		max-height: 21rem;
		overflow: auto;
	}

	.js-toc ol {
		margin: 0;
		padding-left: 1rem;
		list-style-type: none;
	}

	.js-toc a {
		width: 100%;
		margin: 0.2rem 0 0;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		display: inline-block;

	}

	.js-toc li.is-active-li a.is-active-link {
		color: #000;
		font-weight: bolder;
	}

	.show_tocbot {
		display: none;
	}
	@media only screen and (min-width: 768px) {
		.col-md-9 {
			flex: 0 0 73%;
			max-width: 73%;
		}
	}
	.col-3 {
		flex: 0 0 27%;
		max-width: 27%;
	}
	.favorite i {
		transition: all 0.3s ease;
	}
	.favorite i.shrink {
		font-size: 12px;
	}
	.thumb_list_body .thumb_list_item:nth-child(n+21) {
		display: none;
	}
	#thumbShowMore {
		display: none;
	}

	@media only screen and (min-width: 992px) and (max-width: 1199.98px) {
		.ggBox {
			display: none;
		}
	}

</style>

<ol class="breadcrumb mb-3 py-0 small px-0">
	<li class="breadcrumb-item"><a href="https://bbs.kanxue.com/" aria-label="首页">社区</a></li>
	<li class="breadcrumb-item"><a href="https://bbs.kanxue.com/forum-161.htm">Android安全</a></li>

	<div class="media-body text-right">
				<a href="https://bbs.kanxue.com/thread-create-161.htm" role="button" class="btn btn-sm btn-primary" style="float: right; border: 1px solid #0099ee;">发新帖</a>
			</div>
</ol>


<div class="row mx-0">
	<div class="col-12 col-lg-9 px-0">
		<div class="left_content">
			<div class="position-fixed text-center collection_thumb_left" style="z-index: 2; width: 70px; margin-left: -70px;">
				<div>
					
										<a href="javascript:void(0)" class="favorite d-inline-block bg-white" title="收藏" style="text-decoration: none; box-shadow: 0 4px 16px 0 rgba(13,39,91,.06); border-radius: 100%; width: 48px; height: 48px; line-height: 48px;">
						<i class="icon-star-o color515a6e"></i>
					</a>
										
					<div class="pt-2">
						<span class="likes_box color515a6e likes_box_show" style="font-size: 16px;">
							<span class="likes">124</span>
						</span>
					</div>
				</div>
				<div class="mt-3">
										<a href="javascript:void(0)" data-toggle="modal" data-target="#thumbModal" class="d-inline-block bg-white thumb thumbsBox" style="text-decoration: none; box-shadow: 0 4px 16px 0 rgba(13,39,91,.06); border-radius: 100%; width: 48px; height: 48px; line-height: 48px;">
						<i class="icon-thumbs-o-up color515a6e"></i>
												</a>
						<div>
							<span class="thumbs_num_box" style="font-size: 16px;">
								<span class="thumbs_num">49</span>
							</span>
						</div>
				</div>
				<div class="mt-3">
					<a href="javascript:void(0)" id="exampleModalLabel" class="d-inline-block bg-white" style="text-decoration: none; box-shadow: 0 4px 16px 0 rgba(13,39,91,.06); border-radius: 100%; width: 48px; height: 48px; line-height: 48px;" data-toggle="modal" data-target=".reward">
						<!-- <i class="icon-rmb color515a6e"></i> -->
						<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-battery-charging" style="vertical-align: middle;"><path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3.19M15 6h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3.19"></path><line x1="23" y1="13" x2="23" y2="11"></line><polyline points="11 6 7 12 13 12 9 18"></polyline></svg>
					</a>
				</div>
			</div>

			<div class="card message_card">
				<div class="mb-0">
					<div class="card-body" style="padding: 2rem;">
						<div class="d-none d-lg-block">
							<dl class="row">
								<dd class="vtop">
									<dl class="row small" style="height: 34px; line-height: 34px;">
										<dt style="padding: 0px;">
											
											<div class="break-all m-0">
												
												<span style="font-size: 1.8rem; font-weight: 600;">[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?</span>
												
												
						
			<i class="icon-digest-3" aria-hidden="true" title="精华"></i>
												</div>
											
										</dt>

									</dl>
									<dl class="row small mt-2 mb-2">
										<dt style="padding: 0px;">
											
											<div>
												<span class="date text-grey ml-1">
													发表于:
													2024-5-25 16:32</span>
												<span class="text-grey ml-3 hidden-md-down">
													<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
									<span style="vertical-align: middle;">49663												</span>
												
												<!-- <span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="3629111" data-desc="" onmouseenter="show_online_level(event)"> </span> -->
											</span></div>
											
										</dt>
										<dd class="text-right">
										
																						
<a href="javascript:void(0);" class="text-grey ml-3 modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".report" data-tid="281889" data-pid="1768261"><i class="icon-warning" aria-hidden="true"></i> 举报</a>
											
																						
																					</dd>
									</dl>

																										</dd>
							</dl>
						</div>
						<!-- choadi 手机端适配 开始-->
						<div class="px-3 pt-3 d-block d-lg-none">
							
							<h3 class="break-all subject m-0">
																[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?																
						
			<i class="icon-digest-3" aria-hidden="true" title="精华"></i>
								</h3>
							
							<div class="row mx-0 mt-2">
								<div class="col-8 px-0">
									<a href="https://bbs.kanxue.com/user-home-819934.htm" style="text-decoration: none;" aria-hidden="true" tabindex="-1">
										<img style="width: 2rem; height: 2rem; border-radius: 6rem;" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
									</a>

									<a class="small" href="https://bbs.kanxue.com/user-home-819934.htm" style="text-decoration: none;">珍惜Any</a>
									<img class="huoyue_num" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/12.png" width="22" alt="活跃值">
																		<div class="d-inline-block" style="font-size: 12px;">
										<span class="icon-diamond text-danger" title="精华数"></span>
										<span class="font-weight-bold text-danger">
											3</span>
									</div>
																	</div>
								<div class="col px-0 text-right">
									
									
																		
																	</div>
								<!-- <img style="" src="//bbs.kanxue.com/view/img/stars03.gif" alt="">  -->


							</div>
							<div class="small row mx-0 mt-2">
								<div class="col px-0">
									<svg class="icon" aria-hidden="true">
										<use xlink:href="#icon-group_109"></use>
									</svg>
									<span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="3629111" data-desc="1008 小时，  20 级" onmouseenter="show_online_level(event)"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
								</div>
								<div class="col px-0 text-right">
																		
<a href="javascript:void(0);" class="text-grey ml-3 modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".report" data-tid="281889" data-pid="1768261"><i class="icon-warning" aria-hidden="true"></i> 举报</a>
									
																	</div>
							</div>
							<div class="small row mx-0 mt-2">
								<div class="col px-0"><span class="date text-grey">2024-5-25 16:32</span></div>
								<div class="col px-0 text-right">

									<div class="text-grey hidden-md-down"><svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
									<span style="vertical-align: middle;">49663</span>
									</div>
								</div>
							</div>

													</div>
						<!-- choadi 手机端适配 结束-->

						
						<hr aria-hidden="true" style="border-top: 1px solid #f5f6f7;">

						<div class="message " isfirst="1">
							<input type="hidden" id="content_show" value="1">
														
							<p><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_0"><span>自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤？</span><br></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_1"><span>背景：</span></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这篇文章主要是针对设备指纹层面的一个整体的对抗思路 ，可能网上会有相似的文章，但是都不适用于现在的环境 ，想着简单梳理一下，之前是二次打包，只能在客户端去修改，所以需要去hook binder的这些方法，实现hook的拦截 ，但是留的痕迹也很多，很难做到不修改客户端，但是现在我们是在Root的环境下 ，很多东西玩法就变了 &nbsp;。最早是Magisk可以在系统层做一些文件替换，现在的Apatch出来以后，很多对抗都放在了内核里面，直接从应用层修改直接跳转到内核 （说好的不进入内核呢？），最早之前很多可能还是通过编译自定义ROM或者自定义内核之类的去实现对抗 ，现在看起来有点鸡肋 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>下面的内容也只是我个人所感所想，如果有更好的思路，或者文中有什么地方没有讲述清除，讲述错误的地方也可以随时回复。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>基础知识：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/thread-273838.htm"><span>风控对抗基础随笔</span></a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>设备指纹第一篇：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/thread-273759.htm"><span>聊聊大厂设备指纹获取和对抗&amp;设备指纹看着一篇就够了!</span></a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>设备指纹第二篇：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/thread-277402.htm"><span>聊聊大厂设备指纹其二&amp;Hunter环境检测思路详解!</span></a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>设备指纹第三篇：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/thread-277637.htm"><span>聊聊大厂设备指纹其三&amp;如何在风控对抗这场“猫鼠游戏”中转换角色!</span></a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这篇文章是第四篇 ，主要是针对架构的事情进行演练和梳理，通过“推演”的方式去模拟一场战斗。而我们</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>站在“玩家”视角去推断这场战斗胜负。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>其实在第三篇文章里面结论：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>我们只需要让客户端安全SDK检测“失效”即可做到黑产的自动化爬取 。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这个失效并不是说让他不上报，而是检测不到 ，但是在客户端还要实现那么多对抗 ，比如一键新机，包括各种复杂的环境检测都需要绕过 ，也不是一件简单的事情 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我之前写过一个软件叫Hunter，它主要就是检测客户端的风险项，在不断和黑产对抗测试的过程中发现，很多攻击者的攻击方式很有趣，有硬件断点逃逸内存CRC检测，有内核注入的，有直接在服务端修改直接修改客户端返回值的。发现绕过的办法千奇百怪 ，但是他们核心的思路就是 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>客户端不注入不修改一丁点代码，但是可以实现一键新机 。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>下来我们就聊一下，客户端应该怎么做才能实现这个功能的 ？中间有哪些坑？为什么要这么做？</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>原理&amp;细节这几个角度去综合分析一下。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_2"><span>模拟战争环境：</span></h1><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_0"><span>对手模拟：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>假设我们的对手是目前国内Apk风控的天花板 ，每个策略都是熟练掌握客户端对抗的人 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>客户端也是顶级检测团队 ，如果发现客户端一丁点风险可以写策略对其打击 &nbsp;，比如下面的一些常见操作。</span></p><ul style="margin-top:0.8em; margin-bottom:0.8em; padding-left:30px; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><li><p style="line-height:1; margin-bottom:0.5rem;"><span>行为识别&amp;Socket埋点上报（检测用户是否是正常用户，判断指定场景埋点等信息是否正常）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>查杀分离（当发现客户端存在问题的时候，不会立刻去封你的号，防止客户端测试找到封号点 ）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>点击路径矩阵（记录当前对当前页面的点击操作坐标）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>多层策略嵌套（服务端有历史各种策略，如果某一个点没有改机改全，即可封号，被降权）</span></p><blockquote><p style="line-height:1;"><span>比如在A地方获取设备信息B ，在C地方获取的也是设备信息B 。如果A和C获取结果不一样，则认为设备异常，这种多级校准策略</span></p></blockquote></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>安全SDK检测能力天花板：</span></p><p style="line-height:1; margin-top:0.5rem; margin-bottom:0.5rem;"><span>（安全SDK检测能力也是国内的天花板，Hook,沙箱，重打包，Hook框架等检测也是最强，</span><span><strong>我们暴露给的只有手机解锁</strong></span><span>）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>AI用户行为&amp;策略学习</span></p><p style="line-height:1; margin-top:0.5rem; margin-bottom:0.5rem;"><span>（不断地自动化推导当前用户是否是一个正常设备）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>实时监控与响应：</span></p><p style="line-height:1; margin-top:0.5rem; margin-bottom:0.5rem;"><span>（实时监控客户端行为，及时发现异常并采取相应的应对措施。）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>IP聚集性检测等</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>抓取频次策略</span></p><p style="line-height:1; margin-top:0.5rem; margin-bottom:0.5rem;"><span>（比如一分钟/一小时/24小时，抓取多少）</span></p></li></ul><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>在上述情况同时存在的情况下 ，我们应该如何绕过，实现抓取量化呢？</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_1"><span>对抗模拟：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>第一步：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>5台手机，20个账号 。 一个账号假设阈值为1000数据量/一天。超过数据量即封号。先把第一步跑通以后，后面逐步增加设备和账号。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span style="min-width:10px; min-height:10px; font-family:monospace; width:1140px;"><img referrerpolicy="no-referrer" alt="image-20240524185544391" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/DN3YE7NMDAM222P.jpg" style="cursor: zoom-in;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934_24U4RV5F65C38SG.webp" referrerpolicy="no-referrer" class="div_message_boxShadow" style="cursor: zoom-in;"></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这些是一个简单的架构图，客户端里面的【设备指纹】和【环境信息对抗】是这部分最核心的 。全文30%架构设计，70%跟设备对抗相关 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>手机系统有要求：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>需要Android 11以上，13以上最好，刷入了Apatch 。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块有个细节点，为什么需要Android11以上的手机呢？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>这个其实是因为Android的一个严重漏洞导致的，就是Android11以下，哪怕没有权限也可以通过netlinker直接获取到你得网卡信息 ，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>详细代码实现可以参考我之前写的文章：这个代码在github有开源 </span><span><a href="https://bbs.kanxue.com/thread-271698.htm">https://bbs.kanxue.com/thread-271698.htm</a></span><span> 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>（不过我只有10以下的手机的话，可以直接往内核打补丁，然后重新编译内核刷入，也是可以的，不过麻烦点，不推荐）</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>不需要任何授权，而且还可以读一些net文件直接通过cat的方式获取 ，而且11以下，还有可以使用老的SD卡读写权限，直接往SD卡写入。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>新版本只允许你往/sdcard/Android/data/包名里面去写入SD卡相关数据，这样在Apk卸载的时候直接就会一起删除。有很多大厂的指纹非常恶心。</span></p><p style="line-height:1; margin-top:0.8em;"><span>会往SD卡里面写入一些文件种子，如果不进行隔离，很难改的全。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>后面我会详细慢慢说，为什么需要使用Apatch ，包括为什么不用Magisk。</span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_2"><span>客户端架构：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>客户端想要实现的功能就两部分【设备指纹对抗】&amp;【环境信息对抗】 ，我修改指纹之前，需要先需要知道设备指纹是怎么产生的，比如一些有用的设备指纹比如最基本的一个AndroidId这种，他的产生就在服务端 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>我们为了尽可能让客户端设备指纹对抗做的隐藏，因为我们不能修改目标Apk任何代码，所以就需要在他生产的地方进行修改。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>下面简单将设备指纹梳理一下 。</span></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_0"><span>设备指纹分类：</span></h3><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>系统服务相关设备指纹相关</span></h4><table width="1140" style="width:1077px;"><thead style="background-color:rgb(248, 248, 248);"><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>设备指纹分类</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>产生位置</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:173.333px; min-height:10px;"><span>描述</span></span></th></tr></thead><tbody><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>Android Id</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>system_server</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>各种Id IMEI这些</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>system_server</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>Apk包相关</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>system_server</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>蓝牙相关</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>system_server</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:456.667px; min-height:10px;"><span>wifi信息相关</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:429.333px; min-height:10px;"><span>system_server</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr></tbody></table><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>其他ApkSettingsProvider提供相关</span></h4><table width="1140" style="width:1077px;"><thead style="background-color:rgb(248, 248, 248);"><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:122.667px; min-height:10px;"><span>设备指纹分类</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:46.6667px; min-height:10px;"><span>产生位置</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:890px; min-height:10px;"><span>描述</span></span></th></tr></thead><tbody><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:122.667px; min-height:10px;"><span>SettingsProvider</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:46.6667px; min-height:10px;"><span>安全中心</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:890px; min-height:10px;"><span>比如oaid，这种获取方式就是通过内容提供者的方式，通过某个Apk提供的,比如小米的就是小米的安全中心提供的,可以直接在小米安全中心进程去做Hook 。</span></span></td></tr></tbody></table><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>内核ID相关</span></h4><table width="1140" style="width:1077px;"><thead style="background-color:rgb(248, 248, 248);"><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:288px; min-height:10px;"><span>设备指纹分类（内核相关）</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:76.6667px; min-height:10px;"><span>产生位置</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:694.667px; min-height:10px;"><span>描述</span></span></th></tr></thead><tbody><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:288px; min-height:10px;"><span>/proc/sys/kernel/random/boot_id</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:76.6667px; min-height:10px;"><span>内核</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:694.667px; min-height:10px;"><span>保存内核相关,修改11以上可能导致RES资源文件出现问题,需要用mknod去进行修改。</span></span></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:288px; min-height:10px;"><span>/sys/block/mmcblk0/device/cid</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:76.6667px; min-height:10px;"><span>内核</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:288px; min-height:10px;"><span>/sys/block/mmcblk0/device/serial</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:76.6667px; min-height:10px;"><span>内核</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:288px; min-height:10px;"><span>/sys/devices/soc0/serial_number</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:76.6667px; min-height:10px;"><span>内核</span></span></td><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:694.667px; min-height:10px;"><span>cpu协议, 有的cpu不支持</span></span></td></tr></tbody></table><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>Init进程设备指纹相关</span></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这个进程比较特殊，init进程，init进程是最早的进程。内核启动的第一条进程 ，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>目前发现DRM产生位置是在init进程产生的 。底层通过native binder进行的通讯 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如DRM如果想修改，可以在客户端获取的时候去修改，Java和C 都需要进行Hook 。比如常见的Java和C获取 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;">Java获取如下：</p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">android.media.MediaDrm;</code></div><div class="line number2 index1 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.util.UUID;</code></div><div class="line number3 index2 alt2"><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number4 index3 alt1"><code class="java plain">UUID&nbsp;wideVineUuid&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">UUID(-0x121074568629b532L,&nbsp;-0x5c37d8232ae2de13L);</code></div><div class="line number5 index4 alt2"><code class="java plain">MediaDrm&nbsp;wvDrm&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">MediaDrm(wideVineUuid);</code></div><div class="line number6 index5 alt1"><code class="java keyword">byte</code><code class="java plain">[]&nbsp;wideVineId&nbsp;=</code></div><div class="line number7 index6 alt2"><code class="java plain">wvDrm.getPropertyByteArray(MediaDrm.PROPERTY_DEVICE_UNIQUE_ID);</code></div><div class="line number8 index7 alt1"><code class="java plain">Log.i(</code><code class="java string">"DRM&nbsp;ID"</code><code class="java plain">,&nbsp;bytesToHex(wideVineId));</code></div><div class="line number9 index8 alt2"><code class="java plain">wvDrm.release();</code></div><div class="line number10 index9 alt1"><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(UnsupportedSchemeException&nbsp;e)&nbsp;{</code></div><div class="line number11 index10 alt2"><code class="java plain">e.printStackTrace();</code></div><div class="line number12 index11 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p>c获取如下：</p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include&nbsp;&lt;media/NdkMediaDrm.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">uint8_t&nbsp;</code><code class="cpp keyword bold">uuid</code><code class="cpp plain">[]&nbsp;=</code></div><div class="line number3 index2 alt2"><code class="cpp plain">{0xed,0xef,0x8b,0xa9,0x79,0xd6,0x4a,0xce,0xa3,0xc8,0x27,0xdc,0xd5,0x1d,0x21,0xed</code></div><div class="line number4 index3 alt1"><code class="cpp plain">};</code></div><div class="line number5 index4 alt2"><code class="cpp plain">AMediaDrm&nbsp;*mediaDrm&nbsp;=&nbsp;AMediaDrm_createByUUID(</code><code class="cpp keyword bold">uuid</code><code class="cpp plain">);</code></div><div class="line number6 index5 alt1"><code class="cpp plain">AMediaDrmByteArray&nbsp;aMediaDrmByteArray;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">AMediaDrm_getPropertyByteArray(mediaDrm,&nbsp;PROPERTY_DEVICE_UNIQUE_ID,</code></div><div class="line number8 index7 alt1"><code class="cpp plain">&amp;aMediaDrmByteArray);</code></div><div class="line number9 index8 alt2"><code class="cpp plain">AMediaDrm_release(mediaDrm);</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><br></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这个C和Java的最终流程都是调用init进程的IPC进行获取的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>最终进程位置在 ，android.hardware.drm这个里面 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><br></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">C:\Users\ASUS&gt;adb&nbsp;shell</code></div><div class="line number2 index1 alt1"><code class="cpp plain">cmi:/&nbsp;$&nbsp;su</code></div><div class="line number3 index2 alt2"><code class="cpp plain">cmi:/&nbsp;#&nbsp;ps&nbsp;-ef&nbsp;|&nbsp;grep&nbsp;-service.widevine&nbsp;|&nbsp;grep&nbsp;android.hardware.drm</code></div><div class="line number4 index3 alt1"><code class="cpp plain">media&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1069&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;0&nbsp;19:31:15&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;android.hardware.drm@1.3-service.widevine</code></div></div></td></tr></tbody></table><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>Apk环境相关</span><br></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>环境相关指的是getprop的方式去获取的，一些环境相关的设备指纹。</span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_3"><span>设备指纹对抗：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>经过上面的梳理 ，我们发现设备指纹主要的产生位置分为五大类，这五大类，可以包含安卓目前全部的设备指纹产生方式 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>下来我们需要对这些进程进行Hook和修改 ，因为我们不能再客户端进程去修改，所以需要在这五大设备指纹产生类型的地方进行修改。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_4"><span>前置准备 ：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们需要用Magisk模块去实现一个Xposed ，为什么要自己去实现一个呢？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>因为在可以用Magisk模块在指定进程注入lsplant，实现Java Hook， 比如修改system_server里面的去hook一些Java方法</span></p><p style="line-height:1; margin-top:0.8em;"><span>很方便，自己实现的话逻辑也可控 ，方便Hook除了目标Apk以外的其他进程。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块实现也很简单，lsposed是开源的 。这块还是建议从头写一遍，加深印象，如果有什么不明白的 再去lsposed里面翻源码 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块简单说一下具体的实现思路 &nbsp;。</span></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_1"><span>Magisk模块基础：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>Magisk模块提供了 Zygisk进行注入 ， 其实是提供了五个方法，分别是 。</span></p><ul style="margin-top:0.8em; margin-bottom:0.8em; padding-left:30px; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><li><p style="line-height:1; margin-bottom:0.5rem;"><span>onLoad</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>preAppSpecialize</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>postAppSpecialize</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>preServerSpecialize</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>postServerSpecialize</span></p></li></ul><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这五个方法也是zygisk对应的接口，相当于Xposed的Loadpackage 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>其实我们会发现 有一个pre和一个post ，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>pre方法是指，当前没有被设置沙箱化 ，比如我们的Apk在zygote里面孵化出来的时候，就是一条普通的进程，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>为什么只允许读取/data/data/包名下的内容 ，而不能读取别的apk里面的内容 ，是因为被专业化的操作了 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>Magisk模块里面叫specialization &nbsp;。下面是magisk模块头文件里面的原话，翻译是gpt翻译的。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">On&nbsp;Android,&nbsp;all&nbsp;app&nbsp;processes&nbsp;are&nbsp;forked&nbsp;from&nbsp;a&nbsp;special&nbsp;daemon&nbsp;called&nbsp;</code><code class="cpp string">"Zygote"</code><code class="cpp plain">.</code></div><div class="line number2 index1 alt1"><code class="cpp plain">For&nbsp;each&nbsp;</code><code class="cpp keyword bold">new</code>&nbsp;<code class="cpp plain">app&nbsp;process,&nbsp;zygote&nbsp;will&nbsp;fork&nbsp;a&nbsp;</code><code class="cpp keyword bold">new</code>&nbsp;<code class="cpp plain">process&nbsp;and&nbsp;perform&nbsp;</code><code class="cpp string">"specialization"</code><code class="cpp plain">.</code></div><div class="line number3 index2 alt2"><code class="cpp plain">This&nbsp;specialization&nbsp;operation&nbsp;enforces&nbsp;the&nbsp;Android&nbsp;security&nbsp;sandbox&nbsp;on&nbsp;the&nbsp;newly&nbsp;forked</code></div><div class="line number4 index3 alt1"><code class="cpp plain">process&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;3rd&nbsp;party&nbsp;application&nbsp;code&nbsp;is&nbsp;only&nbsp;loaded&nbsp;after&nbsp;it&nbsp;is&nbsp;being</code></div><div class="line number5 index4 alt2"><code class="cpp plain">restricted&nbsp;within&nbsp;a&nbsp;sandbox.</code></div><div class="line number6 index5 alt1"><code class="cpp plain">在&nbsp;Android&nbsp;上，所有的应用进程都是从一个特殊的守护进程&nbsp;</code><code class="cpp string">"Zygote"</code>&nbsp;<code class="cpp plain">分叉(fork)出来的。</code></div><div class="line number7 index6 alt2"><code class="cpp plain">对于每一个新的应用进程，Zygote&nbsp;会分叉一个新进程并进行&nbsp;</code><code class="cpp string">"(specialization)"</code>&nbsp;<code class="cpp plain">操作。</code></div><div class="line number8 index7 alt1"><code class="cpp plain">这个专门化操作强制实施&nbsp;Android&nbsp;安全沙盒，确保第三方应用代码只有在被限制在沙盒中之后才加载。</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="cpp plain">On&nbsp;Android,&nbsp;there&nbsp;is&nbsp;also&nbsp;</code><code class="cpp keyword bold">this</code>&nbsp;<code class="cpp plain">special&nbsp;process&nbsp;called&nbsp;</code><code class="cpp string">"system_server"</code><code class="cpp plain">.&nbsp;This&nbsp;single</code></div><div class="line number11 index10 alt2"><code class="cpp plain">process&nbsp;hosts&nbsp;a&nbsp;significant&nbsp;portion&nbsp;of&nbsp;</code><code class="cpp functions bold">system</code>&nbsp;<code class="cpp plain">services,&nbsp;which&nbsp;controls&nbsp;how&nbsp;the</code></div><div class="line number12 index11 alt1"><code class="cpp plain">Android&nbsp;operating&nbsp;</code><code class="cpp functions bold">system</code>&nbsp;<code class="cpp plain">and&nbsp;apps&nbsp;interact&nbsp;with&nbsp;each&nbsp;other.</code></div><div class="line number13 index12 alt2"><code class="cpp plain">在&nbsp;Android&nbsp;上，还有一个特殊的进程叫做&nbsp;</code><code class="cpp string">"system_server"</code><code class="cpp plain">。</code></div><div class="line number14 index13 alt1"><code class="cpp plain">这个单一进程承载了大部分的系统服务，控制着&nbsp;Android&nbsp;操作系统和应用程序之间的互动方式。</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="cpp plain">The&nbsp;Zygisk&nbsp;framework&nbsp;provides&nbsp;a&nbsp;way&nbsp;to&nbsp;allow&nbsp;developers&nbsp;to&nbsp;build&nbsp;modules&nbsp;and&nbsp;run&nbsp;custom</code></div><div class="line number17 index16 alt2"><code class="cpp plain">code&nbsp;before&nbsp;and&nbsp;after&nbsp;system_server&nbsp;and&nbsp;any&nbsp;app&nbsp;processes'&nbsp;specialization.</code></div><div class="line number18 index17 alt1"><code class="cpp plain">This&nbsp;enable&nbsp;developers&nbsp;to&nbsp;inject&nbsp;code&nbsp;and&nbsp;alter&nbsp;the&nbsp;behavior&nbsp;of&nbsp;system_server&nbsp;and&nbsp;app&nbsp;processes.</code></div><div class="line number19 index18 alt2"><code class="cpp plain">Zygisk&nbsp;框架提供了一种方法，允许开发者构建模块并在&nbsp;system_server</code></div><div class="line number20 index19 alt1"><code class="cpp plain">和任何应用进程的specialization之前和之后运行自定义代码。</code></div><div class="line number21 index20 alt2"><code class="cpp plain">这使开发者能够注入代码并改变&nbsp;system_server&nbsp;和应用进程的行为。</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="cpp plain">Please&nbsp;note&nbsp;that&nbsp;modules&nbsp;will&nbsp;only&nbsp;be&nbsp;loaded&nbsp;after&nbsp;zygote&nbsp;has&nbsp;forked&nbsp;the&nbsp;child&nbsp;process.</code></div><div class="line number24 index23 alt1"><code class="cpp plain">THIS&nbsp;MEANS&nbsp;ALL&nbsp;OF&nbsp;YOUR&nbsp;CODE&nbsp;RUNS&nbsp;IN&nbsp;THE&nbsp;APP/SYSTEM_SERVER&nbsp;PROCESS,&nbsp;NOT&nbsp;THE&nbsp;ZYGOTE&nbsp;DAEMON!</code></div><div class="line number25 index24 alt2"><code class="cpp plain">请注意，模块只会在&nbsp;Zygote&nbsp;fork&nbsp;子进程之后加载。</code></div><div class="line number26 index25 alt1"><code class="cpp plain">这意味着你的所有代码都是在应用/系统服务器进程中运行，而不是在&nbsp;Zygote&nbsp;守护进程中运行！</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><br></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>所以我们可以在某个Apk 没有被设置selinux规则和沙箱话之前进行一些操作 。比如chroot这种都可以进行，比如shamiko好像就是执行chroot，这时候各种权限都没有，让我们的目标App单独隔离到一个新的根目录下，实现的过掉root检测 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>post是被设置专业化完毕以后的回调，pre是设置专业化之前 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>五个方法其中两个是系统服务的，pre和post，另外的是当某个App加载的pre和post 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>为了方便学习，我让gtp把这个zygisk.hpp翻译了一下 ，可以参考中文去学习magisk模块的基本Api操作 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><br></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div><div class="line number243 index242 alt2">243</div><div class="line number244 index243 alt1">244</div><div class="line number245 index244 alt2">245</div><div class="line number246 index245 alt1">246</div><div class="line number247 index246 alt2">247</div><div class="line number248 index247 alt1">248</div><div class="line number249 index248 alt2">249</div><div class="line number250 index249 alt1">250</div><div class="line number251 index250 alt2">251</div><div class="line number252 index251 alt1">252</div><div class="line number253 index252 alt2">253</div><div class="line number254 index253 alt1">254</div><div class="line number255 index254 alt2">255</div><div class="line number256 index255 alt1">256</div><div class="line number257 index256 alt2">257</div><div class="line number258 index257 alt1">258</div><div class="line number259 index258 alt2">259</div><div class="line number260 index259 alt1">260</div><div class="line number261 index260 alt2">261</div><div class="line number262 index261 alt1">262</div><div class="line number263 index262 alt2">263</div><div class="line number264 index263 alt1">264</div><div class="line number265 index264 alt2">265</div><div class="line number266 index265 alt1">266</div><div class="line number267 index266 alt2">267</div><div class="line number268 index267 alt1">268</div><div class="line number269 index268 alt2">269</div><div class="line number270 index269 alt1">270</div><div class="line number271 index270 alt2">271</div><div class="line number272 index271 alt1">272</div><div class="line number273 index272 alt2">273</div><div class="line number274 index273 alt1">274</div><div class="line number275 index274 alt2">275</div><div class="line number276 index275 alt1">276</div><div class="line number277 index276 alt2">277</div><div class="line number278 index277 alt1">278</div><div class="line number279 index278 alt2">279</div><div class="line number280 index279 alt1">280</div><div class="line number281 index280 alt2">281</div><div class="line number282 index281 alt1">282</div><div class="line number283 index282 alt2">283</div><div class="line number284 index283 alt1">284</div><div class="line number285 index284 alt2">285</div><div class="line number286 index285 alt1">286</div><div class="line number287 index286 alt2">287</div><div class="line number288 index287 alt1">288</div><div class="line number289 index288 alt2">289</div><div class="line number290 index289 alt1">290</div><div class="line number291 index290 alt2">291</div><div class="line number292 index291 alt1">292</div><div class="line number293 index292 alt2">293</div><div class="line number294 index293 alt1">294</div><div class="line number295 index294 alt2">295</div><div class="line number296 index295 alt1">296</div><div class="line number297 index296 alt2">297</div><div class="line number298 index297 alt1">298</div><div class="line number299 index298 alt2">299</div><div class="line number300 index299 alt1">300</div><div class="line number301 index300 alt2">301</div><div class="line number302 index301 alt1">302</div><div class="line number303 index302 alt2">303</div><div class="line number304 index303 alt1">304</div><div class="line number305 index304 alt2">305</div><div class="line number306 index305 alt1">306</div><div class="line number307 index306 alt2">307</div><div class="line number308 index307 alt1">308</div><div class="line number309 index308 alt2">309</div><div class="line number310 index309 alt1">310</div><div class="line number311 index310 alt2">311</div><div class="line number312 index311 alt1">312</div><div class="line number313 index312 alt2">313</div><div class="line number314 index313 alt1">314</div><div class="line number315 index314 alt2">315</div><div class="line number316 index315 alt1">316</div><div class="line number317 index316 alt2">317</div><div class="line number318 index317 alt1">318</div><div class="line number319 index318 alt2">319</div><div class="line number320 index319 alt1">320</div><div class="line number321 index320 alt2">321</div><div class="line number322 index321 alt1">322</div><div class="line number323 index322 alt2">323</div><div class="line number324 index323 alt1">324</div><div class="line number325 index324 alt2">325</div><div class="line number326 index325 alt1">326</div><div class="line number327 index326 alt2">327</div><div class="line number328 index327 alt1">328</div><div class="line number329 index328 alt2">329</div><div class="line number330 index329 alt1">330</div><div class="line number331 index330 alt2">331</div><div class="line number332 index331 alt1">332</div><div class="line number333 index332 alt2">333</div><div class="line number334 index333 alt1">334</div><div class="line number335 index334 alt2">335</div><div class="line number336 index335 alt1">336</div><div class="line number337 index336 alt2">337</div><div class="line number338 index337 alt1">338</div><div class="line number339 index338 alt2">339</div><div class="line number340 index339 alt1">340</div><div class="line number341 index340 alt2">341</div><div class="line number342 index341 alt1">342</div><div class="line number343 index342 alt2">343</div><div class="line number344 index343 alt1">344</div><div class="line number345 index344 alt2">345</div><div class="line number346 index345 alt1">346</div><div class="line number347 index346 alt2">347</div><div class="line number348 index347 alt1">348</div><div class="line number349 index348 alt2">349</div><div class="line number350 index349 alt1">350</div><div class="line number351 index350 alt2">351</div><div class="line number352 index351 alt1">352</div><div class="line number353 index352 alt2">353</div><div class="line number354 index353 alt1">354</div><div class="line number355 index354 alt2">355</div><div class="line number356 index355 alt1">356</div><div class="line number357 index356 alt2">357</div><div class="line number358 index357 alt1">358</div><div class="line number359 index358 alt2">359</div><div class="line number360 index359 alt1">360</div><div class="line number361 index360 alt2">361</div><div class="line number362 index361 alt1">362</div><div class="line number363 index362 alt2">363</div><div class="line number364 index363 alt1">364</div><div class="line number365 index364 alt2">365</div><div class="line number366 index365 alt1">366</div><div class="line number367 index366 alt2">367</div><div class="line number368 index367 alt1">368</div><div class="line number369 index368 alt2">369</div><div class="line number370 index369 alt1">370</div><div class="line number371 index370 alt2">371</div><div class="line number372 index371 alt1">372</div><div class="line number373 index372 alt2">373</div><div class="line number374 index373 alt1">374</div><div class="line number375 index374 alt2">375</div><div class="line number376 index375 alt1">376</div><div class="line number377 index376 alt2">377</div><div class="line number378 index377 alt1">378</div><div class="line number379 index378 alt2">379</div><div class="line number380 index379 alt1">380</div><div class="line number381 index380 alt2">381</div><div class="line number382 index381 alt1">382</div><div class="line number383 index382 alt2">383</div><div class="line number384 index383 alt1">384</div><div class="line number385 index384 alt2">385</div><div class="line number386 index385 alt1">386</div><div class="line number387 index386 alt2">387</div><div class="line number388 index387 alt1">388</div><div class="line number389 index388 alt2">389</div><div class="line number390 index389 alt1">390</div><div class="line number391 index390 alt2">391</div><div class="line number392 index391 alt1">392</div><div class="line number393 index392 alt2">393</div><div class="line number394 index393 alt1">394</div><div class="line number395 index394 alt2">395</div><div class="line number396 index395 alt1">396</div><div class="line number397 index396 alt2">397</div><div class="line number398 index397 alt1">398</div><div class="line number399 index398 alt2">399</div><div class="line number400 index399 alt1">400</div><div class="line number401 index400 alt2">401</div><div class="line number402 index401 alt1">402</div><div class="line number403 index402 alt2">403</div><div class="line number404 index403 alt1">404</div><div class="line number405 index404 alt2">405</div><div class="line number406 index405 alt1">406</div><div class="line number407 index406 alt2">407</div><div class="line number408 index407 alt1">408</div><div class="line number409 index408 alt2">409</div><div class="line number410 index409 alt1">410</div><div class="line number411 index410 alt2">411</div><div class="line number412 index411 alt1">412</div><div class="line number413 index412 alt2">413</div><div class="line number414 index413 alt1">414</div><div class="line number415 index414 alt2">415</div><div class="line number416 index415 alt1">416</div><div class="line number417 index416 alt2">417</div><div class="line number418 index417 alt1">418</div><div class="line number419 index418 alt2">419</div><div class="line number420 index419 alt1">420</div><div class="line number421 index420 alt2">421</div><div class="line number422 index421 alt1">422</div><div class="line number423 index422 alt2">423</div><div class="line number424 index423 alt1">424</div><div class="line number425 index424 alt2">425</div><div class="line number426 index425 alt1">426</div><div class="line number427 index426 alt2">427</div><div class="line number428 index427 alt1">428</div><div class="line number429 index428 alt2">429</div><div class="line number430 index429 alt1">430</div><div class="line number431 index430 alt2">431</div><div class="line number432 index431 alt1">432</div><div class="line number433 index432 alt2">433</div><div class="line number434 index433 alt1">434</div><div class="line number435 index434 alt2">435</div><div class="line number436 index435 alt1">436</div><div class="line number437 index436 alt2">437</div><div class="line number438 index437 alt1">438</div><div class="line number439 index438 alt2">439</div><div class="line number440 index439 alt1">440</div><div class="line number441 index440 alt2">441</div><div class="line number442 index441 alt1">442</div><div class="line number443 index442 alt2">443</div><div class="line number444 index443 alt1">444</div><div class="line number445 index444 alt2">445</div><div class="line number446 index445 alt1">446</div><div class="line number447 index446 alt2">447</div><div class="line number448 index447 alt1">448</div><div class="line number449 index448 alt2">449</div><div class="line number450 index449 alt1">450</div><div class="line number451 index450 alt2">451</div><div class="line number452 index451 alt1">452</div><div class="line number453 index452 alt2">453</div><div class="line number454 index453 alt1">454</div><div class="line number455 index454 alt2">455</div><div class="line number456 index455 alt1">456</div><div class="line number457 index456 alt2">457</div><div class="line number458 index457 alt1">458</div><div class="line number459 index458 alt2">459</div><div class="line number460 index459 alt1">460</div><div class="line number461 index460 alt2">461</div><div class="line number462 index461 alt1">462</div><div class="line number463 index462 alt2">463</div><div class="line number464 index463 alt1">464</div><div class="line number465 index464 alt2">465</div><div class="line number466 index465 alt1">466</div><div class="line number467 index466 alt2">467</div><div class="line number468 index467 alt1">468</div><div class="line number469 index468 alt2">469</div><div class="line number470 index469 alt1">470</div><div class="line number471 index470 alt2">471</div><div class="line number472 index471 alt1">472</div><div class="line number473 index472 alt2">473</div><div class="line number474 index473 alt1">474</div><div class="line number475 index474 alt2">475</div><div class="line number476 index475 alt1">476</div><div class="line number477 index476 alt2">477</div><div class="line number478 index477 alt1">478</div><div class="line number479 index478 alt2">479</div><div class="line number480 index479 alt1">480</div><div class="line number481 index480 alt2">481</div><div class="line number482 index481 alt1">482</div><div class="line number483 index482 alt2">483</div><div class="line number484 index483 alt1">484</div><div class="line number485 index484 alt2">485</div><div class="line number486 index485 alt1">486</div><div class="line number487 index486 alt2">487</div><div class="line number488 index487 alt1">488</div><div class="line number489 index488 alt2">489</div><div class="line number490 index489 alt1">490</div><div class="line number491 index490 alt2">491</div><div class="line number492 index491 alt1">492</div><div class="line number493 index492 alt2">493</div><div class="line number494 index493 alt1">494</div><div class="line number495 index494 alt2">495</div><div class="line number496 index495 alt1">496</div><div class="line number497 index496 alt2">497</div><div class="line number498 index497 alt1">498</div><div class="line number499 index498 alt2">499</div><div class="line number500 index499 alt1">500</div><div class="line number501 index500 alt2">501</div><div class="line number502 index501 alt1">502</div><div class="line number503 index502 alt2">503</div><div class="line number504 index503 alt1">504</div><div class="line number505 index504 alt2">505</div><div class="line number506 index505 alt1">506</div><div class="line number507 index506 alt2">507</div><div class="line number508 index507 alt1">508</div><div class="line number509 index508 alt2">509</div><div class="line number510 index509 alt1">510</div><div class="line number511 index510 alt2">511</div><div class="line number512 index511 alt1">512</div><div class="line number513 index512 alt2">513</div><div class="line number514 index513 alt1">514</div><div class="line number515 index514 alt2">515</div><div class="line number516 index515 alt1">516</div><div class="line number517 index516 alt2">517</div><div class="line number518 index517 alt1">518</div><div class="line number519 index518 alt2">519</div><div class="line number520 index519 alt1">520</div><div class="line number521 index520 alt2">521</div><div class="line number522 index521 alt1">522</div><div class="line number523 index522 alt2">523</div><div class="line number524 index523 alt1">524</div><div class="line number525 index524 alt2">525</div><div class="line number526 index525 alt1">526</div><div class="line number527 index526 alt2">527</div><div class="line number528 index527 alt1">528</div><div class="line number529 index528 alt2">529</div><div class="line number530 index529 alt1">530</div><div class="line number531 index530 alt2">531</div><div class="line number532 index531 alt1">532</div><div class="line number533 index532 alt2">533</div><div class="line number534 index533 alt1">534</div><div class="line number535 index534 alt2">535</div><div class="line number536 index535 alt1">536</div><div class="line number537 index536 alt2">537</div><div class="line number538 index537 alt1">538</div><div class="line number539 index538 alt2">539</div><div class="line number540 index539 alt1">540</div><div class="line number541 index540 alt2">541</div><div class="line number542 index541 alt1">542</div><div class="line number543 index542 alt2">543</div><div class="line number544 index543 alt1">544</div><div class="line number545 index544 alt2">545</div><div class="line number546 index545 alt1">546</div><div class="line number547 index546 alt2">547</div><div class="line number548 index547 alt1">548</div><div class="line number549 index548 alt2">549</div><div class="line number550 index549 alt1">550</div><div class="line number551 index550 alt2">551</div><div class="line number552 index551 alt1">552</div><div class="line number553 index552 alt2">553</div><div class="line number554 index553 alt1">554</div><div class="line number555 index554 alt2">555</div><div class="line number556 index555 alt1">556</div><div class="line number557 index556 alt2">557</div><div class="line number558 index557 alt1">558</div><div class="line number559 index558 alt2">559</div><div class="line number560 index559 alt1">560</div><div class="line number561 index560 alt2">561</div><div class="line number562 index561 alt1">562</div><div class="line number563 index562 alt2">563</div><div class="line number564 index563 alt1">564</div><div class="line number565 index564 alt2">565</div><div class="line number566 index565 alt1">566</div><div class="line number567 index566 alt2">567</div><div class="line number568 index567 alt1">568</div><div class="line number569 index568 alt2">569</div><div class="line number570 index569 alt1">570</div><div class="line number571 index570 alt2">571</div><div class="line number572 index571 alt1">572</div><div class="line number573 index572 alt2">573</div><div class="line number574 index573 alt1">574</div><div class="line number575 index574 alt2">575</div><div class="line number576 index575 alt1">576</div><div class="line number577 index576 alt2">577</div><div class="line number578 index577 alt1">578</div><div class="line number579 index578 alt2">579</div><div class="line number580 index579 alt1">580</div><div class="line number581 index580 alt2">581</div><div class="line number582 index581 alt1">582</div><div class="line number583 index582 alt2">583</div><div class="line number584 index583 alt1">584</div><div class="line number585 index584 alt2">585</div><div class="line number586 index585 alt1">586</div><div class="line number587 index586 alt2">587</div><div class="line number588 index587 alt1">588</div><div class="line number589 index588 alt2">589</div><div class="line number590 index589 alt1">590</div><div class="line number591 index590 alt2">591</div><div class="line number592 index591 alt1">592</div><div class="line number593 index592 alt2">593</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">/*&nbsp;Copyright&nbsp;2022-2023&nbsp;John&nbsp;"topjohnwu"&nbsp;Wu</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and/or&nbsp;distribute&nbsp;this&nbsp;software&nbsp;for&nbsp;any</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;purpose&nbsp;with&nbsp;or&nbsp;without&nbsp;fee&nbsp;is&nbsp;hereby&nbsp;granted.</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;THE&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;"AS&nbsp;IS"&nbsp;AND&nbsp;THE&nbsp;AUTHOR&nbsp;DISCLAIMS&nbsp;ALL&nbsp;WARRANTIES&nbsp;WITH</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;REGARD&nbsp;TO&nbsp;THIS&nbsp;SOFTWARE&nbsp;INCLUDING&nbsp;ALL&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;AND&nbsp;FITNESS.&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHOR&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;SPECIAL,&nbsp;DIRECT,</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;INDIRECT,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;OR&nbsp;ANY&nbsp;DAMAGES&nbsp;WHATSOEVER&nbsp;RESULTING&nbsp;FROM</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA&nbsp;OR&nbsp;PROFITS,&nbsp;WHETHER&nbsp;IN&nbsp;AN&nbsp;ACTION&nbsp;OF&nbsp;CONTRACT,&nbsp;NEGLIGENCE&nbsp;OR</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;OTHER&nbsp;TORTIOUS&nbsp;ACTION,&nbsp;ARISING&nbsp;OUT&nbsp;OF&nbsp;OR&nbsp;IN&nbsp;CONNECTION&nbsp;WITH&nbsp;THE&nbsp;USE&nbsp;OR</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;PERFORMANCE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE.</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp comments">//&nbsp;This&nbsp;is&nbsp;the&nbsp;public&nbsp;API&nbsp;for&nbsp;Zygisk&nbsp;modules.</code></div><div class="line number16 index15 alt1"><code class="cpp comments">//&nbsp;DO&nbsp;NOT&nbsp;MODIFY&nbsp;ANY&nbsp;CODE&nbsp;IN&nbsp;THIS&nbsp;HEADER.</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="cpp preprocessor">#pragma&nbsp;once</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="cpp preprocessor">#include&nbsp;&lt;jni.h&gt;</code></div><div class="line number21 index20 alt2"><code class="cpp preprocessor">#include&nbsp;&lt;ostream&gt;</code></div><div class="line number22 index21 alt1"><code class="cpp preprocessor">#include&nbsp;&lt;sstream&gt;</code></div><div class="line number23 index22 alt2"><code class="cpp preprocessor">#include&nbsp;&lt;string&gt;</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="cpp preprocessor">#define&nbsp;ZYGISK_API_VERSION&nbsp;4</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="cpp comments">/*</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="cpp comments">***************</code></div><div class="line number30 index29 alt1"><code class="cpp comments">*&nbsp;Introduction</code></div><div class="line number31 index30 alt2"><code class="cpp comments">***************</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="cpp comments">On&nbsp;Android,&nbsp;all&nbsp;app&nbsp;processes&nbsp;are&nbsp;forked&nbsp;from&nbsp;a&nbsp;special&nbsp;daemon&nbsp;called&nbsp;"Zygote".</code></div><div class="line number34 index33 alt1"><code class="cpp comments">For&nbsp;each&nbsp;new&nbsp;app&nbsp;process,&nbsp;zygote&nbsp;will&nbsp;fork&nbsp;a&nbsp;new&nbsp;process&nbsp;and&nbsp;perform&nbsp;"specialization".</code></div><div class="line number35 index34 alt2"><code class="cpp comments">This&nbsp;specialization&nbsp;operation&nbsp;enforces&nbsp;the&nbsp;Android&nbsp;security&nbsp;sandbox&nbsp;on&nbsp;the&nbsp;newly&nbsp;forked</code></div><div class="line number36 index35 alt1"><code class="cpp comments">process&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;3rd&nbsp;party&nbsp;application&nbsp;code&nbsp;is&nbsp;only&nbsp;loaded&nbsp;after&nbsp;it&nbsp;is&nbsp;being</code></div><div class="line number37 index36 alt2"><code class="cpp comments">restricted&nbsp;within&nbsp;a&nbsp;sandbox.</code></div><div class="line number38 index37 alt1"><code class="cpp comments">在&nbsp;Android&nbsp;上，所有的应用进程都是从一个特殊的守护进程&nbsp;"Zygote"&nbsp;分叉(fork)出来的。</code></div><div class="line number39 index38 alt2"><code class="cpp comments">对于每一个新的应用进程，Zygote&nbsp;会分叉一个新进程并进行&nbsp;"(specialization)"&nbsp;操作。</code></div><div class="line number40 index39 alt1"><code class="cpp comments">这个专门化操作强制实施&nbsp;Android&nbsp;安全沙盒，确保第三方应用代码只有在被限制在沙盒中之后才加载。</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="cpp comments">On&nbsp;Android,&nbsp;there&nbsp;is&nbsp;also&nbsp;this&nbsp;special&nbsp;process&nbsp;called&nbsp;"system_server".&nbsp;This&nbsp;single</code></div><div class="line number43 index42 alt2"><code class="cpp comments">process&nbsp;hosts&nbsp;a&nbsp;significant&nbsp;portion&nbsp;of&nbsp;system&nbsp;services,&nbsp;which&nbsp;controls&nbsp;how&nbsp;the</code></div><div class="line number44 index43 alt1"><code class="cpp comments">Android&nbsp;operating&nbsp;system&nbsp;and&nbsp;apps&nbsp;interact&nbsp;with&nbsp;each&nbsp;other.</code></div><div class="line number45 index44 alt2"><code class="cpp comments">在&nbsp;Android&nbsp;上，还有一个特殊的进程叫做&nbsp;"system_server"。</code></div><div class="line number46 index45 alt1"><code class="cpp comments">这个单一进程承载了大部分的系统服务，控制着&nbsp;Android&nbsp;操作系统和应用程序之间的互动方式。</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="cpp comments">The&nbsp;Zygisk&nbsp;framework&nbsp;provides&nbsp;a&nbsp;way&nbsp;to&nbsp;allow&nbsp;developers&nbsp;to&nbsp;build&nbsp;modules&nbsp;and&nbsp;run&nbsp;custom</code></div><div class="line number49 index48 alt2"><code class="cpp comments">code&nbsp;before&nbsp;and&nbsp;after&nbsp;system_server&nbsp;and&nbsp;any&nbsp;app&nbsp;processes'&nbsp;specialization.</code></div><div class="line number50 index49 alt1"><code class="cpp comments">This&nbsp;enable&nbsp;developers&nbsp;to&nbsp;inject&nbsp;code&nbsp;and&nbsp;alter&nbsp;the&nbsp;behavior&nbsp;of&nbsp;system_server&nbsp;and&nbsp;app&nbsp;processes.</code></div><div class="line number51 index50 alt2"><code class="cpp comments">Zygisk&nbsp;框架提供了一种方法，允许开发者构建模块并在&nbsp;system_server</code></div><div class="line number52 index51 alt1"><code class="cpp comments">和任何应用进程的specialization之前和之后运行自定义代码。</code></div><div class="line number53 index52 alt2"><code class="cpp comments">这使开发者能够注入代码并改变&nbsp;system_server&nbsp;和应用进程的行为。</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="cpp comments">Please&nbsp;note&nbsp;that&nbsp;modules&nbsp;will&nbsp;only&nbsp;be&nbsp;loaded&nbsp;after&nbsp;zygote&nbsp;has&nbsp;forked&nbsp;the&nbsp;child&nbsp;process.</code></div><div class="line number56 index55 alt1"><code class="cpp comments">THIS&nbsp;MEANS&nbsp;ALL&nbsp;OF&nbsp;YOUR&nbsp;CODE&nbsp;RUNS&nbsp;IN&nbsp;THE&nbsp;APP/SYSTEM_SERVER&nbsp;PROCESS,&nbsp;NOT&nbsp;THE&nbsp;ZYGOTE&nbsp;DAEMON!</code></div><div class="line number57 index56 alt2"><code class="cpp comments">请注意，模块只会在&nbsp;Zygote&nbsp;fork&nbsp;子进程之后加载。</code></div><div class="line number58 index57 alt1"><code class="cpp comments">这意味着你的所有代码都是在应用/系统服务器进程中运行，而不是在&nbsp;Zygote&nbsp;守护进程中运行！</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="cpp comments">*********************</code></div><div class="line number61 index60 alt2"><code class="cpp comments">*&nbsp;Development&nbsp;Guide</code></div><div class="line number62 index61 alt1"><code class="cpp comments">*********************</code></div><div class="line number63 index62 alt2">&nbsp;</div><div class="line number64 index63 alt1"><code class="cpp comments">Define&nbsp;a&nbsp;class&nbsp;and&nbsp;inherit&nbsp;zygisk::ModuleBase&nbsp;to&nbsp;implement&nbsp;the&nbsp;functionality&nbsp;of&nbsp;your&nbsp;module.</code></div><div class="line number65 index64 alt2"><code class="cpp comments">Use&nbsp;the&nbsp;macro&nbsp;REGISTER_ZYGISK_MODULE(className)&nbsp;to&nbsp;register&nbsp;that&nbsp;class&nbsp;to&nbsp;Zygisk.</code></div><div class="line number66 index65 alt1">&nbsp;</div><div class="line number67 index66 alt2"><code class="cpp comments">Example&nbsp;code:</code></div><div class="line number68 index67 alt1">&nbsp;</div><div class="line number69 index68 alt2"><code class="cpp comments">static&nbsp;jint&nbsp;(*orig_logger_entry_max)(JNIEnv&nbsp;*env);</code></div><div class="line number70 index69 alt1"><code class="cpp comments">static&nbsp;jint&nbsp;my_logger_entry_max(JNIEnv&nbsp;*env)&nbsp;{</code></div><div class="line number71 index70 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">return&nbsp;orig_logger_entry_max(env);</code></div><div class="line number72 index71 alt1"><code class="cpp comments">}</code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1"><code class="cpp comments">class&nbsp;ExampleModule&nbsp;:&nbsp;public&nbsp;zygisk::ModuleBase&nbsp;{</code></div><div class="line number75 index74 alt2"><code class="cpp comments">public:</code></div><div class="line number76 index75 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">void&nbsp;onLoad(zygisk::Api&nbsp;*api,&nbsp;JNIEnv&nbsp;*env)&nbsp;override&nbsp;{</code></div><div class="line number77 index76 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">this-&gt;api&nbsp;=&nbsp;api;</code></div><div class="line number78 index77 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">this-&gt;env&nbsp;=&nbsp;env;</code></div><div class="line number79 index78 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">}</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">void&nbsp;preAppSpecialize(zygisk::AppSpecializeArgs&nbsp;*args)&nbsp;override&nbsp;{</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">JNINativeMethod&nbsp;methods[]&nbsp;=&nbsp;{</code></div><div class="line number82 index81 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">{&nbsp;"logger_entry_max_payload_native",&nbsp;"()I",&nbsp;(void*)&nbsp;my_logger_entry_max&nbsp;},</code></div><div class="line number83 index82 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">};</code></div><div class="line number84 index83 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">api-&gt;hookJniNativeMethods(env,&nbsp;"android/util/Log",&nbsp;methods,&nbsp;1);</code></div><div class="line number85 index84 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*(void&nbsp;**)&nbsp;&amp;orig_logger_entry_max&nbsp;=&nbsp;methods[0].fnPtr;</code></div><div class="line number86 index85 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">}</code></div><div class="line number87 index86 alt2"><code class="cpp comments">private:</code></div><div class="line number88 index87 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">zygisk::Api&nbsp;*api;</code></div><div class="line number89 index88 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">JNIEnv&nbsp;*env;</code></div><div class="line number90 index89 alt1"><code class="cpp comments">};</code></div><div class="line number91 index90 alt2">&nbsp;</div><div class="line number92 index91 alt1"><code class="cpp comments">REGISTER_ZYGISK_MODULE(ExampleModule)</code></div><div class="line number93 index92 alt2">&nbsp;</div><div class="line number94 index93 alt1"><code class="cpp comments">-----------------------------------------------------------------------------------------</code></div><div class="line number95 index94 alt2">&nbsp;</div><div class="line number96 index95 alt1"><code class="cpp comments">or&nbsp;runs&nbsp;in&nbsp;the&nbsp;sandbox&nbsp;of&nbsp;the&nbsp;target&nbsp;process&nbsp;in&nbsp;post[XXX]Specialize,&nbsp;the&nbsp;code&nbsp;in&nbsp;your&nbsp;class</code></div><div class="line number97 index96 alt2"><code class="cpp comments">never&nbsp;runs&nbsp;in&nbsp;a&nbsp;true&nbsp;superuser&nbsp;environment.</code></div><div class="line number98 index97 alt1"><code class="cpp comments">由于你的模块类的代码在&nbsp;pre[XXX]Specialize&nbsp;中以&nbsp;Zygote&nbsp;的特权运行，</code></div><div class="line number99 index98 alt2"><code class="cpp comments">或者在&nbsp;post[XXX]Specialize&nbsp;中在目标进程的沙盒中运行，你的类中的代码从不在一个真正的超级用户环境中运行。</code></div><div class="line number100 index99 alt1">&nbsp;</div><div class="line number101 index100 alt2"><code class="cpp comments">If&nbsp;your&nbsp;module&nbsp;require&nbsp;access&nbsp;to&nbsp;superuser&nbsp;permissions,&nbsp;you&nbsp;can&nbsp;create&nbsp;and&nbsp;register</code></div><div class="line number102 index101 alt1"><code class="cpp comments">a&nbsp;root&nbsp;companion&nbsp;handler&nbsp;function.&nbsp;This&nbsp;function&nbsp;runs&nbsp;in&nbsp;a&nbsp;separate&nbsp;root&nbsp;companion</code></div><div class="line number103 index102 alt2"><code class="cpp comments">daemon&nbsp;process,&nbsp;and&nbsp;an&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;is&nbsp;provided&nbsp;to&nbsp;allow&nbsp;you&nbsp;to&nbsp;perform&nbsp;IPC&nbsp;between</code></div><div class="line number104 index103 alt1"><code class="cpp comments">your&nbsp;target&nbsp;process&nbsp;and&nbsp;the&nbsp;root&nbsp;companion&nbsp;process.</code></div><div class="line number105 index104 alt2"><code class="cpp comments">如果你的模块需要访问超级用户权限，你可以创建并注册一个根伴随处理函数(root&nbsp;companion&nbsp;handler&nbsp;function)。</code></div><div class="line number106 index105 alt1"><code class="cpp comments">这个函数在一个单独的根伴随守护进程中运行，并提供了一个&nbsp;Unix&nbsp;socket，允许你在目标进程和根伴随进程之间进行</code></div><div class="line number107 index106 alt2"><code class="cpp comments">IPC（进程间通信）。</code></div><div class="line number108 index107 alt1">&nbsp;</div><div class="line number109 index108 alt2"><code class="cpp comments">Example&nbsp;code:</code></div><div class="line number110 index109 alt1">&nbsp;</div><div class="line number111 index110 alt2"><code class="cpp comments">static&nbsp;void&nbsp;example_handler(int&nbsp;socket)&nbsp;{&nbsp;...&nbsp;}</code></div><div class="line number112 index111 alt1">&nbsp;</div><div class="line number113 index112 alt2"><code class="cpp comments">REGISTER_ZYGISK_COMPANION(example_handler)</code></div><div class="line number114 index113 alt1">&nbsp;</div><div class="line number115 index114 alt2"><code class="cpp comments">*/</code></div><div class="line number116 index115 alt1">&nbsp;</div><div class="line number117 index116 alt2"><code class="cpp keyword bold">namespace</code>&nbsp;<code class="cpp plain">zygisk&nbsp;{</code></div><div class="line number118 index117 alt1">&nbsp;</div><div class="line number119 index118 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">Api;</code></div><div class="line number120 index119 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">AppSpecializeArgs;</code></div><div class="line number121 index120 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">ServerSpecializeArgs;</code></div><div class="line number122 index121 alt1">&nbsp;</div><div class="line number123 index122 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">class</code>&nbsp;<code class="cpp plain">ModuleBase&nbsp;{</code></div><div class="line number124 index123 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">public</code><code class="cpp plain">:</code></div><div class="line number125 index124 alt2">&nbsp;</div><div class="line number126 index125 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;method&nbsp;is&nbsp;called&nbsp;as&nbsp;soon&nbsp;as&nbsp;the&nbsp;module&nbsp;is&nbsp;loaded&nbsp;into&nbsp;the&nbsp;target&nbsp;process.&nbsp;A&nbsp;Zygisk&nbsp;API&nbsp;handle&nbsp;will&nbsp;be&nbsp;passed&nbsp;as&nbsp;an&nbsp;argument.</code></div><div class="line number127 index126 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;一旦模块被加载到目标进程中，就会调用此方法。一个&nbsp;Zygisk&nbsp;API&nbsp;句柄会作为参数传递。</code></div><div class="line number128 index127 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">virtual</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">onLoad([[maybe_unused]]&nbsp;Api&nbsp;*api,&nbsp;[[maybe_unused]]&nbsp;JNIEnv&nbsp;*env)&nbsp;{}</code></div><div class="line number129 index128 alt2">&nbsp;</div><div class="line number130 index129 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;method&nbsp;is&nbsp;called&nbsp;before&nbsp;the&nbsp;app&nbsp;process&nbsp;is&nbsp;specialized.</code></div><div class="line number131 index130 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;At&nbsp;this&nbsp;point,&nbsp;the&nbsp;process&nbsp;just&nbsp;got&nbsp;forked&nbsp;from&nbsp;zygote,&nbsp;but&nbsp;no&nbsp;app&nbsp;specific&nbsp;specialization</code></div><div class="line number132 index131 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;is&nbsp;applied.&nbsp;This&nbsp;means&nbsp;that&nbsp;the&nbsp;process&nbsp;does&nbsp;not&nbsp;have&nbsp;any&nbsp;sandbox&nbsp;restrictions&nbsp;and</code></div><div class="line number133 index132 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;still&nbsp;runs&nbsp;with&nbsp;the&nbsp;same&nbsp;privilege&nbsp;of&nbsp;zygote.</code></div><div class="line number134 index133 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在应用进程专业化之前调用，此时进程刚从&nbsp;zygote&nbsp;分叉出来，但还未应用任何特定于应用的专业化设置。</code></div><div class="line number135 index134 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这意味着进程还没有任何沙箱限制，并且仍然以&nbsp;zygote&nbsp;相同的权限运行。</code></div><div class="line number136 index135 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">virtual</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">preAppSpecialize([[maybe_unused]]&nbsp;AppSpecializeArgs&nbsp;*args)&nbsp;{}</code></div><div class="line number137 index136 alt2">&nbsp;</div><div class="line number138 index137 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;method&nbsp;is&nbsp;called&nbsp;after&nbsp;the&nbsp;app&nbsp;process&nbsp;is&nbsp;specialized.</code></div><div class="line number139 index138 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;At&nbsp;this&nbsp;point,&nbsp;the&nbsp;process&nbsp;has&nbsp;all&nbsp;sandbox&nbsp;restrictions&nbsp;enabled&nbsp;for&nbsp;this&nbsp;application.</code></div><div class="line number140 index139 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;means&nbsp;that&nbsp;this&nbsp;method&nbsp;runs&nbsp;with&nbsp;the&nbsp;same&nbsp;privilege&nbsp;of&nbsp;the&nbsp;app's&nbsp;own&nbsp;code.</code></div><div class="line number141 index140 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在应用进程专业化之后调用，此时进程已经为该应用启用了所有沙盒限制。</code></div><div class="line number142 index141 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这意味着这个方法与应用自己的代码以相同的权限运行。</code></div><div class="line number143 index142 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">virtual</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">postAppSpecialize([[maybe_unused]]&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">AppSpecializeArgs&nbsp;*args)&nbsp;{}</code></div><div class="line number144 index143 alt1">&nbsp;</div><div class="line number145 index144 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;method&nbsp;is&nbsp;called&nbsp;before&nbsp;the&nbsp;system&nbsp;server&nbsp;process&nbsp;is&nbsp;specialized.</code></div><div class="line number146 index145 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在系统服务器进程专业化之前调用此方法。</code></div><div class="line number147 index146 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;See&nbsp;preAppSpecialize(args)&nbsp;for&nbsp;more&nbsp;info.</code></div><div class="line number148 index147 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;有关更多信息，请参考&nbsp;preAppSpecialize(args)。</code></div><div class="line number149 index148 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">virtual</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">preServerSpecialize([[maybe_unused]]&nbsp;ServerSpecializeArgs&nbsp;*args)&nbsp;{}</code></div><div class="line number150 index149 alt1">&nbsp;</div><div class="line number151 index150 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;method&nbsp;is&nbsp;called&nbsp;after&nbsp;the&nbsp;system&nbsp;server&nbsp;process&nbsp;is&nbsp;specialized.</code></div><div class="line number152 index151 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;At&nbsp;this&nbsp;point,&nbsp;the&nbsp;process&nbsp;runs&nbsp;with&nbsp;the&nbsp;privilege&nbsp;of&nbsp;system_server.</code></div><div class="line number153 index152 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在系统服务器进程专业化之后调用。</code></div><div class="line number154 index153 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;此时，进程以&nbsp;system_server&nbsp;的权限运行。</code></div><div class="line number155 index154 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">virtual</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">postServerSpecialize([[maybe_unused]]&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">ServerSpecializeArgs&nbsp;*args)&nbsp;{}</code></div><div class="line number156 index155 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">AppSpecializeArgs&nbsp;{</code></div><div class="line number159 index158 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Required&nbsp;arguments.</code></div><div class="line number160 index159 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;These&nbsp;arguments&nbsp;are&nbsp;guaranteed&nbsp;to&nbsp;exist&nbsp;on&nbsp;all&nbsp;Android&nbsp;versions.</code></div><div class="line number161 index160 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;uid;</code></div><div class="line number162 index161 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;gid;</code></div><div class="line number163 index162 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jintArray&nbsp;&amp;gids;</code></div><div class="line number164 index163 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;runtime_flags;</code></div><div class="line number165 index164 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;&amp;rlimits;</code></div><div class="line number166 index165 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;mount_external;</code></div><div class="line number167 index166 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;&amp;se_info;</code></div><div class="line number168 index167 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;&amp;nice_name;</code></div><div class="line number169 index168 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;&amp;instruction_set;</code></div><div class="line number170 index169 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;&amp;app_data_dir;</code></div><div class="line number171 index170 alt2">&nbsp;</div><div class="line number172 index171 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Optional&nbsp;arguments.&nbsp;Please&nbsp;check&nbsp;whether&nbsp;the&nbsp;pointer&nbsp;is&nbsp;null&nbsp;before&nbsp;de-referencing</code></div><div class="line number173 index172 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jintArray&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">fds_to_ignore;</code></div><div class="line number174 index173 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jboolean&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">is_child_zygote;</code></div><div class="line number175 index174 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jboolean&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">is_top_app;</code></div><div class="line number176 index175 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">pkg_data_info_list;</code></div><div class="line number177 index176 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">whitelisted_data_info_list;</code></div><div class="line number178 index177 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jboolean&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">mount_data_dirs;</code></div><div class="line number179 index178 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jboolean&nbsp;*</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">mount_storage_dirs;</code></div><div class="line number180 index179 alt1">&nbsp;</div><div class="line number181 index180 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">AppSpecializeArgs()&nbsp;=&nbsp;</code><code class="cpp keyword bold">delete</code><code class="cpp plain">;</code></div><div class="line number182 index181 alt1">&nbsp;</div><div class="line number183 index182 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::string&nbsp;toString(JNIEnv&nbsp;*env)&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number184 index183 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::ostringstream&nbsp;stream;</code></div><div class="line number185 index184 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJString(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"nice_name"</code><code class="cpp plain">,&nbsp;nice_name);</code></div><div class="line number186 index185 alt1">&nbsp;</div><div class="line number187 index186 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJString(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"app_data_dir"</code><code class="cpp plain">,&nbsp;app_data_dir);</code></div><div class="line number188 index187 alt1">&nbsp;</div><div class="line number189 index188 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJString(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"se_info"</code><code class="cpp plain">,&nbsp;se_info);</code></div><div class="line number190 index189 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJString(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"instruction_set"</code><code class="cpp plain">,&nbsp;instruction_set);</code></div><div class="line number191 index190 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"uid:&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;uid&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;gid:&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;gid&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;runtime_flags:&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;runtime_flags</code></div><div class="line number192 index191 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;mount_external:&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;mount_external;</code></div><div class="line number193 index192 alt2">&nbsp;</div><div class="line number194 index193 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJIntArray(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"gids"</code><code class="cpp plain">,&nbsp;gids);</code></div><div class="line number195 index194 alt2">&nbsp;</div><div class="line number196 index195 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJBoolean(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"is_child_zygote"</code><code class="cpp plain">,&nbsp;is_child_zygote);</code></div><div class="line number197 index196 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJBoolean(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"is_top_app"</code><code class="cpp plain">,&nbsp;is_top_app);</code></div><div class="line number198 index197 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJBoolean(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"mount_data_dirs"</code><code class="cpp plain">,&nbsp;mount_data_dirs);</code></div><div class="line number199 index198 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJBoolean(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"mount_storage_dirs"</code><code class="cpp plain">,&nbsp;mount_storage_dirs);</code></div><div class="line number200 index199 alt1">&nbsp;</div><div class="line number201 index200 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJObjectArrayPointer(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"pkg_data_info_list"</code><code class="cpp plain">,&nbsp;pkg_data_info_list);</code></div><div class="line number202 index201 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJObjectArrayPointer(env,&nbsp;stream,&nbsp;</code><code class="cpp string">"whitelisted_data_info_list"</code><code class="cpp plain">,</code></div><div class="line number203 index202 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">whitelisted_data_info_list);</code></div><div class="line number204 index203 alt1">&nbsp;</div><div class="line number205 index204 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">stream.str();</code></div><div class="line number206 index205 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number207 index206 alt2">&nbsp;</div><div class="line number208 index207 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">private</code><code class="cpp plain">:</code></div><div class="line number209 index208 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">[[maybe_unused]]</code></div><div class="line number210 index209 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">printJString(JNIEnv&nbsp;*env,&nbsp;std::ostringstream&nbsp;&amp;stream,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::string&nbsp;&amp;name,</code></div><div class="line number211 index210 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;value)&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number212 index211 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(value&nbsp;!=&nbsp;nullptr)&nbsp;{</code></div><div class="line number213 index212 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*chars&nbsp;=&nbsp;env-&gt;GetStringUTFChars(value,&nbsp;nullptr);</code></div><div class="line number214 index213 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;chars&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number215 index214 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">env-&gt;ReleaseStringUTFChars(value,&nbsp;chars);</code></div><div class="line number216 index215 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number217 index216 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;null"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number218 index217 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number219 index218 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number220 index219 alt1">&nbsp;</div><div class="line number221 index220 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">[[maybe_unused]]</code></div><div class="line number222 index221 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">printJIntArray(JNIEnv&nbsp;*env,&nbsp;std::ostringstream&nbsp;&amp;stream,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::string&nbsp;&amp;name,</code></div><div class="line number223 index222 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jintArray&nbsp;value)&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number224 index223 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(value&nbsp;!=&nbsp;nullptr)&nbsp;{</code></div><div class="line number225 index224 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jsize&nbsp;length&nbsp;=&nbsp;env-&gt;GetArrayLength(value);</code></div><div class="line number226 index225 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;*elements&nbsp;=&nbsp;env-&gt;GetIntArrayElements(value,&nbsp;nullptr);</code></div><div class="line number227 index226 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;["</code><code class="cpp plain">;</code></div><div class="line number228 index227 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(jsize&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;length;&nbsp;++i)&nbsp;{</code></div><div class="line number229 index228 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;elements[i];</code></div><div class="line number230 index229 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(i&nbsp;&lt;&nbsp;length&nbsp;-&nbsp;1)&nbsp;{</code></div><div class="line number231 index230 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">",&nbsp;"</code><code class="cpp plain">;</code></div><div class="line number232 index231 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number233 index232 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number234 index233 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"]"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number235 index234 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">env-&gt;ReleaseIntArrayElements(value,&nbsp;elements,&nbsp;JNI_ABORT);</code></div><div class="line number236 index235 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number237 index236 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;null"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number238 index237 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number239 index238 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number240 index239 alt1">&nbsp;</div><div class="line number241 index240 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">[[maybe_unused]]</code></div><div class="line number242 index241 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">printJBoolean(JNIEnv&nbsp;*env,&nbsp;std::ostringstream&nbsp;&amp;stream,</code></div><div class="line number243 index242 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::string&nbsp;&amp;name,&nbsp;jboolean&nbsp;*value)&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number244 index243 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(value&nbsp;!=&nbsp;nullptr)&nbsp;{</code></div><div class="line number245 index244 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;((*value)&nbsp;==&nbsp;JNI_TRUE&nbsp;?&nbsp;</code><code class="cpp string">"true"</code>&nbsp;<code class="cpp plain">:&nbsp;</code><code class="cpp string">"flase"</code><code class="cpp plain">)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number246 index245 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number247 index246 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;null"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number248 index247 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number249 index248 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number250 index249 alt1">&nbsp;</div><div class="line number251 index250 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">[[maybe_unused]]</code></div><div class="line number252 index251 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code></div><div class="line number253 index252 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">printJObjectArrayPointer(JNIEnv&nbsp;*env,&nbsp;std::ostringstream&nbsp;&amp;stream,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::string&nbsp;&amp;name,</code></div><div class="line number254 index253 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;*arrayPtr)&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number255 index254 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(arrayPtr&nbsp;&amp;&amp;&nbsp;*arrayPtr)&nbsp;{</code></div><div class="line number256 index255 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;array&nbsp;=&nbsp;*arrayPtr;</code></div><div class="line number257 index256 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jsize&nbsp;length&nbsp;=&nbsp;env-&gt;GetArrayLength(array);</code></div><div class="line number258 index257 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;["</code><code class="cpp plain">;</code></div><div class="line number259 index258 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(jsize&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;length;&nbsp;++i)&nbsp;{</code></div><div class="line number260 index259 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jstring&nbsp;str&nbsp;=&nbsp;(jstring)&nbsp;env-&gt;GetObjectArrayElement(array,&nbsp;i);</code></div><div class="line number261 index260 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*chars&nbsp;=&nbsp;env-&gt;GetStringUTFChars(str,&nbsp;nullptr);</code></div><div class="line number262 index261 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;chars;</code></div><div class="line number263 index262 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">env-&gt;ReleaseStringUTFChars(str,&nbsp;chars);</code></div><div class="line number264 index263 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(i&nbsp;&lt;&nbsp;length&nbsp;-&nbsp;1)&nbsp;{</code></div><div class="line number265 index264 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">",&nbsp;"</code><code class="cpp plain">;</code></div><div class="line number266 index265 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number267 index266 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number268 index267 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"]"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number269 index268 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number270 index269 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stream&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;name&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">":&nbsp;null"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;</code><code class="cpp string">"\n"</code><code class="cpp plain">;</code></div><div class="line number271 index270 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number272 index271 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number273 index272 alt2">&nbsp;</div><div class="line number274 index273 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number275 index274 alt2">&nbsp;</div><div class="line number276 index275 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">ServerSpecializeArgs&nbsp;{</code></div><div class="line number277 index276 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;uid;</code></div><div class="line number278 index277 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;gid;</code></div><div class="line number279 index278 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jintArray&nbsp;&amp;gids;</code></div><div class="line number280 index279 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jint&nbsp;&amp;runtime_flags;</code></div><div class="line number281 index280 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jlong&nbsp;&amp;permitted_capabilities;</code></div><div class="line number282 index281 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jlong&nbsp;&amp;effective_capabilities;</code></div><div class="line number283 index282 alt2">&nbsp;</div><div class="line number284 index283 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ServerSpecializeArgs()&nbsp;=&nbsp;</code><code class="cpp keyword bold">delete</code><code class="cpp plain">;</code></div><div class="line number285 index284 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number286 index285 alt1">&nbsp;</div><div class="line number287 index286 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">namespace</code>&nbsp;<code class="cpp plain">internal&nbsp;{</code></div><div class="line number288 index287 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">api_table;</code></div><div class="line number289 index288 alt2">&nbsp;</div><div class="line number290 index289 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">template</code><code class="cpp plain">&lt;</code><code class="cpp keyword bold">class</code>&nbsp;<code class="cpp plain">T&gt;</code></div><div class="line number291 index290 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">entry_impl(api_table&nbsp;*,&nbsp;JNIEnv&nbsp;*);</code></div><div class="line number292 index291 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number293 index292 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;These&nbsp;values&nbsp;are&nbsp;used&nbsp;in&nbsp;Api::setOption(Option)</code></div><div class="line number294 index293 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这些值被用在&nbsp;Api::setOption(Option)&nbsp;方法中</code></div><div class="line number295 index294 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">enum</code>&nbsp;<code class="cpp plain">Option&nbsp;:&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number296 index295 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Force&nbsp;Magisk's&nbsp;denylist&nbsp;unmount&nbsp;routines&nbsp;to&nbsp;run&nbsp;on&nbsp;this&nbsp;process.</code></div><div class="line number297 index296 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;强制在此进程上运行&nbsp;Magisk&nbsp;的拒绝列表unmount&nbsp;routines。</code></div><div class="line number298 index297 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number299 index298 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Setting&nbsp;this&nbsp;option&nbsp;only&nbsp;makes&nbsp;sense&nbsp;in&nbsp;preAppSpecialize.</code></div><div class="line number300 index299 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;只有在&nbsp;preAppSpecialize&nbsp;中设置此选项才有意义。</code></div><div class="line number301 index300 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;actual&nbsp;unmounting&nbsp;happens&nbsp;during&nbsp;app&nbsp;process&nbsp;specialization.</code></div><div class="line number302 index301 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;实际的卸载过程发生在应用进程specialization期间。</code></div><div class="line number303 index302 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number304 index303 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Set&nbsp;this&nbsp;option&nbsp;to&nbsp;force&nbsp;all&nbsp;Magisk&nbsp;and&nbsp;modules'&nbsp;files&nbsp;to&nbsp;be&nbsp;unmounted&nbsp;from&nbsp;the</code></div><div class="line number305 index304 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;mount&nbsp;namespace&nbsp;of&nbsp;the&nbsp;process,&nbsp;regardless&nbsp;of&nbsp;the&nbsp;denylist&nbsp;enforcement&nbsp;status.</code></div><div class="line number306 index305 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;设置此选项以强制从进程的挂载命名空间中卸载所有&nbsp;Magisk&nbsp;和模块的文件，无论拒绝列表的执行状态如何。</code></div><div class="line number307 index306 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这个主要是卸载magisk整个系统文件</code></div><div class="line number308 index307 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FORCE_DENYLIST_UNMOUNT&nbsp;=&nbsp;0,</code></div><div class="line number309 index308 alt2">&nbsp;</div><div class="line number310 index309 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;When&nbsp;this&nbsp;option&nbsp;is&nbsp;set,&nbsp;your&nbsp;module's&nbsp;library&nbsp;will&nbsp;be&nbsp;dlclose-ed&nbsp;after&nbsp;post[XXX]Specialize.</code></div><div class="line number311 index310 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;设置此选项时，你的模块库将在&nbsp;post[XXX]Specialize&nbsp;之后被&nbsp;dlclose。</code></div><div class="line number312 index311 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Be&nbsp;aware&nbsp;that&nbsp;after&nbsp;dlclose-ing&nbsp;your&nbsp;module,&nbsp;all&nbsp;of&nbsp;your&nbsp;code&nbsp;will&nbsp;be&nbsp;unmapped&nbsp;from&nbsp;memory.</code></div><div class="line number313 index312 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;注意，dlclose&nbsp;你的模块后，你所有的代码都将从内存中取消映射。</code></div><div class="line number314 index313 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;YOU&nbsp;MUST&nbsp;NOT&nbsp;ENABLE&nbsp;THIS&nbsp;OPTION&nbsp;AFTER&nbsp;HOOKING&nbsp;ANY&nbsp;FUNCTIONS&nbsp;IN&nbsp;THE&nbsp;PROCESS.</code></div><div class="line number315 index314 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在进程中挂钩任何函数后，你必须不启用此选项。</code></div><div class="line number316 index315 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这个是卸载so文件</code></div><div class="line number317 index316 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DLCLOSE_MODULE_LIBRARY&nbsp;=&nbsp;1,</code></div><div class="line number318 index317 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number319 index318 alt2">&nbsp;</div><div class="line number320 index319 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Bit&nbsp;masks&nbsp;of&nbsp;the&nbsp;return&nbsp;value&nbsp;of&nbsp;Api::getFlags()</code></div><div class="line number321 index320 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Api::getFlags()&nbsp;返回值的位掩码</code></div><div class="line number322 index321 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">enum</code>&nbsp;<code class="cpp plain">StateFlag&nbsp;:&nbsp;uint32_t&nbsp;{</code></div><div class="line number323 index322 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;user&nbsp;has&nbsp;granted&nbsp;root&nbsp;access&nbsp;to&nbsp;the&nbsp;current&nbsp;process</code></div><div class="line number324 index323 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;用户已授予当前进程根访问权限</code></div><div class="line number325 index324 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">PROCESS_GRANTED_ROOT&nbsp;=&nbsp;(1u&nbsp;&lt;&lt;&nbsp;0),</code></div><div class="line number326 index325 alt1">&nbsp;</div><div class="line number327 index326 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;current&nbsp;process&nbsp;was&nbsp;added&nbsp;on&nbsp;the&nbsp;denylist</code></div><div class="line number328 index327 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;当前进程被添加到拒绝列表中</code></div><div class="line number329 index328 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">PROCESS_ON_DENYLIST&nbsp;=&nbsp;(1u&nbsp;&lt;&lt;&nbsp;1),</code></div><div class="line number330 index329 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number331 index330 alt2">&nbsp;</div><div class="line number332 index331 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;All&nbsp;API&nbsp;methods&nbsp;will&nbsp;stop&nbsp;working&nbsp;after&nbsp;post[XXX]Specialize&nbsp;as&nbsp;Zygisk&nbsp;will&nbsp;be&nbsp;unloaded</code></div><div class="line number333 index332 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;from&nbsp;the&nbsp;specialized&nbsp;process&nbsp;afterwards.</code></div><div class="line number334 index333 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;所有API方法post[XXX]Specialize后停止工作，因为Zygisk将在之后从专业化过程中卸载。</code></div><div class="line number335 index334 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">Api&nbsp;{</code></div><div class="line number336 index335 alt1">&nbsp;</div><div class="line number337 index336 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Connect&nbsp;to&nbsp;a&nbsp;root&nbsp;companion&nbsp;process&nbsp;and&nbsp;get&nbsp;a&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;for&nbsp;IPC.</code></div><div class="line number338 index337 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;获取和root守护进程通讯的句柄,可以直接通过这个句柄进行ipc通讯&nbsp;。</code></div><div class="line number339 index338 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;连接到root&nbsp;companion进程并获取&nbsp;Unix&nbsp;socket进行&nbsp;IPC。</code></div><div class="line number340 index339 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number341 index340 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;API&nbsp;only&nbsp;works&nbsp;in&nbsp;the&nbsp;pre[XXX]Specialize&nbsp;methods&nbsp;due&nbsp;to&nbsp;SELinux&nbsp;restrictions.</code></div><div class="line number342 index341 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;由于&nbsp;SELinux&nbsp;限制，此&nbsp;API&nbsp;仅在&nbsp;pre[XXX]Specialize&nbsp;方法中有效。</code></div><div class="line number343 index342 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number344 index343 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;pre[XXX]Specialize&nbsp;methods&nbsp;run&nbsp;with&nbsp;the&nbsp;same&nbsp;privilege&nbsp;of&nbsp;zygote.</code></div><div class="line number345 index344 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;pre[XXX]Specialize&nbsp;方法以与&nbsp;zygote&nbsp;相同的权限运行。</code></div><div class="line number346 index345 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;If&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;do&nbsp;some&nbsp;operations&nbsp;with&nbsp;superuser&nbsp;permissions,&nbsp;register&nbsp;a&nbsp;handler</code></div><div class="line number347 index346 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;function&nbsp;that&nbsp;would&nbsp;be&nbsp;called&nbsp;in&nbsp;the&nbsp;root&nbsp;process&nbsp;with&nbsp;REGISTER_ZYGISK_COMPANION(func).</code></div><div class="line number348 index347 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果你想以超级用户权限执行一些操作，请注册一个处理函数，</code></div><div class="line number349 index348 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在根进程中以&nbsp;REGISTER_ZYGISK_COMPANION(func)&nbsp;调用。</code></div><div class="line number350 index349 alt1">&nbsp;</div><div class="line number351 index350 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Another&nbsp;good&nbsp;use&nbsp;case&nbsp;for&nbsp;a&nbsp;companion&nbsp;process&nbsp;is&nbsp;that&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;share&nbsp;some&nbsp;resources</code></div><div class="line number352 index351 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;across&nbsp;multiple&nbsp;processes,&nbsp;hold&nbsp;the&nbsp;resources&nbsp;in&nbsp;the&nbsp;companion&nbsp;process&nbsp;and&nbsp;pass&nbsp;it&nbsp;over.</code></div><div class="line number353 index352 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;companion进程的另一个好用途是，如果你想在多个进程间共享一些资源，</code></div><div class="line number354 index353 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;可以在companion进程中保持这些资源并传递过去。</code></div><div class="line number355 index354 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number356 index355 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;root&nbsp;companion&nbsp;process&nbsp;is&nbsp;ABI&nbsp;aware;&nbsp;that&nbsp;is,&nbsp;when&nbsp;calling&nbsp;this&nbsp;method&nbsp;from&nbsp;a&nbsp;32-bit</code></div><div class="line number357 index356 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;process,&nbsp;you&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;a&nbsp;32-bit&nbsp;companion&nbsp;process,&nbsp;and&nbsp;vice&nbsp;versa&nbsp;for&nbsp;64-bit.</code></div><div class="line number358 index357 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;root伴随进程是&nbsp;ABI&nbsp;意识到的；</code></div><div class="line number359 index358 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;也就是说，当从&nbsp;32&nbsp;位进程调用此方法时，你将连接到一个&nbsp;32&nbsp;位的伴随进程，对于&nbsp;64&nbsp;位也是如此。</code></div><div class="line number360 index359 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number361 index360 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Returns&nbsp;a&nbsp;file&nbsp;descriptor&nbsp;to&nbsp;a&nbsp;socket&nbsp;that&nbsp;is&nbsp;connected&nbsp;to&nbsp;the&nbsp;socket&nbsp;passed&nbsp;to&nbsp;your</code></div><div class="line number362 index361 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;module's&nbsp;companion&nbsp;request&nbsp;handler.&nbsp;Returns&nbsp;-1&nbsp;if&nbsp;the&nbsp;connection&nbsp;attempt&nbsp;failed.</code></div><div class="line number363 index362 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;返回一个文件描述符到一个套接字，该套接字连接到传递给模块的伴随请求处理器的套接字。</code></div><div class="line number364 index363 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果连接尝试失败，则返回&nbsp;-1。</code></div><div class="line number365 index364 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">connectCompanion();</code></div><div class="line number366 index365 alt1">&nbsp;</div><div class="line number367 index366 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Get&nbsp;the&nbsp;file&nbsp;descriptor&nbsp;of&nbsp;the&nbsp;root&nbsp;folder&nbsp;of&nbsp;the&nbsp;current&nbsp;module.</code></div><div class="line number368 index367 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;获取当前模块的根文件夹的文件描述符。</code></div><div class="line number369 index368 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number370 index369 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;API&nbsp;only&nbsp;works&nbsp;in&nbsp;the&nbsp;pre[XXX]Specialize&nbsp;methods.</code></div><div class="line number371 index370 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;此&nbsp;API&nbsp;仅在&nbsp;pre[XXX]Specialize&nbsp;方法中工作。</code></div><div class="line number372 index371 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Accessing&nbsp;the&nbsp;directory&nbsp;returned&nbsp;is&nbsp;only&nbsp;possible&nbsp;in&nbsp;the&nbsp;pre[XXX]Specialize&nbsp;methods</code></div><div class="line number373 index372 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;or&nbsp;in&nbsp;the&nbsp;root&nbsp;companion&nbsp;process&nbsp;(assuming&nbsp;that&nbsp;you&nbsp;sent&nbsp;the&nbsp;fd&nbsp;over&nbsp;the&nbsp;socket).</code></div><div class="line number374 index373 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;只有在&nbsp;pre[XXX]Specialize&nbsp;方法或根伴随进程中（假设你通过套接字发送了&nbsp;fd）才能访问返回的目录。</code></div><div class="line number375 index374 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Both&nbsp;restrictions&nbsp;are&nbsp;due&nbsp;to&nbsp;SELinux&nbsp;and&nbsp;UID.</code></div><div class="line number376 index375 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这两个限制都是由于&nbsp;SELinux&nbsp;和&nbsp;UID。</code></div><div class="line number377 index376 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number378 index377 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Returns&nbsp;-1&nbsp;if&nbsp;errors&nbsp;occurred.</code></div><div class="line number379 index378 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果发生错误，则返回&nbsp;-1。</code></div><div class="line number380 index379 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">getModuleDir();</code></div><div class="line number381 index380 alt2">&nbsp;</div><div class="line number382 index381 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Set&nbsp;various&nbsp;options&nbsp;for&nbsp;your&nbsp;module.</code></div><div class="line number383 index382 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;为你的模块设置各种选项。</code></div><div class="line number384 index383 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Please&nbsp;note&nbsp;that&nbsp;this&nbsp;method&nbsp;accepts&nbsp;one&nbsp;single&nbsp;option&nbsp;at&nbsp;a&nbsp;time.</code></div><div class="line number385 index384 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;请注意，此方法一次只接受一个选项。</code></div><div class="line number386 index385 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Check&nbsp;zygisk::Option&nbsp;for&nbsp;the&nbsp;full&nbsp;list&nbsp;of&nbsp;options&nbsp;available.</code></div><div class="line number387 index386 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;查看&nbsp;zygisk::Option&nbsp;以获取可用选项的完整列表。</code></div><div class="line number388 index387 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">setOption(Option&nbsp;opt);</code></div><div class="line number389 index388 alt2">&nbsp;</div><div class="line number390 index389 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Get&nbsp;information&nbsp;about&nbsp;the&nbsp;current&nbsp;process.</code></div><div class="line number391 index390 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;获取有关当前进程的信息。</code></div><div class="line number392 index391 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Returns&nbsp;bitwise-or'd&nbsp;zygisk::StateFlag&nbsp;values.</code></div><div class="line number393 index392 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;返回按位或的&nbsp;zygisk::StateFlag&nbsp;值。</code></div><div class="line number394 index393 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">uint32_t&nbsp;getFlags();</code></div><div class="line number395 index394 alt2">&nbsp;</div><div class="line number396 index395 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Exempt&nbsp;the&nbsp;provided&nbsp;file&nbsp;descriptor&nbsp;from&nbsp;being&nbsp;automatically&nbsp;closed.</code></div><div class="line number397 index396 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;免除提供的文件描述符被自动关闭。</code></div><div class="line number398 index397 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number399 index398 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;This&nbsp;API&nbsp;only&nbsp;make&nbsp;sense&nbsp;in&nbsp;preAppSpecialize;&nbsp;calling&nbsp;this&nbsp;method&nbsp;in&nbsp;any&nbsp;other&nbsp;situation</code></div><div class="line number400 index399 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;is&nbsp;either&nbsp;a&nbsp;no-op&nbsp;(returns&nbsp;true)&nbsp;or&nbsp;an&nbsp;error&nbsp;(returns&nbsp;false).</code></div><div class="line number401 index400 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;此&nbsp;API&nbsp;仅在&nbsp;preAppSpecialize&nbsp;中有意义；</code></div><div class="line number402 index401 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;在任何其他情况下调用此方法要么是无操作（返回&nbsp;true），要么是错误（返回&nbsp;false）。</code></div><div class="line number403 index402 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number404 index403 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;When&nbsp;false&nbsp;is&nbsp;returned,&nbsp;the&nbsp;provided&nbsp;file&nbsp;descriptor&nbsp;will&nbsp;eventually&nbsp;be&nbsp;closed&nbsp;by&nbsp;zygote.</code></div><div class="line number405 index404 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;当返回&nbsp;false&nbsp;时，提供的文件描述符最终将被&nbsp;zygote&nbsp;关闭。</code></div><div class="line number406 index405 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">exemptFd(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">fd);</code></div><div class="line number407 index406 alt2">&nbsp;</div><div class="line number408 index407 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Hook&nbsp;JNI&nbsp;native&nbsp;methods&nbsp;for&nbsp;a&nbsp;class</code></div><div class="line number409 index408 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;为一个类挂钩&nbsp;JNI&nbsp;原生方法</code></div><div class="line number410 index409 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number411 index410 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Lookup&nbsp;all&nbsp;registered&nbsp;JNI&nbsp;native&nbsp;methods&nbsp;and&nbsp;replace&nbsp;it&nbsp;with&nbsp;your&nbsp;own&nbsp;methods.</code></div><div class="line number412 index411 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;查找所有注册的&nbsp;JNI&nbsp;原生方法并用你自己的方法替换它。</code></div><div class="line number413 index412 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;original&nbsp;function&nbsp;pointer&nbsp;will&nbsp;be&nbsp;saved&nbsp;in&nbsp;each&nbsp;JNINativeMethod's&nbsp;fnPtr.</code></div><div class="line number414 index413 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;原始函数指针将被保存在每个&nbsp;JNINativeMethod&nbsp;的&nbsp;fnPtr&nbsp;中。</code></div><div class="line number415 index414 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;If&nbsp;no&nbsp;matching&nbsp;class,&nbsp;method&nbsp;name,&nbsp;or&nbsp;signature&nbsp;is&nbsp;found,&nbsp;that&nbsp;specific&nbsp;JNINativeMethod.fnPtr</code></div><div class="line number416 index415 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;nullptr.</code></div><div class="line number417 index416 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果没有找到匹配的类、方法名或签名，那么特定的&nbsp;JNINativeMethod.fnPtr&nbsp;将被设置为&nbsp;nullptr。</code></div><div class="line number418 index417 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">hookJniNativeMethods(JNIEnv&nbsp;*env,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*className,&nbsp;JNINativeMethod&nbsp;*methods,</code></div><div class="line number419 index418 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">numMethods);</code></div><div class="line number420 index419 alt1">&nbsp;</div><div class="line number421 index420 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Hook&nbsp;functions&nbsp;in&nbsp;the&nbsp;PLT&nbsp;(Procedure&nbsp;Linkage&nbsp;Table)&nbsp;of&nbsp;ELFs&nbsp;loaded&nbsp;in&nbsp;memory.</code></div><div class="line number422 index421 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;hook在内存中加载的&nbsp;ELF&nbsp;文件的&nbsp;PLT（程序链接表）中得函数。</code></div><div class="line number423 index422 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number424 index423 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Parsing&nbsp;/proc/[PID]/maps&nbsp;will&nbsp;give&nbsp;you&nbsp;the&nbsp;memory&nbsp;map&nbsp;of&nbsp;a&nbsp;process.&nbsp;As&nbsp;an&nbsp;example:</code></div><div class="line number425 index424 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;解析&nbsp;/proc/[PID]/maps&nbsp;将给你一个进程的内存映射。例如：</code></div><div class="line number426 index425 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number427 index426 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;address&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;perms&gt;&nbsp;&nbsp;&lt;offset&gt;&nbsp;&nbsp;&nbsp;&lt;dev&gt;&nbsp;&nbsp;&lt;inode&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pathname&gt;</code></div><div class="line number428 index427 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;地址&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;权限&nbsp;&nbsp;&nbsp;&nbsp;偏移量&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设备&nbsp;&nbsp;&nbsp;&nbsp;节点&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;路径名</code></div><div class="line number429 index428 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;56b4346000-56b4347000&nbsp;&nbsp;r-xp&nbsp;&nbsp;&nbsp;&nbsp;00002000&nbsp;&nbsp;&nbsp;fe:00&nbsp;&nbsp;&nbsp;&nbsp;235&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/system/bin/app_process64</code></div><div class="line number430 index429 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;(More&nbsp;details:&nbsp;https://man7.org/linux/man-pages/man5/proc.5.html)</code></div><div class="line number431 index430 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;（更多详情请访问：https://man7.org/linux/man-pages/man5/proc.5.html）</code></div><div class="line number432 index431 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number433 index432 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;The&nbsp;`dev`&nbsp;and&nbsp;`inode`&nbsp;pair&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;file&nbsp;being&nbsp;mapped&nbsp;into&nbsp;memory.</code></div><div class="line number434 index433 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;`dev`&nbsp;和&nbsp;`inode`&nbsp;对唯一标识了被映射到内存中的文件。</code></div><div class="line number435 index434 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;For&nbsp;matching&nbsp;ELFs&nbsp;loaded&nbsp;in&nbsp;memory,&nbsp;replace&nbsp;function&nbsp;`symbol`&nbsp;with&nbsp;`newFunc`.</code></div><div class="line number436 index435 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;对于匹配的在内存中加载的&nbsp;ELF&nbsp;文件，将函数&nbsp;`symbol`&nbsp;替换为&nbsp;`newFunc`。</code></div><div class="line number437 index436 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;If&nbsp;`oldFunc`&nbsp;is&nbsp;not&nbsp;nullptr,&nbsp;the&nbsp;original&nbsp;function&nbsp;pointer&nbsp;will&nbsp;be&nbsp;saved&nbsp;to&nbsp;`oldFunc`.</code></div><div class="line number438 index437 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果&nbsp;`oldFunc`&nbsp;不是&nbsp;nullptr，原始的函数指针将被保存到&nbsp;`oldFunc`。</code></div><div class="line number439 index438 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code></div><div class="line number440 index439 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pltHookRegister(dev_t&nbsp;dev,&nbsp;ino_t&nbsp;inode,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*symbol,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*newFunc,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">**oldFunc);</code></div><div class="line number441 index440 alt2">&nbsp;</div><div class="line number442 index441 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Commit&nbsp;all&nbsp;the&nbsp;hooks&nbsp;that&nbsp;was&nbsp;previously&nbsp;registered.</code></div><div class="line number443 index442 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;提交之前注册的所有钩子。</code></div><div class="line number444 index443 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Returns&nbsp;false&nbsp;if&nbsp;an&nbsp;error&nbsp;occurred.</code></div><div class="line number445 index444 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;如果发生错误，返回&nbsp;false。</code></div><div class="line number446 index445 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">pltHookCommit();</code></div><div class="line number447 index446 alt2">&nbsp;</div><div class="line number448 index447 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">private</code><code class="cpp plain">:</code></div><div class="line number449 index448 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">internal::api_table&nbsp;*tbl;</code></div><div class="line number450 index449 alt1">&nbsp;</div><div class="line number451 index450 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">template</code><code class="cpp plain">&lt;</code><code class="cpp keyword bold">class</code>&nbsp;<code class="cpp plain">T&gt;</code></div><div class="line number452 index451 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">friend</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">internal::entry_impl(internal::api_table&nbsp;*,&nbsp;JNIEnv&nbsp;*);</code></div><div class="line number453 index452 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number454 index453 alt1">&nbsp;</div><div class="line number455 index454 alt2"><code class="cpp comments">//&nbsp;Register&nbsp;a&nbsp;class&nbsp;as&nbsp;a&nbsp;Zygisk&nbsp;module</code></div><div class="line number456 index455 alt1">&nbsp;</div><div class="line number457 index456 alt2"><code class="cpp preprocessor">#define&nbsp;REGISTER_ZYGISK_MODULE(clazz)&nbsp;\</code></div><div class="line number458 index457 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">zygisk_module_entry(zygisk::internal::api_table&nbsp;*table,&nbsp;JNIEnv&nbsp;*env)&nbsp;{&nbsp;\</code></div><div class="line number459 index458 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">zygisk::internal::entry_impl&lt;clazz&gt;(table,&nbsp;env);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\</code></div><div class="line number460 index459 alt1"><code class="cpp plain">}</code></div><div class="line number461 index460 alt2">&nbsp;</div><div class="line number462 index461 alt1"><code class="cpp comments">//&nbsp;Register&nbsp;a&nbsp;root&nbsp;companion&nbsp;request&nbsp;handler&nbsp;function&nbsp;for&nbsp;your&nbsp;module</code></div><div class="line number463 index462 alt2"><code class="cpp comments">//&nbsp;为模块注册root伴随请求处理程序函数</code></div><div class="line number464 index463 alt1">&nbsp;</div><div class="line number465 index464 alt2"><code class="cpp comments">//&nbsp;The&nbsp;function&nbsp;runs&nbsp;in&nbsp;a&nbsp;superuser&nbsp;daemon&nbsp;process&nbsp;and&nbsp;handles&nbsp;a&nbsp;root&nbsp;companion&nbsp;request&nbsp;from</code></div><div class="line number466 index465 alt1"><code class="cpp comments">//&nbsp;your&nbsp;module&nbsp;running&nbsp;in&nbsp;a&nbsp;target&nbsp;process.</code></div><div class="line number467 index466 alt2"><code class="cpp comments">//&nbsp;该函数在超级用户守护进程中运行，并处理来自目标进程中运行的模块的根伴随请求。</code></div><div class="line number468 index467 alt1"><code class="cpp comments">//&nbsp;The&nbsp;function&nbsp;has&nbsp;to&nbsp;accept&nbsp;an&nbsp;integer&nbsp;value,</code></div><div class="line number469 index468 alt2"><code class="cpp comments">//&nbsp;which&nbsp;is&nbsp;a&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;that&nbsp;is&nbsp;connected&nbsp;to&nbsp;the&nbsp;target&nbsp;process.</code></div><div class="line number470 index469 alt1"><code class="cpp comments">//&nbsp;函数必须接受一个整数值，该整数值是连接到目标进程的Unix&nbsp;socket。</code></div><div class="line number471 index470 alt2">&nbsp;</div><div class="line number472 index471 alt1"><code class="cpp comments">//&nbsp;See&nbsp;Api::connectCompanion()&nbsp;for&nbsp;more&nbsp;info.</code></div><div class="line number473 index472 alt2"><code class="cpp comments">//</code></div><div class="line number474 index473 alt1"><code class="cpp comments">//&nbsp;NOTE:</code></div><div class="line number475 index474 alt2"><code class="cpp comments">//&nbsp;the&nbsp;function&nbsp;can&nbsp;run&nbsp;concurrently&nbsp;on&nbsp;multiple&nbsp;threads.</code></div><div class="line number476 index475 alt1"><code class="cpp comments">//&nbsp;Be&nbsp;aware&nbsp;of&nbsp;race&nbsp;conditions&nbsp;if&nbsp;you&nbsp;have&nbsp;globally&nbsp;shared&nbsp;resources.</code></div><div class="line number477 index476 alt2"><code class="cpp comments">//&nbsp;该函数可以在多个线程上同时运行。如果您拥有全球共享的资源，请注意种族状况。</code></div><div class="line number478 index477 alt1">&nbsp;</div><div class="line number479 index478 alt2"><code class="cpp preprocessor">#define&nbsp;REGISTER_ZYGISK_COMPANION(func)&nbsp;\</code></div><div class="line number480 index479 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">zygisk_companion_entry(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">client)&nbsp;{&nbsp;func(client);&nbsp;}</code></div><div class="line number481 index480 alt2">&nbsp;</div><div class="line number482 index481 alt1"><code class="cpp comments">/*********************************************************</code></div><div class="line number483 index482 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;The&nbsp;following&nbsp;is&nbsp;internal&nbsp;ABI&nbsp;implementation&nbsp;detail.</code></div><div class="line number484 index483 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;You&nbsp;do&nbsp;not&nbsp;have&nbsp;to&nbsp;understand&nbsp;what&nbsp;it&nbsp;is&nbsp;doing.</code></div><div class="line number485 index484 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*********************************************************/</code></div><div class="line number486 index485 alt1">&nbsp;</div><div class="line number487 index486 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">namespace</code>&nbsp;<code class="cpp plain">internal&nbsp;{</code></div><div class="line number488 index487 alt1">&nbsp;</div><div class="line number489 index488 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">module_abi&nbsp;{</code></div><div class="line number490 index489 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">api_version;</code></div><div class="line number491 index490 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ModuleBase&nbsp;*impl;</code></div><div class="line number492 index491 alt1">&nbsp;</div><div class="line number493 index492 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*preAppSpecialize)(ModuleBase&nbsp;*,&nbsp;AppSpecializeArgs&nbsp;*);</code></div><div class="line number494 index493 alt1">&nbsp;</div><div class="line number495 index494 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*postAppSpecialize)(ModuleBase&nbsp;*,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">AppSpecializeArgs&nbsp;*);</code></div><div class="line number496 index495 alt1">&nbsp;</div><div class="line number497 index496 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*preServerSpecialize)(ModuleBase&nbsp;*,&nbsp;ServerSpecializeArgs&nbsp;*);</code></div><div class="line number498 index497 alt1">&nbsp;</div><div class="line number499 index498 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*postServerSpecialize)(ModuleBase&nbsp;*,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">ServerSpecializeArgs&nbsp;*);</code></div><div class="line number500 index499 alt1">&nbsp;</div><div class="line number501 index500 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">module_abi(ModuleBase&nbsp;*</code></div><div class="line number502 index501 alt1">&nbsp;</div><div class="line number503 index502 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">module)&nbsp;:&nbsp;api_version(ZYGISK_API_VERSION),&nbsp;impl(module)&nbsp;{</code></div><div class="line number504 index503 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">preAppSpecialize&nbsp;=&nbsp;[](</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">m,&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">args)&nbsp;{&nbsp;m-&gt;preAppSpecialize(args);&nbsp;};</code></div><div class="line number505 index504 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">postAppSpecialize&nbsp;=&nbsp;[](</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">m,&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">args)&nbsp;{&nbsp;m-&gt;postAppSpecialize(args);&nbsp;};</code></div><div class="line number506 index505 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">preServerSpecialize&nbsp;=&nbsp;[](</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">m,&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">args)&nbsp;{&nbsp;m-&gt;preServerSpecialize(args);&nbsp;};</code></div><div class="line number507 index506 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">postServerSpecialize&nbsp;=&nbsp;[](</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">m,&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">args)&nbsp;{&nbsp;m-&gt;postServerSpecialize(args);&nbsp;};</code></div><div class="line number508 index507 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number509 index508 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number510 index509 alt1">&nbsp;</div><div class="line number511 index510 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">api_table&nbsp;{</code></div><div class="line number512 index511 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Base</code></div><div class="line number513 index512 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*impl;</code></div><div class="line number514 index513 alt1">&nbsp;</div><div class="line number515 index514 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">(*registerModule)(api_table&nbsp;*,&nbsp;module_abi&nbsp;*);</code></div><div class="line number516 index515 alt1">&nbsp;</div><div class="line number517 index516 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*hookJniNativeMethods)(JNIEnv&nbsp;*,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*,&nbsp;JNINativeMethod&nbsp;*,&nbsp;</code><code class="cpp color1 bold">int</code><code class="cpp plain">);</code></div><div class="line number518 index517 alt1">&nbsp;</div><div class="line number519 index518 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*pltHookRegister)(dev_t,&nbsp;ino_t,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">**);</code></div><div class="line number520 index519 alt1">&nbsp;</div><div class="line number521 index520 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">(*exemptFd)(</code><code class="cpp color1 bold">int</code><code class="cpp plain">);</code></div><div class="line number522 index521 alt1">&nbsp;</div><div class="line number523 index522 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">(*pltHookCommit)();</code></div><div class="line number524 index523 alt1">&nbsp;</div><div class="line number525 index524 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">(*connectCompanion)(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*&nbsp;</code><code class="cpp comments">/*&nbsp;impl&nbsp;*/</code><code class="cpp plain">);</code></div><div class="line number526 index525 alt1">&nbsp;</div><div class="line number527 index526 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*setOption)(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*&nbsp;</code><code class="cpp comments">/*&nbsp;impl&nbsp;*/</code><code class="cpp plain">,&nbsp;Option);</code></div><div class="line number528 index527 alt1">&nbsp;</div><div class="line number529 index528 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">(*getModuleDir)(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*&nbsp;</code><code class="cpp comments">/*&nbsp;impl&nbsp;*/</code><code class="cpp plain">);</code></div><div class="line number530 index529 alt1">&nbsp;</div><div class="line number531 index530 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">uint32_t&nbsp;(*getFlags)(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*&nbsp;</code><code class="cpp comments">/*&nbsp;impl&nbsp;*/</code><code class="cpp plain">);</code></div><div class="line number532 index531 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number533 index532 alt2">&nbsp;</div><div class="line number534 index533 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">template</code><code class="cpp plain">&lt;</code><code class="cpp keyword bold">class</code>&nbsp;<code class="cpp plain">T&gt;</code></div><div class="line number535 index534 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">entry_impl(api_table&nbsp;*table,&nbsp;JNIEnv&nbsp;*env)&nbsp;{</code></div><div class="line number536 index535 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp plain">Api&nbsp;api;</code></div><div class="line number537 index536 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">api.tbl&nbsp;=&nbsp;table;</code></div><div class="line number538 index537 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp plain">T&nbsp;module;</code></div><div class="line number539 index538 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ModuleBase&nbsp;*m&nbsp;=&nbsp;&amp;module;</code></div><div class="line number540 index539 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp plain">module_abi&nbsp;abi(m);</code></div><div class="line number541 index540 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!table-&gt;registerModule(table,&nbsp;&amp;abi))&nbsp;</code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number542 index541 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">m-&gt;onLoad(&amp;api,&nbsp;env);</code></div><div class="line number543 index542 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number544 index543 alt1">&nbsp;</div><div class="line number545 index544 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp comments">//&nbsp;namespace&nbsp;internal</code></div><div class="line number546 index545 alt1">&nbsp;</div><div class="line number547 index546 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">Api::connectCompanion()&nbsp;{</code></div><div class="line number548 index547 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">tbl-&gt;connectCompanion&nbsp;?&nbsp;tbl-&gt;connectCompanion(tbl-&gt;impl)&nbsp;:&nbsp;-1;</code></div><div class="line number549 index548 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number550 index549 alt1">&nbsp;</div><div class="line number551 index550 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">Api::getModuleDir()&nbsp;{</code></div><div class="line number552 index551 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">tbl-&gt;getModuleDir&nbsp;?&nbsp;tbl-&gt;getModuleDir(tbl-&gt;impl)&nbsp;:&nbsp;-1;</code></div><div class="line number553 index552 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number554 index553 alt1">&nbsp;</div><div class="line number555 index554 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">Api::setOption(Option&nbsp;opt)&nbsp;{</code></div><div class="line number556 index555 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(tbl-&gt;setOption)&nbsp;tbl-&gt;setOption(tbl-&gt;impl,&nbsp;opt);</code></div><div class="line number557 index556 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number558 index557 alt1">&nbsp;</div><div class="line number559 index558 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp plain">uint32_t&nbsp;Api::getFlags()&nbsp;{</code></div><div class="line number560 index559 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">tbl-&gt;getFlags&nbsp;?&nbsp;tbl-&gt;getFlags(tbl-&gt;impl)&nbsp;:&nbsp;0;</code></div><div class="line number561 index560 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number562 index561 alt1">&nbsp;</div><div class="line number563 index562 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">Api::exemptFd(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">fd)&nbsp;{</code></div><div class="line number564 index563 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">tbl-&gt;exemptFd&nbsp;!=&nbsp;nullptr&nbsp;&amp;&amp;&nbsp;tbl-&gt;exemptFd(fd);</code></div><div class="line number565 index564 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number566 index565 alt1">&nbsp;</div><div class="line number567 index566 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp keyword bold">void</code></div><div class="line number568 index567 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Api::hookJniNativeMethods(JNIEnv&nbsp;*env,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*className,&nbsp;JNINativeMethod&nbsp;*methods,</code></div><div class="line number569 index568 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">numMethods)&nbsp;{</code></div><div class="line number570 index569 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(tbl-&gt;hookJniNativeMethods)</code></div><div class="line number571 index570 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">tbl-&gt;hookJniNativeMethods(env,&nbsp;className,&nbsp;methods,&nbsp;numMethods);</code></div><div class="line number572 index571 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number573 index572 alt2">&nbsp;</div><div class="line number574 index573 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">Api::pltHookRegister(dev_t&nbsp;dev,&nbsp;ino_t&nbsp;inode,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*symbol,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*newFunc,</code></div><div class="line number575 index574 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">**oldFunc)&nbsp;{</code></div><div class="line number576 index575 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(tbl-&gt;pltHookRegister)&nbsp;tbl-&gt;pltHookRegister(dev,&nbsp;inode,&nbsp;symbol,&nbsp;newFunc,&nbsp;oldFunc);</code></div><div class="line number577 index576 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number578 index577 alt1">&nbsp;</div><div class="line number579 index578 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">inline</code>&nbsp;<code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">Api::pltHookCommit()&nbsp;{</code></div><div class="line number580 index579 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">tbl-&gt;pltHookCommit&nbsp;!=&nbsp;nullptr&nbsp;&amp;&amp;&nbsp;tbl-&gt;pltHookCommit();</code></div><div class="line number581 index580 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number582 index581 alt1">&nbsp;</div><div class="line number583 index582 alt2"><code class="cpp plain">}&nbsp;</code><code class="cpp comments">//&nbsp;namespace&nbsp;zygisk</code></div><div class="line number584 index583 alt1">&nbsp;</div><div class="line number585 index584 alt2"><code class="cpp keyword bold">extern</code>&nbsp;<code class="cpp string">"C"</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number586 index585 alt1">&nbsp;</div><div class="line number587 index586 alt2"><code class="cpp plain">[[gnu::visibility(</code><code class="cpp string">"default"</code><code class="cpp plain">),&nbsp;maybe_unused]]</code></div><div class="line number588 index587 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">zygisk_module_entry(zygisk::internal::api_table&nbsp;*,&nbsp;JNIEnv&nbsp;*);</code></div><div class="line number589 index588 alt2">&nbsp;</div><div class="line number590 index589 alt1"><code class="cpp plain">[[gnu::visibility(</code><code class="cpp string">"default"</code><code class="cpp plain">),&nbsp;maybe_unused]]</code></div><div class="line number591 index590 alt2"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">zygisk_companion_entry(</code><code class="cpp color1 bold">int</code><code class="cpp plain">);</code></div><div class="line number592 index591 alt1">&nbsp;</div><div class="line number593 index592 alt2"><code class="cpp plain">}&nbsp;</code><code class="cpp comments">//&nbsp;extern&nbsp;"C"</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>更多Api操作，包括系统文件替换，修改selinux权限等操作 ，这里不过多介绍 ，详细的话可以参考官网 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>传送门：</span><span><a href="https://bbs.kanxue.com/elink@1dbK9s2c8@1M7s2y4Q4x3@1q4Q4x3V1k6Q4x3V1k6@1L8%4m8B7L8$3S2F1N6%4g2Q4x3X3g2Y4K9i4c8Z5N6h3u0Q4x3X3g2A6L8#2)9J5c8V1#2S2k6$3W2K6K9#2)9J5c8X3N6#2K9h3c8W2M7#2)9J5k6h3S2@1L8h3H3%60.">https://topjohnwu.github.io/Magisk/guides.html</a></span></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_2"><span>Magisk模块如何实现一个Xposed ?</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>掌握了magisk模块基础以后可以尝试，可以尝试自己实现一个lsposed，lsposed开源版本正好也不支持android 15 ，实现了只要Lsplant支持到15</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>即可在android 15上去使用 。这里再次感谢lsplant的开发者 ~ </span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们需要先把编译的java代码在magisk模块里面执行 ，让他在系统服务（system_server）里面去执行java代码 。然后在执行后续的操作 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>下面是具体的实现流程：</span></p><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>1、Magisk模块加载java代码</span></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们可以先把我们自己编译的Java代码，丢到magisk模块的system/framework文件夹下 ，让系统服务在启动的时候加载我们的jar包 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>在系统服务回调里面直接用PathClassloader去加载jar包即可 ，然后反射调用里面的静态方法 。第一步实现从Magisk模块转到java调用 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>因为jar包放的是system/framework ，这个文件里面只有system_server有权限去读 ，其他的Apk是没有权限去读取的，所以不需要担心别的Apk读取到你自己的特征 。</span></p><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>2、系统服务初始化</span></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>通过上面的设置，已经可以实现了调用java方法 ，我们下来再java方法里面对系统服务进行替换和mock , 然后再系统服务里面挂载我们的服务 可以在添加服务的时候替换成你自己的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>如何hook添加函数呢？ </span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>可以动态代理即可 。当系统开始addService时候，添加服务是指定服务的时候 你可以把对应的服务替换成你得，你得服务里面包含【原始服务】和 【你自己的服务】</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这样在别人请求的时候你可以用你的服务去做一些事情 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp plain">Object&nbsp;origServiceManager&nbsp;=&nbsp;ServiceManager.getIServiceManager.callStatic();</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//在SystemServer还没有添加系统服务的时候进行动态代理</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ServiceManager.sServiceManager.setStaticValue(Reflection.on(</code><code class="cpp string">"android.os.IServiceManager"</code><code class="cpp plain">)</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.proxy((proxy,&nbsp;method,&nbsp;args)&nbsp;-&gt;&nbsp;{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(</code><code class="cpp string">"addService"</code><code class="cpp plain">.equals(method.getName()))&nbsp;{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">String&nbsp;serviceName&nbsp;=&nbsp;(String)&nbsp;args[0];</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">IBinder&nbsp;binder&nbsp;=&nbsp;(IBinder)&nbsp;args[1];</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//CLog.w("["&nbsp;+&nbsp;serviceName&nbsp;+&nbsp;"]&nbsp;-&gt;&nbsp;["&nbsp;+&nbsp;binder&nbsp;+&nbsp;"]");</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ServerConfig.TARGET_BINDER_SERVICE_NAME.equals(serviceName))&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Replace&nbsp;the&nbsp;clipboard&nbsp;service&nbsp;so&nbsp;apps&nbsp;can&nbsp;acquire&nbsp;binder</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">args[1]&nbsp;=&nbsp;</code><code class="cpp keyword bold">new</code>&nbsp;<code class="cpp plain">BinderServiceProxy((Binder)&nbsp;args[1],</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ServerConfig.TARGET_BINDER_SERVICE_DESCRIPTOR,&nbsp;rms);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">clipboardServiceReplaced&nbsp;=&nbsp;</code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(Context.ACTIVITY_SERVICE.equals(serviceName))&nbsp;{</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">RuntimeManagerService.initContext();</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(clipboardServiceReplaced)</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//set&nbsp;orig&nbsp;ServiceManager</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ServiceManager.sServiceManager.setStaticValue(origServiceManager);</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">try</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">method.invoke(origServiceManager,&nbsp;args);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">catch</code>&nbsp;<code class="cpp plain">(InvocationTargetException&nbsp;e)&nbsp;{</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">throw</code>&nbsp;<code class="cpp plain">e.getTargetException();</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}));</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接动态代理 ServiceManager ，这样在系统服务添加各种各样的Manager的时候，如果发现是指定的系统服务，替换成你自己的即可 。你得这个系统服务需要实现Binder ，添加完毕以后 我们在发服务端暴露一个接口 ，做共享内存 。</span></p><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>3、共享内存的实现</span></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>首先说一下这块为什么要用共享内存去实现 ，之前edxp这种他是在你需要hook进程里面去注入dex，这样的话dex已经被注入了 ，特征太多 。</span></p><blockquote><p style="line-height:1;"><span>检测也很好检测，直接用内存漫游去内存里面扣DexFile File 的个数，很容易检测到内存加载了多少个Dex</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们可以在服务端(system_service)搞个接口 ，等待客户端过来请求 ，然后用共享内存的方式把dex分配到指定客户端 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如我希望Hook Hunter, 我可以在Hunter启动里面 去请求服务端这个分配共享内存的接口 。服务端返回一个fd句柄 ，hunter直接用这个句柄mmap到内存里 ，然后用InMemoryDexClassLoader 去加载这个mmap到内存里的值 。得到classloader以后再去classloader里面findclass，去调用里面的方法即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们希望的是全局用一份dex即可，而不是每个进程都加载一份dex ，这样效率也不高 &nbsp;。下面这段代码就是当服务端收到客户端的请求，准备开始分配dex的代码 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(code&nbsp;==&nbsp;ServerConfig.DEX_TRANSACTION_CODE)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//CLog.i("RuntimeManagerService&nbsp;receive&nbsp;DEX_TRANSACTION_CODE&nbsp;"+.getCallAppName());</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">try</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//unzip&nbsp;jar</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">unzip(RuntimeManagerService.RUNTIME_JAR_PATH,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">RuntimeManagerService.RUNTIME_TEMP_DEX_PATH);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//get&nbsp;dex</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">File[]&nbsp;files&nbsp;=&nbsp;</code><code class="cpp keyword bold">new</code>&nbsp;<code class="cpp plain">File(RuntimeManagerService.RUNTIME_TEMP_DEX_PATH).listFiles();</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(files&nbsp;==&nbsp;null&nbsp;||&nbsp;files.length&nbsp;==&nbsp;0)&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CLog.i(</code><code class="cpp string">"DEX_TRANSACTION_CODE&nbsp;files&nbsp;size&nbsp;==&nbsp;0&nbsp;"</code><code class="cpp plain">);</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">@SuppressWarnings(</code><code class="cpp string">"all"</code><code class="cpp plain">)</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">List&lt;File&gt;&nbsp;dexFiles&nbsp;=&nbsp;Stream.of(files).</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">filter(file&nbsp;-&gt;&nbsp;file.getName().endsWith(</code><code class="cpp string">".dex"</code><code class="cpp plain">)).collect(Collectors.toList());</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(dexFiles.isEmpty())&nbsp;{</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CLog.i(</code><code class="cpp string">"DEX_TRANSACTION_CODE&nbsp;dexFiles.size()==0&nbsp;"</code><code class="cpp plain">);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(File&nbsp;file:dexFiles){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(!file.exists()){</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CLog.d(</code><code class="cpp string">"DEX_TRANSACTION_CODE&nbsp;dex&nbsp;file&nbsp;not&nbsp;find&nbsp;&nbsp;"</code><code class="cpp plain">+file);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//CLog.i("DEX_TRANSACTION_CODE&nbsp;dex&nbsp;info&nbsp;"&nbsp;+&nbsp;dexFiles);</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ArrayList&lt;SharedMemory&gt;&nbsp;shm&nbsp;=&nbsp;RuntimeManagerService.getPreloadDex(dexFiles);</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(shm&nbsp;==&nbsp;null&nbsp;||&nbsp;shm.isEmpty())&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">reply.writeNoException();</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//dex&nbsp;size</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">reply.writeInt(shm.size());</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;shm.size();&nbsp;i++)&nbsp;{</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;assume&nbsp;that&nbsp;write&nbsp;only&nbsp;a&nbsp;fd</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">SharedMemory&nbsp;sharedMemory&nbsp;=&nbsp;shm.get(i);</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">sharedMemory.writeToParcel(reply,&nbsp;0);</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">reply.writeLong(sharedMemory.getSize());</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//clean&nbsp;temp&nbsp;dir</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">try</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">FileUtils.deleteDirectory(</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">new</code>&nbsp;<code class="cpp plain">File(RuntimeManagerService.RUNTIME_TEMP_DEX_PATH)</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">);</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">catch</code>&nbsp;<code class="cpp plain">(Throwable&nbsp;e)&nbsp;{</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MagiskEngine.popen(</code><code class="cpp string">"rm&nbsp;-rf&nbsp;"</code><code class="cpp plain">+RuntimeManagerService.RUNTIME_TEMP_DEX_PATH);</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">catch</code>&nbsp;<code class="cpp plain">(Throwable&nbsp;e)&nbsp;{</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CLog.e(</code><code class="cpp string">"DEX_TRANSACTION_CODE&nbsp;handler&nbsp;error&nbsp;&nbsp;"</code>&nbsp;<code class="cpp plain">+&nbsp;e,&nbsp;e);</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//CLog.i("RuntimeManagerService&nbsp;receive&nbsp;DEX_TRANSACTION_CODE&nbsp;return");</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>服务端直接打开/system/framework/myjar.jar , myjar里面装的是Dex</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>打开这个jar包以后，把这个jar包用SharedMemory加载到内存里 ，加载没问题以后直接往客户端写入 对应的SharedMemory句柄，这块支持多个dex写入，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>写入方式如下 ：</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">SharedMemory&nbsp;sharedMemory&nbsp;=&nbsp;shm.get(i);</code></div><div class="line number2 index1 alt1"><code class="cpp plain">sharedMemory.writeToParcel(reply,&nbsp;0);</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我写入的格式是先写入具体加载fd的个数 ，然后对应的文件句柄 fd和fd的size &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>客户端从包裹里面读取服务端写入的值，按照顺序，先读取具体加载的fd句柄个数 &nbsp;，然后for循环去读取fd和fd大小，加载fd即可 ,mmap加载到内存以后使用InMemoryDexClassLoader去加载 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">jobject&nbsp;DexLoader::FromDexFd(JNIEnv&nbsp;*env,</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::vector&lt;std::tuple&lt;</code><code class="cpp color1 bold">int</code><code class="cpp plain">,&nbsp;</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">&gt;&gt;&nbsp;fd_list,</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">std::string&amp;&nbsp;process_name&nbsp;)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(fd_list.size()&nbsp;==&nbsp;0)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOGE(</code><code class="cpp string">"DexLoader::FromDexFd&nbsp;fd&nbsp;size&lt;=0"</code><code class="cpp plain">)</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOGI(</code><code class="cpp string">"DexLoader::FromDexFd&nbsp;start&nbsp;load&nbsp;dex&nbsp;%s&nbsp;"</code><code class="cpp plain">,&nbsp;process_name.c_str())</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobjectArray&nbsp;byteBuffArray&nbsp;=</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">env-&gt;NewObjectArray(fd_list.size(),env-&gt;FindClass(</code><code class="cpp string">"java/nio/ByteBuffer"</code><code class="cpp plain">),&nbsp;NULL);</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i=0;i&lt;fd_list.size();i++){</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::tuple&lt;</code><code class="cpp color1 bold">int</code><code class="cpp plain">,&nbsp;</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">&gt;&nbsp;fd_info&nbsp;=&nbsp;&nbsp;fd_list.at(i);</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">fd&nbsp;=&nbsp;std::get&lt;0&gt;(fd_info);</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">size&nbsp;=&nbsp;std::get&lt;1&gt;(fd_info);</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">*addr&nbsp;=&nbsp;mmap(nullptr,&nbsp;size,&nbsp;PROT_READ,&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;0);</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOGI(</code><code class="cpp string">"DexLoader::FromDexFd&nbsp;mmap&nbsp;start&nbsp;-&gt;&nbsp;%p&nbsp;&nbsp;[%s]&nbsp;"</code><code class="cpp plain">,addr,&nbsp;printMappedRegion(addr).c_str())</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//auto&nbsp;*addr&nbsp;=&nbsp;mmap(nullptr,&nbsp;size,&nbsp;PROT_READ,&nbsp;MAP_ANONYMOUS&nbsp;|&nbsp;MAP_SHARED,&nbsp;fd,&nbsp;0);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(addr&nbsp;==&nbsp;MAP_FAILED)&nbsp;{</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOGE(</code><code class="cpp string">"DexLoader::FromDexFd&nbsp;mmap&nbsp;error&nbsp;%s&nbsp;"</code><code class="cpp plain">,&nbsp;</code><code class="cpp functions bold">strerror</code><code class="cpp plain">(</code><code class="cpp functions bold">errno</code><code class="cpp plain">))</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//get&nbsp;byte&nbsp;buff</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ScopedLocalRef&lt;jobject&gt;&nbsp;buffer(env,env-&gt;NewDirectByteBuffer(addr,&nbsp;(</code><code class="cpp color1 bold">long</code><code class="cpp plain">)&nbsp;size));</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">env-&gt;SetObjectArrayElement(byteBuffArray,i,buffer.get());</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//LOGI("DexLoader::FromDexFd&nbsp;mmap&nbsp;success&nbsp;%lu&nbsp;%p&nbsp;-&nbsp;%p&nbsp;package&nbsp;name&nbsp;-&gt;&nbsp;[%s]&nbsp;",&nbsp;size,addr,(void*)((char*)addr+size),process_name.c_str())</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(InMemoryDexClassLoader&nbsp;==&nbsp;nullptr){</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">InMemoryDexClassLoader&nbsp;=&nbsp;WellKnownClasses::CacheClass(env,</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"dalvik/system/InMemoryDexClassLoader"</code><code class="cpp plain">);</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(InMemoryDexClassLoader_init&nbsp;==&nbsp;nullptr){</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//more&nbsp;dex</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">InMemoryDexClassLoader_init&nbsp;=&nbsp;WellKnownClasses::CacheMethod(env,</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">InMemoryDexClassLoader,</code><code class="cpp string">"&lt;init&gt;"</code><code class="cpp plain">,</code><code class="cpp string">"([Ljava/nio/ByteBuffer;Ljava/lang/ClassLoader;)V"</code><code class="cpp plain">,</code><code class="cpp keyword bold">false</code><code class="cpp plain">);</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WellKnownClasses::Init(env);</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ScopedLocalRef&lt;jobject&gt;&nbsp;system_class_loader(env,&nbsp;env-&gt;CallStaticObjectMethod(</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WellKnownClasses::java_lang_ClassLoader,</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WellKnownClasses::java_lang_ClassLoader_getSystemClassLoader));</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">jobject&nbsp;loader&nbsp;=&nbsp;env-&gt;NewObject(InMemoryDexClassLoader,&nbsp;InMemoryDexClassLoader_init,</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">byteBuffArray,&nbsp;system_class_loader.get());</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(JNIHelper::ExceptionCheck(env))&nbsp;{</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">loader;</code></div><div class="line number47 index46 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块在指定客户端加载的时候，你只需要初始化一下lsplant，即可实现对任意进程的java hook </span></p><h4 style="font-size:6; line-height:1.4; color:rgb(51, 51, 51); font-family:none;"><span>4、客户端如何规避Class检测？</span></h4><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>如果我们注入了一条进程，但是目标进程通过内存漫游拿到的全部的classloader，然后去对每个classloader去loadclass ，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接load比如某一个特征class，这样会导致这个class被暴露 ，导致我们代码泄漏 ，所以这块可以用一个内存混淆 ，主要用的是lsposed里面的obfuscation.cpp</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>他这个原理是对内存dex进行混淆 ，比如正常的路径是com/zhenxi/hack ，他可以混淆成A/B/C这种随机字符串包名 ，这块添加点在系统服务打开dex的时候，得到了这个SharedMemory以后，对里面的内容进行混淆 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">static</code>&nbsp;<code class="java plain">SharedMemory&nbsp;readDex(InputStream&nbsp;in)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">IOException,&nbsp;ErrnoException&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">var&nbsp;memory&nbsp;=&nbsp;SharedMemory.create(</code><code class="java keyword">null</code><code class="java plain">,&nbsp;in.available());</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">var&nbsp;byteBuffer&nbsp;=&nbsp;memory.mapReadWrite();</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Channels.newChannel(in).read(byteBuffer);</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">SharedMemory.unmap(byteBuffer);</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(BuildConfig.isObfuscationDex)&nbsp;{</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//obfuscate&nbsp;dex</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">SharedMemory&nbsp;newMemory&nbsp;=&nbsp;ObfuscationManager.obfuscateDex(memory);</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(BuildConfig.isSavefuscationDex)&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">saveObfuscationDex(newMemory);</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(memory&nbsp;!=&nbsp;newMemory)&nbsp;{</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">memory.close();</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">memory&nbsp;=&nbsp;newMemory;</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">memory.setProtect(OsConstants.PROT_READ);</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">memory;</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java keyword">synchronized</code>&nbsp;<code class="java keyword">static</code>&nbsp;<code class="java plain">ArrayList&lt;SharedMemory&gt;&nbsp;getPreloadDex(List&lt;File&gt;&nbsp;dexFiles)&nbsp;{</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(preloadDex&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">preloadDex&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">ArrayList&lt;&gt;();</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(File&nbsp;dex_file&nbsp;:&nbsp;dexFiles)&nbsp;{</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(!dex_file.exists())&nbsp;{</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"RuntimeManagerService&nbsp;getPreloadDex&nbsp;file&nbsp;not&nbsp;find&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;dex_file);</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">continue</code><code class="java plain">;</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">(var&nbsp;is&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">FileInputStream(dex_file))&nbsp;{</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">preloadDex.add(readDex(is));</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Throwable&nbsp;e)&nbsp;{</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"RuntimeManagerService&nbsp;preload&nbsp;dex"</code><code class="java plain">,&nbsp;e);</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">preloadDex;</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>因为你混淆了，还需要在服务端暴露一个查询接口 ，比如客户端得到的A/B/C的原始路径是com/zhenxi/hack，防止反射失败 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>可以站在obfuscation.cpp里面配置好自己需要混淆的路径即可。具体源码可以参考Lsposed 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_3"><span>设备指纹对抗：</span></h1><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_5"><span>设备指纹相关的对抗（system_service）</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>系统服务的都很简单，直接在system_service初始化lsplant以后 ，直接用Xposedapi去hook即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>举个例子，修改整个android系统的android id 。直接hook SettingsProvider 里面的call方法即可对全部的android id进行修改 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Class&lt;?&gt;&nbsp;SettingsProviderClazz&nbsp;=&nbsp;RuntimeManagerService.findclass(</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"com.android.providers.settings.SettingsProvider"</code><code class="java plain">);</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(SettingsProviderClazz&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"ServiceBaseInfoProcessor&nbsp;mockAndroidId&nbsp;ContentProviderProxyClazz&nbsp;==&nbsp;null"</code><code class="java plain">);</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;Bundle&nbsp;call(String&nbsp;method,&nbsp;String&nbsp;name,&nbsp;Bundle&nbsp;args)&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.add(RposedHelpers.findAndHookMethod(SettingsProviderClazz,</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"call"</code><code class="java plain">,&nbsp;String.</code><code class="java keyword">class</code><code class="java plain">,&nbsp;String.</code><code class="java keyword">class</code><code class="java plain">,&nbsp;Bundle.</code><code class="java keyword">class</code><code class="java plain">,&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">RC_MethodHook()&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">afterHookedMethod(MethodHookParam&nbsp;param)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Throwable&nbsp;{</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">.beforeHookedMethod(param);</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//GET_secure/android_id/Bundle[mParcelledData.dataSize=48]</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">var&nbsp;thisOjb&nbsp;=&nbsp;(ContentProvider)&nbsp;param.thisObject;</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(thisOjb&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//if(!FPServiceProcessManager.isMatchCallPackageInfo(thisOjb.getCallingPackage()))&nbsp;return;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;key&nbsp;=&nbsp;(String)&nbsp;param.args[</code><code class="java value">1</code><code class="java plain">];</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(StringUtils.isEmpty(key))&nbsp;{</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//args&nbsp;bundle</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//Bundle&nbsp;bundle&nbsp;=&nbsp;(Bundle)&nbsp;param.args[2];</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//result</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Bundle&nbsp;result&nbsp;=&nbsp;(Bundle)&nbsp;param.getResult();</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;!=&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;orig_value&nbsp;=&nbsp;result.getString(</code><code class="java string">"value"</code><code class="java plain">);</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;mock_value&nbsp;=&nbsp;getMockValueDistribution(orig_value,&nbsp;key,thisOjb.getCallingPackage());</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(mock_value&nbsp;!=&nbsp;</code><code class="java keyword">null</code>&nbsp;<code class="java plain">&amp;&amp;&nbsp;!mock_value.equals(orig_value))&nbsp;{</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Bundle&nbsp;temp_result&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">Bundle();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">temp_result.putString(</code><code class="java string">"value"</code><code class="java plain">,&nbsp;mock_value);</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">param.setResult(temp_result);</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.i(</code><code class="java string">"["</code>&nbsp;<code class="java plain">+&nbsp;key&nbsp;+&nbsp;</code><code class="java string">"]&nbsp;system_service&nbsp;orig&nbsp;value&nbsp;["</code>&nbsp;<code class="java plain">+&nbsp;orig_value&nbsp;+&nbsp;</code><code class="java string">"]&nbsp;mock&nbsp;value&nbsp;-&gt;&nbsp;["</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">+&nbsp;mock_value&nbsp;+&nbsp;</code><code class="java string">"]&nbsp;call&nbsp;package&nbsp;-&gt;&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;thisOjb.getCallingPackage());</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number37 index36 alt2"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLog.i("["&nbsp;+&nbsp;key&nbsp;+&nbsp;"]&nbsp;system_service&nbsp;orig&nbsp;value&nbsp;["&nbsp;+&nbsp;orig_value&nbsp;+&nbsp;"]&nbsp;mock&nbsp;value&nbsp;-&gt;&nbsp;["</code></div><div class="line number38 index37 alt1"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;mock_value&nbsp;+&nbsp;"]&nbsp;call&nbsp;package&nbsp;-&gt;&nbsp;"&nbsp;+&nbsp;thisOjb.getCallingPackage());</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}));</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Throwable&nbsp;e)&nbsp;{</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"ServiceBaseInfoProcessor&nbsp;mockAndroidId&nbsp;error&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;e,&nbsp;e);</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>因为系统服务是系统全局的，所以任何Apk读取到的都是你mock过的 ，如果想实现包名隐藏，或针对某个Apk读取，让他读取不到指定包的存在。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接在系统服务里面去hook packageManager相关即可 。代码如下 。hook完毕以后任何Apk都读取不到你hook的包 ，可以在isHandler里面整体做分发处理 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><span style="text-decoration:underline;"><span><strong>获取当前调用的uid ，在获取包名 ，判断是谁获取的 获取的包名是什么 ，都一清二楚 。</strong></span></span></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">HookgetPackageInfo(IPackageManager&nbsp;server_package)&nbsp;{</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Method[]&nbsp;declaredMethods&nbsp;=&nbsp;server_package.getClass().getDeclaredMethods();</code></div><div class="line number4 index3 alt1"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;method:&nbsp;declaredMethods){</code></div><div class="line number5 index4 alt2"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLog.e("IPackageManager&nbsp;method&nbsp;info&nbsp;"+method);</code></div><div class="line number6 index5 alt1"><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RC_MethodHook&nbsp;handler_list&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">RC_MethodHook()&nbsp;{</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">afterHookedMethod(MethodHookParam&nbsp;param)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Throwable&nbsp;{</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">.afterHookedMethod(param);</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object&nbsp;result&nbsp;=&nbsp;param.getResult();</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;</code><code class="java keyword">instanceof</code>&nbsp;<code class="java plain">List&lt;?&gt;&nbsp;list)&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">list.removeIf(item&nbsp;-&gt;&nbsp;isHandler(param,item));</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">else</code>&nbsp;<code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;</code><code class="java keyword">instanceof</code>&nbsp;<code class="java plain">ParceledListSlice&lt;?&gt;&nbsp;list)&nbsp;{</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">list.getList().removeIf(item&nbsp;-&gt;&nbsp;isHandler(param,item));</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Throwable&nbsp;e)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"ServicePackageProcessor&nbsp;handler_list&nbsp;error&nbsp;"</code><code class="java plain">,e);</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">};</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RC_MethodHook&nbsp;handler_single&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">RC_MethodHook()&nbsp;{</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">afterHookedMethod(MethodHookParam&nbsp;param)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Throwable&nbsp;{</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">.afterHookedMethod(param);</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object&nbsp;result&nbsp;=&nbsp;param.getResult();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(isHandler(param,result))&nbsp;{</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">param.setResult(</code><code class="java keyword">null</code><code class="java plain">);</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;e)&nbsp;{</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"ServicePackageProcessor&nbsp;handler_single&nbsp;error&nbsp;"</code><code class="java plain">,e);</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">};</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//java.util.List&nbsp;com.android.server.pm.PackageManagerService.getAllPackages()</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getAllPackages"</code><code class="java plain">,&nbsp;handler_list));</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//android.content.pm.ParceledListSlice&nbsp;com.android.server.pm.PackageManagerService.getInstalledPackages(int,int)</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getInstalledPackages"</code><code class="java plain">,&nbsp;handler_list));</code></div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//android.content.pm.ParceledListSlice</code></div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//com.android.server.pm.PackageManagerService.getInstalledApplications(int,int)</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getInstalledApplications"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number61 index60 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number63 index62 alt2">&nbsp;</div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;final&nbsp;ParceledListSlice&lt;PackageInfo&gt;&nbsp;getPackagesHoldingPermissions()</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getPackagesHoldingPermissions"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//List&lt;InstrumentationInfo&gt;&nbsp;queryInstrumentationInternal(String&nbsp;targetPackage,int)</code></div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number76 index75 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryInstrumentationInternal"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number77 index76 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number78 index77 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number79 index78 alt2">&nbsp;</div><div class="line number80 index79 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number81 index80 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number82 index81 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;abstract&nbsp;List&lt;ResolveInfo&gt;&nbsp;queryIntentActivities(@NonNull&nbsp;Intent&nbsp;intent,&nbsp;int&nbsp;flags);</code></div><div class="line number83 index82 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number84 index83 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryIntentActivities"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number85 index84 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number86 index85 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number87 index86 alt2">&nbsp;</div><div class="line number88 index87 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number89 index88 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number90 index89 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;abstract&nbsp;List&lt;ResolveInfo&gt;&nbsp;queryIntentActivityOptions(@Nullable&nbsp;ComponentName&nbsp;caller,</code></div><div class="line number91 index90 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Nullable&nbsp;Intent[]&nbsp;specifics,&nbsp;@NonNull&nbsp;Intent&nbsp;intent,&nbsp;int&nbsp;flags);</code></div><div class="line number92 index91 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number93 index92 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryIntentActivityOptions"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number94 index93 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number95 index94 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number96 index95 alt1">&nbsp;</div><div class="line number97 index96 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number98 index97 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number99 index98 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;List&lt;ResolveInfo&gt;&nbsp;queryIntentServices(Intent&nbsp;intent,&nbsp;ResolveInfoFlags&nbsp;flags)</code></div><div class="line number100 index99 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number101 index100 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryIntentServices"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number102 index101 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number103 index102 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number104 index103 alt1">&nbsp;</div><div class="line number105 index104 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number106 index105 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number107 index106 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;List&lt;ResolveInfo&gt;&nbsp;queryIntentContentProviders(Intent&nbsp;intent,&nbsp;ResolveInfoFlags&nbsp;flags)</code></div><div class="line number108 index107 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number109 index108 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryIntentContentProviders"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number110 index109 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number111 index110 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number112 index111 alt1">&nbsp;</div><div class="line number113 index112 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number114 index113 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number115 index114 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//&nbsp;ParceledListSlice&lt;ResolveInfo&gt;&nbsp;parceledList&nbsp;=&nbsp;mPM.queryIntentReceivers(</code></div><div class="line number116 index115 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number117 index116 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"queryIntentReceivers"</code><code class="java plain">,&nbsp;handler_list</code></div><div class="line number118 index117 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">));</code></div><div class="line number119 index118 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number120 index119 alt1">&nbsp;</div><div class="line number121 index120 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number122 index121 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number123 index122 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//PackageInfo&nbsp;com.android.server.pm.PackageManagerService.getPackageInfo(java.lang.String,int,int)</code></div><div class="line number124 index123 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number125 index124 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getPackageInfo"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number126 index125 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number127 index126 alt2">&nbsp;</div><div class="line number128 index127 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number129 index128 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number130 index129 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//int[]&nbsp;com.android.server.pm.PackageManagerService.getPackageGids(java.lang.String,int,int)</code></div><div class="line number131 index130 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number132 index131 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getPackageGids"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number133 index132 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number134 index133 alt1">&nbsp;</div><div class="line number135 index134 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number136 index135 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number137 index136 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//ApplicationInfo&nbsp;com.android.server.pm.PackageManagerService.getApplicationInfo(java.lang.String,int,int)</code></div><div class="line number138 index137 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number139 index138 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getApplicationInfo"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number140 index139 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number141 index140 alt2">&nbsp;</div><div class="line number142 index141 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number143 index142 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number144 index143 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//InstallSourceInfo</code></div><div class="line number145 index144 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number146 index145 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getInstallSourceInfo"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number147 index146 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number148 index147 alt1">&nbsp;</div><div class="line number149 index148 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number150 index149 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number151 index150 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;abstract&nbsp;@Nullable&nbsp;Intent&nbsp;getLaunchIntentForPackage(@NonNull&nbsp;String&nbsp;packageName);</code></div><div class="line number152 index151 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number153 index152 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getLaunchIntentForPackage"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number154 index153 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number155 index154 alt2">&nbsp;</div><div class="line number156 index155 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number157 index156 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number158 index157 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;abstract&nbsp;@Nullable&nbsp;Intent&nbsp;getLeanbackLaunchIntentForPackage(@NonNull&nbsp;String&nbsp;packageName);</code></div><div class="line number159 index158 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number160 index159 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getLeanbackLaunchIntentForPackage"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number161 index160 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number162 index161 alt1">&nbsp;</div><div class="line number163 index162 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number164 index163 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number165 index164 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;ActivityInfo&nbsp;getActivityInfo(ComponentName&nbsp;className,&nbsp;int&nbsp;flags)</code></div><div class="line number166 index165 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number167 index166 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getActivityInfo"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number168 index167 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number169 index168 alt2">&nbsp;</div><div class="line number170 index169 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number171 index170 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number172 index171 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;ResolveInfo&nbsp;resolveActivity(Intent&nbsp;intent,&nbsp;ResolveInfoFlags&nbsp;flags)</code></div><div class="line number173 index172 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number174 index173 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"resolveActivity"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number175 index174 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number176 index175 alt1">&nbsp;</div><div class="line number177 index176 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number178 index177 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number179 index178 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;ResolveInfo&nbsp;resolveActivityAsUser(Intent&nbsp;intent,&nbsp;ResolveInfoFlags&nbsp;flags,&nbsp;int&nbsp;userId)</code></div><div class="line number180 index179 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number181 index180 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"resolveActivityAsUser"</code><code class="java plain">,&nbsp;handler_single));</code></div><div class="line number182 index181 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number183 index182 alt2">&nbsp;</div><div class="line number184 index183 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number185 index184 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number186 index185 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;int&nbsp;getPackageUid(String&nbsp;packageName,&nbsp;int&nbsp;flags)</code></div><div class="line number187 index186 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">hook_set.addAll(RposedBridge.hookAllMethods(</code></div><div class="line number188 index187 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">server_package.getClass(),&nbsp;</code><code class="java string">"getPackageUid"</code><code class="java plain">,&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">RC_MethodHook()&nbsp;{</code></div><div class="line number189 index188 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number190 index189 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">afterHookedMethod(MethodHookParam&nbsp;param)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Throwable&nbsp;{</code></div><div class="line number191 index190 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">.afterHookedMethod(param);</code></div><div class="line number192 index191 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object&nbsp;result&nbsp;=&nbsp;param.getResult();</code></div><div class="line number193 index192 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number194 index193 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;</code><code class="java keyword">instanceof</code>&nbsp;<code class="java plain">Integer)&nbsp;{</code></div><div class="line number195 index194 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(param.args[</code><code class="java value">0</code><code class="java plain">]&nbsp;</code><code class="java keyword">instanceof</code>&nbsp;<code class="java plain">String&nbsp;package_name)&nbsp;{</code></div><div class="line number196 index195 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(isBlackApp(param,package_name))&nbsp;{</code></div><div class="line number197 index196 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">param.setResult(-</code><code class="java value">1</code><code class="java plain">);</code></div><div class="line number198 index197 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number199 index198 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number200 index199 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number201 index200 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number202 index201 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}));</code></div><div class="line number203 index202 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number204 index203 alt1">&nbsp;</div><div class="line number205 index204 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number206 index205 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>系统服务的hook比较简单 ，只需要基本的Xposed hook即可 。还有其他IMEI，，ICCID ,网卡，蓝牙都可以在系统服务进行处理 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接Hook对应的Api 即可， 这块可以直接吧system/framework里面frameword.jar 解压成class，导入AndroidStudio ，方便类的操作 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>不然每次hook还需要去findclass ，不方便 ，gradle编译设置成只编译即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_6"><span>其他Apk相关Hook :</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>目前只发现oaid,vaid,aaid 这三个基础的是在小米安全中心产生的，他提供一个内容提供者，这块处理也很简单。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接在Magisk模块发现加载是小米安全中心的时候，注入lsplant，请求服务端，拿到java代码句柄，实现和上面类似的逻辑 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接hook对应的代码即可 。可以根据你自己的逻辑去修改对应的hook逻辑 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">public</code>&nbsp;<code class="java keyword">static</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">mockOaid(IRuntimeService&nbsp;service,&nbsp;Context&nbsp;context)&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code><code class="java plain">(isInited)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//小米安全中心里面的类</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Class&lt;?&gt;&nbsp;IdProviderClazz&nbsp;=&nbsp;RposedHelpers.findClass(</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"com.miui.idprovider.IdProvider"</code><code class="java plain">,&nbsp;context.getClassLoader());</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(IdProviderClazz&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.e(</code><code class="java string">"ServiceProcessOthersApks&nbsp;mockOaid&nbsp;&nbsp;IdProvider&nbsp;clazz&nbsp;==&nbsp;null"</code><code class="java plain">);</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//CLog.e("ServiceProcessOthersApks&nbsp;mockOaid&nbsp;&nbsp;get&nbsp;class&nbsp;success&nbsp;!");</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//public&nbsp;Cursor&nbsp;query(Uri&nbsp;uri,&nbsp;String[]&nbsp;strArr,&nbsp;String&nbsp;str,&nbsp;String[]&nbsp;strArr2,&nbsp;String&nbsp;str2)&nbsp;{</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">RposedHelpers.findAndHookMethod(IdProviderClazz,&nbsp;</code><code class="java string">"query"</code><code class="java plain">,</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Uri.</code><code class="java keyword">class</code><code class="java plain">,</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String[].</code><code class="java keyword">class</code><code class="java plain">,&nbsp;String.</code><code class="java keyword">class</code><code class="java plain">,</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String[].</code><code class="java keyword">class</code><code class="java plain">,&nbsp;String.</code><code class="java keyword">class</code><code class="java plain">,&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">RC_MethodHook()&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">afterHookedMethod(MethodHookParam&nbsp;param)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Throwable&nbsp;{</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">.afterHookedMethod(param);</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object&nbsp;arg&nbsp;=&nbsp;param.args[</code><code class="java value">0</code><code class="java plain">];</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(arg&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Object&nbsp;result&nbsp;=&nbsp;param.getResult();</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(result&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cursor&nbsp;ret&nbsp;=&nbsp;(Cursor)&nbsp;result;</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(param.thisObject&nbsp;</code><code class="java keyword">instanceof</code>&nbsp;<code class="java plain">ContentProvider&nbsp;object)&nbsp;{</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Uri&nbsp;uri&nbsp;=&nbsp;(Uri)&nbsp;arg;</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(object.getCallingPackage()&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code><code class="java plain">;</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;callingPackage&nbsp;=&nbsp;object.getCallingPackage();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//CLog.i("ServiceProcessOthersApks&nbsp;callingPackage&nbsp;"+callingPackage);</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//只处理目标Apk,减少请求服务端逻辑</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(callingPackage.equals(BuildConfig.tagPackageName))&nbsp;{</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(uri.toString().equals(AUTHORITY&nbsp;+&nbsp;PATH_OAID))&nbsp;{</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handlerId(param,&nbsp;service,&nbsp;ret,&nbsp;PATH_OAID);</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">else</code>&nbsp;<code class="java keyword">if</code>&nbsp;<code class="java plain">(uri.toString().equals(AUTHORITY&nbsp;+&nbsp;PATH_AAID))&nbsp;{</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handlerId(param,&nbsp;service,&nbsp;ret,&nbsp;PATH_AAID);</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">else</code>&nbsp;<code class="java keyword">if</code>&nbsp;<code class="java plain">(uri.toString().equals(AUTHORITY&nbsp;+&nbsp;PATH_VAID))&nbsp;{</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">handlerId(param,&nbsp;service,&nbsp;ret,&nbsp;PATH_VAID);</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">else</code>&nbsp;<code class="java plain">{</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">CLog.i(</code><code class="java string">"not&nbsp;match&nbsp;uri&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;uri&nbsp;+&nbsp;</code><code class="java string">"&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;AUTHORITY&nbsp;+&nbsp;PATH_OAID);</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">});</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">isInited&nbsp;=&nbsp;</code><code class="java keyword">true</code><code class="java plain">;</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div></div></td></tr></tbody></table><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_7"><span>内核ID相关Hook：</span></h2><table width="1140" style="width:1077px;"><thead style="background-color:rgb(248, 248, 248);"><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><span style="min-width:1ch; width:876px; min-height:10px;"><span>常用内核ID</span></span></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><br></th><th style="padding:6px 13px; border-top-color:rgb(223, 226, 229); border-right-color:rgb(223, 226, 229); border-left-color:rgb(223, 226, 229);"><br></th></tr></thead><tbody><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>/sys/block/mmcblk0/device/cid</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>/sys/block/mmcblk0/device/serial</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>/sys/devices/soc0/serial_number</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>/proc/sys/kernel/random/boot_id</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px;"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>netlink网卡</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr><tr style="border:1px solid rgb(223, 226, 229); padding:0px; background-color:rgb(248, 248, 248);"><td style="padding:6px 13px; min-width:32px;"><span style="min-width:1ch; width:876px; min-height:10px;"><span>内核配置文件相关</span></span></td><td style="padding:6px 13px; min-width:32px;"><br></td><td style="padding:6px 13px; min-width:32px;"><br></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块其实一直我一个很蛋疼的点 ，因为在这个值的产生是在内核里面，不属于任何Apk 范畴，但是又可以当设备指纹 ，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如最基本的一个boot id ，虽然这玩意重启以后会发生变化 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>他获取方式就可能三种多 ；</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>1、比如svc去open这个文件读取内容 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>2、popen cat这个文件内容，</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>3、在搞版本里面 也可以直接进入到当前进程的fd句柄下 ，直接ls - l 也能查到对应的boot_id</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  bash"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">houji:/&nbsp;</code><code class="bash comments">#&nbsp;ls&nbsp;-l&nbsp;/proc/19178/fd</code></div><div class="line number2 index1 alt1"><code class="bash plain">total&nbsp;0</code></div><div class="line number3 index2 alt2"><code class="bash plain">lrwx------&nbsp;1&nbsp;root&nbsp;root&nbsp;64&nbsp;2024-05-24&nbsp;22:46&nbsp;0&nbsp;-&gt;&nbsp;</code><code class="bash plain">/dev/null</code></div><div class="line number4 index3 alt1"><code class="bash plain">lrwx------&nbsp;1&nbsp;root&nbsp;root&nbsp;64&nbsp;2024-05-24&nbsp;22:46&nbsp;1&nbsp;-&gt;&nbsp;</code><code class="bash plain">/dev/null</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="bash plain">lrwx------&nbsp;1&nbsp;root&nbsp;root&nbsp;64&nbsp;2024-05-24&nbsp;22:46&nbsp;79&nbsp;-&gt;&nbsp;</code><code class="bash plain">/dev/ashmem5bc1633e-ea26-444e-b8a6-d7f607b9dd37</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="bash plain">lr-x------&nbsp;1&nbsp;root&nbsp;root&nbsp;64&nbsp;2024-05-24&nbsp;22:46&nbsp;8&nbsp;-&gt;&nbsp;</code><code class="bash plain">/apex/com</code><code class="bash plain">.android.art</code><code class="bash plain">/javalib/core-oj</code><code class="bash plain">.jar</code></div><div class="line number9 index8 alt2"><code class="bash plain">lrwx------&nbsp;1&nbsp;root&nbsp;root&nbsp;64&nbsp;2024-05-24&nbsp;22:46&nbsp;80&nbsp;-&gt;&nbsp;socket:[605258]</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如上面的第三行, /dev/ashmem &nbsp;后面这一串就是对应的boot_id ，5bc1633e-ea26-444e-b8a6-d7f607b9dd37</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>因为我们当前手机可能有10个账号同时在，所以我们希望每个账号单独一份boot_id ，比如当A账号启动的时候切换到A账号的Boot_id 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这样。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我之前的修改方案是直接编译小米内核，发现坑居多 ，小米内核很多驱动不开源，比如什么屏幕下指纹解锁等都是不开源的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>低版本android编译还好，还顺利，但是高版本编译的话各种坑 ，环境也是不全的 。最后发现单独编译内核在内核里面修改是【一条死路】 。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块划重点 ，当时研究编译高版本小米内核研究了一个多月，也没搞定 。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>这块还有一个坑，就是你为什么不用自定义ROM去做？</span></p><p style="line-height:1; margin-top:0.8em;"><span>因为国内环境对原生ROM检测能力较强，意义不大，改动成本也太大，不适合做插件化，随开随关。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>正当我一筹莫展时候，发现Apatch 支持了Hook内核的能力 ，只要你的手机刷了Apatch ，即可使用KPM模块，去开发自己内核hook工具 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>Apatch 不仅仅可以运行Magisk模块，还可以支持内核模块Hook 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>举个例子 ：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>如果想修改Boot_id，我们先看内核他是怎么获取的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>他是通过sysctl函数在内核里面暴露给外读取的一个函数 对应的。源码位置如下 。初始化如下 </span> <span>Kernel\drivers\char\random.c</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.procname&nbsp;=&nbsp;</code><code class="cpp string">"boot_id"</code><code class="cpp plain">,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.data&nbsp;=&nbsp;&amp;sysctl_bootid,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.maxlen&nbsp;=&nbsp;16,</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.mode&nbsp;=&nbsp;0444,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.proc_handler&nbsp;=&nbsp;proc_do_uuid,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">},</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>可以看到data 指向真是数据在 sysctl_bootid</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>其实就是一个16字节的数组 static char sysctl_bootid[16]; 在c文件的最上面 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们直接使用KPM模块直接hook即可 ,把原始的值地址保存起来，然后自定义一个syscall，往内核里面写入一个Mock 的boot_id即可 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*sysctl_bootid&nbsp;=&nbsp;0;</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">initHackBootId(){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">sysctl_bootid&nbsp;=&nbsp;(</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*)kallsyms_lookup_name(</code><code class="cpp string">"sysctl_bootid"</code><code class="cpp plain">);</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//save&nbsp;orig&nbsp;boot_id</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memset</code><code class="cpp plain">(ori_sysctl_bootid,&nbsp;0,&nbsp;0x10);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memcpy</code><code class="cpp plain">(ori_sysctl_bootid,&nbsp;sysctl_bootid,&nbsp;0x10);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">snprintf(ori_ashmem_path,&nbsp;ASHMEM_FULL_NAME_LEN,&nbsp;</code><code class="cpp string">"%s%pU"</code><code class="cpp plain">,&nbsp;ASHMEM_NAME_PREFIX,&nbsp;ori_sysctl_bootid);</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(sysctl_bootid&nbsp;==&nbsp;NULL){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_info(</code><code class="cpp string">"get&nbsp;sysctl_bootid&nbsp;sym&nbsp;sysctl_bootid&nbsp;==&nbsp;NULL&nbsp;\n"</code><code class="cpp plain">);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_info(</code><code class="cpp string">"runtime_kpm:&nbsp;kernel&nbsp;sysctl_bootid&nbsp;addr:\n&nbsp;%llx&nbsp;%s"</code><code class="cpp plain">,sysctl_bootid,&nbsp;sysctl_bootid);</code></div><div class="line number12 index11 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接调用这个自定义的Syscall直接往原始boot_id写入即可 。已经通过kallsyms_lookup_name 获取到了原始的字节数组指针 。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>这个Boot_id修改以后还有个坑 ，修改以后任何APk 都打不开了 ，原因是因为服务端因为已经加载了 ，保存的是原始的boot_id 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>然后我们往服务端发送具体的改机指令，服务端开始通过Syscall往内核写入mock boot_id ，因为我们需要在客户端启动之前完成mock指纹的工作</span></p><p style="line-height:1; margin-top:0.8em;"><span>客户端刚刚启动 ，这时候客户端读取服务端资源的时候，是通过共享内存的方式去写入的 ，客户端拿到的也是一个fd文件句柄 ，客户端尝试去打开这个文件句柄的时候，发现找不到这个boot_id导致任何Apk都打不开，这块解决办法也很简单 ，可以使用mknod进行backup即可解决。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>其他的字段修改也很简单，在内核里面没那么多事，直接hook对应的函数，实现修改即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>搞一个mock value，搞一个自定义syscall 给mockvalue赋值 。如果mockvalue不等于null ，hook内核函数优先读取mockvalue即可 。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>最早的时候我实现内核对抗的时候采用也是自定义内核和编译内核模块的方式，但是高版本刷入不进去，刷完手机就死机。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>之前用的版本一直都是Android 10 ，就拿Boot_Id来说 ，这块其实他就是一个sysctl函数 ，这个函数是方便内核和应用层交互的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>改内核也很简单 ，可以直接在内核里面添加一个sysctl函数，直接对应用层暴露一个命令，直接写入即可 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">hack_bootid(</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">ctl_table&nbsp;*table,&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">write,</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">__user&nbsp;*buffer,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">*lenp,&nbsp;loff_t&nbsp;*ppos)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">len;</code></div><div class="line number4 index3 alt1"><code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">ret;</code></div><div class="line number5 index4 alt2"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!write)&nbsp;{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_err(</code><code class="cpp string">"hack_bootid:&nbsp;Attempt&nbsp;to&nbsp;read-only"</code><code class="cpp plain">);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-EFAULT;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div><div class="line number9 index8 alt2"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(write)&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">len&nbsp;=&nbsp;min_t(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">,&nbsp;*lenp,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(sysctl_bootid));</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_info(</code><code class="cpp string">"hack_bootid:&nbsp;Attempt&nbsp;to&nbsp;write.&nbsp;Requested&nbsp;len=%zu"</code><code class="cpp plain">,&nbsp;len);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(len)&nbsp;{</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memset</code><code class="cpp plain">(sysctl_bootid,&nbsp;0,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(sysctl_bootid));</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ret&nbsp;=&nbsp;copy_from_user(sysctl_bootid,&nbsp;buffer,&nbsp;len);&nbsp;</code><code class="cpp comments">//&nbsp;直接从用户空间拷贝数据</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret)&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_err(</code><code class="cpp string">"hack_bootid:&nbsp;Failed&nbsp;to&nbsp;copy&nbsp;data&nbsp;from&nbsp;user&nbsp;space"</code><code class="cpp plain">);</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-EFAULT;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pr_info(</code><code class="cpp string">"hack_bootid:&nbsp;Successfully&nbsp;updated&nbsp;sysctl_bootid&nbsp;ret&nbsp;=&nbsp;%d&nbsp;"</code><code class="cpp plain">,ret);</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2"><code class="cpp plain">}</code></div><div class="line number22 index21 alt1"><code class="cpp plain">pr_info(</code><code class="cpp string">"hack_bootid:&nbsp;Current&nbsp;bootid&nbsp;-&gt;&nbsp;[%.*s]"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">int</code><code class="cpp plain">)</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(sysctl_bootid),&nbsp;sysctl_bootid);</code></div><div class="line number23 index22 alt2"><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number24 index23 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>内核里面注册对应的sysctl表, 应用层可以直接</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.procname&nbsp;=&nbsp;</code><code class="cpp string">"hack_boot_id"</code><code class="cpp plain">,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.data&nbsp;=&nbsp;&amp;sysctl_bootid,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.maxlen&nbsp;=&nbsp;16,</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.mode&nbsp;=&nbsp;0666,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">.proc_handler&nbsp;=&nbsp;hack_bootid,</code></div><div class="line number7 index6 alt2"><code class="cpp plain">},</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>修改的话直接一条命令行 ，也可以实现。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  css"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="css plain">sysctl&nbsp;-w&nbsp;kernel.random.hack_boot_id=</code><code class="css string">"1234567890123456"</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em;"><span>不过现在有了Apatch以后就抛弃了。</span></p></blockquote><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_8"><span>Init进程设备指纹相关：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这个是最特殊的一个设备指纹，比如刚开头的时候说过 ，DRMID这种 产生就在Init 进程产生的。init作为一切进程的始祖，它里面包含的东西太多了 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>正是因为时间太早。所以想要hook这个进程成本很高 ，需要注入进去 ，我之前找空大师（zygisk_next作者 ，lsposed作者之一）聊过，想着在zygisk_next添加init进程的回调，但是也不知道现在开发进度如何了 。不知道等到猴年马月 ，但是这种init进程想要注入只有一个办法了 ，直接用ptrace打进去 ，但是这块还有个坑爹的地方 ，如果用ptrace注入进去以后，怎么把mock值传过去呢？ 传到目标进程里面 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>上面的指纹整体 都是通过系统服务去保存的，想着通过env去调用binder 拿到class 去和服务端通讯 ，但是init进程里面不允许这样 ，因为init进程里面 他创建时间太早了，连JavaVM都没有创建，所以没办法拿到env 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>而且init进程，它属于vendor分区的东西 ，不属于system分区 。 </span></p><blockquote><p style="line-height:1;"><span>在Android8以上，安卓出了个分区隔离 ，system分区里面的不允许读取vendor里面的内容 ，vendor也不允许读取system里面 ，这样各种应用层在Hal层进行修改 。所以就没办法注入目标进程以后通过/system/lib64/libandroid_runtime.so调用_ZN7android14AndroidRuntime7mJavaVME虚拟机的创建 。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>后来想了很久，直接通过ptrace 往目标进程写入一个字符串是最好的办法 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们还是讲drm的进程修改，这玩意其实核心产生位置是在/vendor/lib64/libwvhidl.so &nbsp;下面这个符号里面去产生的。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  css"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="css plain">_ZN</code><code class="css value">5</code><code class="css plain">wvdrm</code><code class="css value">8</code><code class="css plain">hardware</code><code class="css value">3</code><code class="css plain">drm</code><code class="css value">4</code><code class="css plain">V</code><code class="css value">1</code><code class="css plain">_</code><code class="css value">28</code><code class="css plain">widevine</code><code class="css value">11</code><code class="css plain">WVDrmPlugin</code><code class="css value">20</code><code class="css plain">CdmIdentifierBuilder</code><code class="css value">17</code><code class="css plain">getDeviceUniqueIdEPNSt</code><code class="css value">3</code><code class="css plain">__</code><code class="css value">112</code><code class="css plain">basic_stringIcNS</code><code class="css value">6</code><code class="css plain">_</code><code class="css value">11</code><code class="css plain">char_traitsIcEENS</code><code class="css value">6</code><code class="css plain">_</code><code class="css value">9</code><code class="css plain">allocatorIcEEEE</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>目标有了，现在用ptrace去实现以下 。我们首先需要先修改system_server允许执行root权限 ，然后用ptrace去写个注入程序 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div><div class="line number243 index242 alt2">243</div><div class="line number244 index243 alt1">244</div><div class="line number245 index244 alt2">245</div><div class="line number246 index245 alt1">246</div><div class="line number247 index246 alt2">247</div><div class="line number248 index247 alt1">248</div><div class="line number249 index248 alt2">249</div><div class="line number250 index249 alt1">250</div><div class="line number251 index250 alt2">251</div><div class="line number252 index251 alt1">252</div><div class="line number253 index252 alt2">253</div><div class="line number254 index253 alt1">254</div><div class="line number255 index254 alt2">255</div><div class="line number256 index255 alt1">256</div><div class="line number257 index256 alt2">257</div><div class="line number258 index257 alt1">258</div><div class="line number259 index258 alt2">259</div><div class="line number260 index259 alt1">260</div><div class="line number261 index260 alt2">261</div><div class="line number262 index261 alt1">262</div><div class="line number263 index262 alt2">263</div><div class="line number264 index263 alt1">264</div><div class="line number265 index264 alt2">265</div><div class="line number266 index265 alt1">266</div><div class="line number267 index266 alt2">267</div><div class="line number268 index267 alt1">268</div><div class="line number269 index268 alt2">269</div><div class="line number270 index269 alt1">270</div><div class="line number271 index270 alt2">271</div><div class="line number272 index271 alt1">272</div><div class="line number273 index272 alt2">273</div><div class="line number274 index273 alt1">274</div><div class="line number275 index274 alt2">275</div><div class="line number276 index275 alt1">276</div><div class="line number277 index276 alt2">277</div><div class="line number278 index277 alt1">278</div><div class="line number279 index278 alt2">279</div><div class="line number280 index279 alt1">280</div><div class="line number281 index280 alt2">281</div><div class="line number282 index281 alt1">282</div><div class="line number283 index282 alt2">283</div><div class="line number284 index283 alt1">284</div><div class="line number285 index284 alt2">285</div><div class="line number286 index285 alt1">286</div><div class="line number287 index286 alt2">287</div><div class="line number288 index287 alt1">288</div><div class="line number289 index288 alt2">289</div><div class="line number290 index289 alt1">290</div><div class="line number291 index290 alt2">291</div><div class="line number292 index291 alt1">292</div><div class="line number293 index292 alt2">293</div><div class="line number294 index293 alt1">294</div><div class="line number295 index294 alt2">295</div><div class="line number296 index295 alt1">296</div><div class="line number297 index296 alt2">297</div><div class="line number298 index297 alt1">298</div><div class="line number299 index298 alt2">299</div><div class="line number300 index299 alt1">300</div><div class="line number301 index300 alt2">301</div><div class="line number302 index301 alt1">302</div><div class="line number303 index302 alt2">303</div><div class="line number304 index303 alt1">304</div><div class="line number305 index304 alt2">305</div><div class="line number306 index305 alt1">306</div><div class="line number307 index306 alt2">307</div><div class="line number308 index307 alt1">308</div><div class="line number309 index308 alt2">309</div><div class="line number310 index309 alt1">310</div><div class="line number311 index310 alt2">311</div><div class="line number312 index311 alt1">312</div><div class="line number313 index312 alt2">313</div><div class="line number314 index313 alt1">314</div><div class="line number315 index314 alt2">315</div><div class="line number316 index315 alt1">316</div><div class="line number317 index316 alt2">317</div><div class="line number318 index317 alt1">318</div><div class="line number319 index318 alt2">319</div><div class="line number320 index319 alt1">320</div><div class="line number321 index320 alt2">321</div><div class="line number322 index321 alt1">322</div><div class="line number323 index322 alt2">323</div><div class="line number324 index323 alt1">324</div><div class="line number325 index324 alt2">325</div><div class="line number326 index325 alt1">326</div><div class="line number327 index326 alt2">327</div><div class="line number328 index327 alt1">328</div><div class="line number329 index328 alt2">329</div><div class="line number330 index329 alt1">330</div><div class="line number331 index330 alt2">331</div><div class="line number332 index331 alt1">332</div><div class="line number333 index332 alt2">333</div><div class="line number334 index333 alt1">334</div><div class="line number335 index334 alt2">335</div><div class="line number336 index335 alt1">336</div><div class="line number337 index336 alt2">337</div><div class="line number338 index337 alt1">338</div><div class="line number339 index338 alt2">339</div><div class="line number340 index339 alt1">340</div><div class="line number341 index340 alt2">341</div><div class="line number342 index341 alt1">342</div><div class="line number343 index342 alt2">343</div><div class="line number344 index343 alt1">344</div><div class="line number345 index344 alt2">345</div><div class="line number346 index345 alt1">346</div><div class="line number347 index346 alt2">347</div><div class="line number348 index347 alt1">348</div><div class="line number349 index348 alt2">349</div><div class="line number350 index349 alt1">350</div><div class="line number351 index350 alt2">351</div><div class="line number352 index351 alt1">352</div><div class="line number353 index352 alt2">353</div><div class="line number354 index353 alt1">354</div><div class="line number355 index354 alt2">355</div><div class="line number356 index355 alt1">356</div><div class="line number357 index356 alt2">357</div><div class="line number358 index357 alt1">358</div><div class="line number359 index358 alt2">359</div><div class="line number360 index359 alt1">360</div><div class="line number361 index360 alt2">361</div><div class="line number362 index361 alt1">362</div><div class="line number363 index362 alt2">363</div><div class="line number364 index363 alt1">364</div><div class="line number365 index364 alt2">365</div><div class="line number366 index365 alt1">366</div><div class="line number367 index366 alt2">367</div><div class="line number368 index367 alt1">368</div><div class="line number369 index368 alt2">369</div><div class="line number370 index369 alt1">370</div><div class="line number371 index370 alt2">371</div><div class="line number372 index371 alt1">372</div><div class="line number373 index372 alt2">373</div><div class="line number374 index373 alt1">374</div><div class="line number375 index374 alt2">375</div><div class="line number376 index375 alt1">376</div><div class="line number377 index376 alt2">377</div><div class="line number378 index377 alt1">378</div><div class="line number379 index378 alt2">379</div><div class="line number380 index379 alt1">380</div><div class="line number381 index380 alt2">381</div><div class="line number382 index381 alt1">382</div><div class="line number383 index382 alt2">383</div><div class="line number384 index383 alt1">384</div><div class="line number385 index384 alt2">385</div><div class="line number386 index385 alt1">386</div><div class="line number387 index386 alt2">387</div><div class="line number388 index387 alt1">388</div><div class="line number389 index388 alt2">389</div><div class="line number390 index389 alt1">390</div><div class="line number391 index390 alt2">391</div><div class="line number392 index391 alt1">392</div><div class="line number393 index392 alt2">393</div><div class="line number394 index393 alt1">394</div><div class="line number395 index394 alt2">395</div><div class="line number396 index395 alt1">396</div><div class="line number397 index396 alt2">397</div><div class="line number398 index397 alt1">398</div><div class="line number399 index398 alt2">399</div><div class="line number400 index399 alt1">400</div><div class="line number401 index400 alt2">401</div><div class="line number402 index401 alt1">402</div><div class="line number403 index402 alt2">403</div><div class="line number404 index403 alt1">404</div><div class="line number405 index404 alt2">405</div><div class="line number406 index405 alt1">406</div><div class="line number407 index406 alt2">407</div><div class="line number408 index407 alt1">408</div><div class="line number409 index408 alt2">409</div><div class="line number410 index409 alt1">410</div><div class="line number411 index410 alt2">411</div><div class="line number412 index411 alt1">412</div><div class="line number413 index412 alt2">413</div><div class="line number414 index413 alt1">414</div><div class="line number415 index414 alt2">415</div><div class="line number416 index415 alt1">416</div><div class="line number417 index416 alt2">417</div><div class="line number418 index417 alt1">418</div><div class="line number419 index418 alt2">419</div><div class="line number420 index419 alt1">420</div><div class="line number421 index420 alt2">421</div><div class="line number422 index421 alt1">422</div><div class="line number423 index422 alt2">423</div><div class="line number424 index423 alt1">424</div><div class="line number425 index424 alt2">425</div><div class="line number426 index425 alt1">426</div><div class="line number427 index426 alt2">427</div><div class="line number428 index427 alt1">428</div><div class="line number429 index428 alt2">429</div><div class="line number430 index429 alt1">430</div><div class="line number431 index430 alt2">431</div><div class="line number432 index431 alt1">432</div><div class="line number433 index432 alt2">433</div><div class="line number434 index433 alt1">434</div><div class="line number435 index434 alt2">435</div><div class="line number436 index435 alt1">436</div><div class="line number437 index436 alt2">437</div><div class="line number438 index437 alt1">438</div><div class="line number439 index438 alt2">439</div><div class="line number440 index439 alt1">440</div><div class="line number441 index440 alt2">441</div><div class="line number442 index441 alt1">442</div><div class="line number443 index442 alt2">443</div><div class="line number444 index443 alt1">444</div><div class="line number445 index444 alt2">445</div><div class="line number446 index445 alt1">446</div><div class="line number447 index446 alt2">447</div><div class="line number448 index447 alt1">448</div><div class="line number449 index448 alt2">449</div><div class="line number450 index449 alt1">450</div><div class="line number451 index450 alt2">451</div><div class="line number452 index451 alt1">452</div><div class="line number453 index452 alt2">453</div><div class="line number454 index453 alt1">454</div><div class="line number455 index454 alt2">455</div><div class="line number456 index455 alt1">456</div><div class="line number457 index456 alt2">457</div><div class="line number458 index457 alt1">458</div><div class="line number459 index458 alt2">459</div><div class="line number460 index459 alt1">460</div><div class="line number461 index460 alt2">461</div><div class="line number462 index461 alt1">462</div><div class="line number463 index462 alt2">463</div><div class="line number464 index463 alt1">464</div><div class="line number465 index464 alt2">465</div><div class="line number466 index465 alt1">466</div><div class="line number467 index466 alt2">467</div><div class="line number468 index467 alt1">468</div><div class="line number469 index468 alt2">469</div><div class="line number470 index469 alt1">470</div><div class="line number471 index470 alt2">471</div><div class="line number472 index471 alt1">472</div><div class="line number473 index472 alt2">473</div><div class="line number474 index473 alt1">474</div><div class="line number475 index474 alt2">475</div><div class="line number476 index475 alt1">476</div><div class="line number477 index476 alt2">477</div><div class="line number478 index477 alt1">478</div><div class="line number479 index478 alt2">479</div><div class="line number480 index479 alt1">480</div><div class="line number481 index480 alt2">481</div><div class="line number482 index481 alt1">482</div><div class="line number483 index482 alt2">483</div><div class="line number484 index483 alt1">484</div><div class="line number485 index484 alt2">485</div><div class="line number486 index485 alt1">486</div><div class="line number487 index486 alt2">487</div><div class="line number488 index487 alt1">488</div><div class="line number489 index488 alt2">489</div><div class="line number490 index489 alt1">490</div><div class="line number491 index490 alt2">491</div><div class="line number492 index491 alt1">492</div><div class="line number493 index492 alt2">493</div><div class="line number494 index493 alt1">494</div><div class="line number495 index494 alt2">495</div><div class="line number496 index495 alt1">496</div><div class="line number497 index496 alt2">497</div><div class="line number498 index497 alt1">498</div><div class="line number499 index498 alt2">499</div><div class="line number500 index499 alt1">500</div><div class="line number501 index500 alt2">501</div><div class="line number502 index501 alt1">502</div><div class="line number503 index502 alt2">503</div><div class="line number504 index503 alt1">504</div><div class="line number505 index504 alt2">505</div><div class="line number506 index505 alt1">506</div><div class="line number507 index506 alt2">507</div><div class="line number508 index507 alt1">508</div><div class="line number509 index508 alt2">509</div><div class="line number510 index509 alt1">510</div><div class="line number511 index510 alt2">511</div><div class="line number512 index511 alt1">512</div><div class="line number513 index512 alt2">513</div><div class="line number514 index513 alt1">514</div><div class="line number515 index514 alt2">515</div><div class="line number516 index515 alt1">516</div><div class="line number517 index516 alt2">517</div><div class="line number518 index517 alt1">518</div><div class="line number519 index518 alt2">519</div><div class="line number520 index519 alt1">520</div><div class="line number521 index520 alt2">521</div><div class="line number522 index521 alt1">522</div><div class="line number523 index522 alt2">523</div><div class="line number524 index523 alt1">524</div><div class="line number525 index524 alt2">525</div><div class="line number526 index525 alt1">526</div><div class="line number527 index526 alt2">527</div><div class="line number528 index527 alt1">528</div><div class="line number529 index528 alt2">529</div><div class="line number530 index529 alt1">530</div><div class="line number531 index530 alt2">531</div><div class="line number532 index531 alt1">532</div><div class="line number533 index532 alt2">533</div><div class="line number534 index533 alt1">534</div><div class="line number535 index534 alt2">535</div><div class="line number536 index535 alt1">536</div><div class="line number537 index536 alt2">537</div><div class="line number538 index537 alt1">538</div><div class="line number539 index538 alt2">539</div><div class="line number540 index539 alt1">540</div><div class="line number541 index540 alt2">541</div><div class="line number542 index541 alt1">542</div><div class="line number543 index542 alt2">543</div><div class="line number544 index543 alt1">544</div><div class="line number545 index544 alt2">545</div><div class="line number546 index545 alt1">546</div><div class="line number547 index546 alt2">547</div><div class="line number548 index547 alt1">548</div><div class="line number549 index548 alt2">549</div><div class="line number550 index549 alt1">550</div><div class="line number551 index550 alt2">551</div><div class="line number552 index551 alt1">552</div><div class="line number553 index552 alt2">553</div><div class="line number554 index553 alt1">554</div><div class="line number555 index554 alt2">555</div><div class="line number556 index555 alt1">556</div><div class="line number557 index556 alt2">557</div><div class="line number558 index557 alt1">558</div><div class="line number559 index558 alt2">559</div><div class="line number560 index559 alt1">560</div><div class="line number561 index560 alt2">561</div><div class="line number562 index561 alt1">562</div><div class="line number563 index562 alt2">563</div><div class="line number564 index563 alt1">564</div><div class="line number565 index564 alt2">565</div><div class="line number566 index565 alt1">566</div><div class="line number567 index566 alt2">567</div><div class="line number568 index567 alt1">568</div><div class="line number569 index568 alt2">569</div><div class="line number570 index569 alt1">570</div><div class="line number571 index570 alt2">571</div><div class="line number572 index571 alt1">572</div><div class="line number573 index572 alt2">573</div><div class="line number574 index573 alt1">574</div><div class="line number575 index574 alt2">575</div><div class="line number576 index575 alt1">576</div><div class="line number577 index576 alt2">577</div><div class="line number578 index577 alt1">578</div><div class="line number579 index578 alt2">579</div><div class="line number580 index579 alt1">580</div><div class="line number581 index580 alt2">581</div><div class="line number582 index581 alt1">582</div><div class="line number583 index582 alt2">583</div><div class="line number584 index583 alt1">584</div><div class="line number585 index584 alt2">585</div><div class="line number586 index585 alt1">586</div><div class="line number587 index586 alt2">587</div><div class="line number588 index587 alt1">588</div><div class="line number589 index588 alt2">589</div><div class="line number590 index589 alt1">590</div><div class="line number591 index590 alt2">591</div><div class="line number592 index591 alt1">592</div><div class="line number593 index592 alt2">593</div><div class="line number594 index593 alt1">594</div><div class="line number595 index594 alt2">595</div><div class="line number596 index595 alt1">596</div><div class="line number597 index596 alt2">597</div><div class="line number598 index597 alt1">598</div><div class="line number599 index598 alt2">599</div><div class="line number600 index599 alt1">600</div><div class="line number601 index600 alt2">601</div><div class="line number602 index601 alt1">602</div><div class="line number603 index602 alt2">603</div><div class="line number604 index603 alt1">604</div><div class="line number605 index604 alt2">605</div><div class="line number606 index605 alt1">606</div><div class="line number607 index606 alt2">607</div><div class="line number608 index607 alt1">608</div><div class="line number609 index608 alt2">609</div><div class="line number610 index609 alt1">610</div><div class="line number611 index610 alt2">611</div><div class="line number612 index611 alt1">612</div><div class="line number613 index612 alt2">613</div><div class="line number614 index613 alt1">614</div><div class="line number615 index614 alt2">615</div><div class="line number616 index615 alt1">616</div><div class="line number617 index616 alt2">617</div><div class="line number618 index617 alt1">618</div><div class="line number619 index618 alt2">619</div><div class="line number620 index619 alt1">620</div><div class="line number621 index620 alt2">621</div><div class="line number622 index621 alt1">622</div><div class="line number623 index622 alt2">623</div><div class="line number624 index623 alt1">624</div><div class="line number625 index624 alt2">625</div><div class="line number626 index625 alt1">626</div><div class="line number627 index626 alt2">627</div><div class="line number628 index627 alt1">628</div><div class="line number629 index628 alt2">629</div><div class="line number630 index629 alt1">630</div><div class="line number631 index630 alt2">631</div><div class="line number632 index631 alt1">632</div><div class="line number633 index632 alt2">633</div><div class="line number634 index633 alt1">634</div><div class="line number635 index634 alt2">635</div><div class="line number636 index635 alt1">636</div><div class="line number637 index636 alt2">637</div><div class="line number638 index637 alt1">638</div><div class="line number639 index638 alt2">639</div><div class="line number640 index639 alt1">640</div><div class="line number641 index640 alt2">641</div><div class="line number642 index641 alt1">642</div><div class="line number643 index642 alt2">643</div><div class="line number644 index643 alt1">644</div><div class="line number645 index644 alt2">645</div><div class="line number646 index645 alt1">646</div><div class="line number647 index646 alt2">647</div><div class="line number648 index647 alt1">648</div><div class="line number649 index648 alt2">649</div><div class="line number650 index649 alt1">650</div><div class="line number651 index650 alt2">651</div><div class="line number652 index651 alt1">652</div><div class="line number653 index652 alt2">653</div><div class="line number654 index653 alt1">654</div><div class="line number655 index654 alt2">655</div><div class="line number656 index655 alt1">656</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;_libinject_log_tag&nbsp;=&nbsp;</code><code class="cpp string">"Zhenxi"</code><code class="cpp plain">;</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">_libinject_log&nbsp;=&nbsp;1;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">libinject_log(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;log_tag)&nbsp;{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_libinject_log_tag&nbsp;=&nbsp;log_tag;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_libinject_log&nbsp;=&nbsp;log_tag&nbsp;==&nbsp;NULL&nbsp;?&nbsp;0&nbsp;:&nbsp;1;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp plain">pid_t&nbsp;_pid;</code></div><div class="line number10 index9 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*_dlopen;</code></div><div class="line number11 index10 alt2"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*_dlerror;</code></div><div class="line number12 index11 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*_calloc;</code></div><div class="line number13 index12 alt2"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*_free;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp keyword bold">typedef</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">(*remote_stop_t)();</code></div><div class="line number16 index15 alt1"><code class="cpp plain">remote_stop_t&nbsp;remote_stop_ptr&nbsp;=&nbsp;NULL;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="cpp comments">//&nbsp;ptrace&nbsp;wrapper&nbsp;with&nbsp;some&nbsp;error&nbsp;checking.</code></div><div class="line number19 index18 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">trace(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;debug,&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">request,&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*addr&nbsp;=&nbsp;NULL,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">data&nbsp;=&nbsp;0)&nbsp;{</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">errno</code>&nbsp;<code class="cpp plain">=&nbsp;0;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">ret&nbsp;=&nbsp;0;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;10;&nbsp;i++)&nbsp;{</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ret&nbsp;=&nbsp;ptrace(request,&nbsp;_pid,&nbsp;(caddr_t)&nbsp;addr,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;data);</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret&nbsp;==&nbsp;-1&nbsp;&amp;&amp;&nbsp;(</code><code class="cpp functions bold">errno</code>&nbsp;<code class="cpp plain">==&nbsp;EBUSY&nbsp;||&nbsp;</code><code class="cpp functions bold">errno</code>&nbsp;<code class="cpp plain">==&nbsp;EFAULT&nbsp;||&nbsp;</code><code class="cpp functions bold">errno</code>&nbsp;<code class="cpp plain">==&nbsp;ESRCH))&nbsp;{</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">eb[16];</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">rb[16];</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;e&nbsp;=&nbsp;NULL;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;r&nbsp;=&nbsp;NULL;</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code>&nbsp;<code class="cpp plain">(</code><code class="cpp functions bold">errno</code><code class="cpp plain">)&nbsp;{</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">ESRCH:&nbsp;e&nbsp;=&nbsp;</code><code class="cpp string">"ESRCH"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">default</code><code class="cpp plain">:&nbsp;snprintf(eb,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(eb),&nbsp;</code><code class="cpp string">"%d"</code><code class="cpp plain">,&nbsp;</code><code class="cpp functions bold">errno</code><code class="cpp plain">);&nbsp;e&nbsp;=&nbsp;eb;</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code>&nbsp;<code class="cpp plain">(request)&nbsp;{</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_PEEKTEXT:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_PEEKTEXT"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_PEEKDATA:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_PEEKDATA"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_POKETEXT:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_POKETEXT"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_POKEDATA:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_POKEDATA"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_CONT:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_CONT"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_KILL:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_KILL"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SINGLESTEP:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SINGLESTEP"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number44 index43 alt1"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_GETREGS)</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_GETREGS:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_GETREGS"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number46 index45 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number47 index46 alt2"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_SETREGS)</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SETREGS:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SETREGS"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number49 index48 alt2"><code class="cpp preprocessor">#endif</code></div><div class="line number50 index49 alt1"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_GETFPREGS)</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_GETFPREGS:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_GETFPREGS"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number52 index51 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number53 index52 alt2"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_SETFPREGS)</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SETFPREGS:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SETFPREGS"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number55 index54 alt2"><code class="cpp preprocessor">#endif</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_ATTACH:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_ATTACH"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_DETACH:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_DETACH"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SYSCALL:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SYSCALL"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SETOPTIONS:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SETOPTIONS"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_GETEVENTMSG:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_GETEVENTMSG"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_GETSIGINFO:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_GETSIGINFO"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SETSIGINFO:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SETSIGINFO"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number63 index62 alt2"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_GETREGSET)</code></div><div class="line number64 index63 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_GETREGSET:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_GETREGSET"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number65 index64 alt2"><code class="cpp preprocessor">#endif</code></div><div class="line number66 index65 alt1"><code class="cpp preprocessor">#if&nbsp;defined(PTRACE_SETREGSET)</code></div><div class="line number67 index66 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">PTRACE_SETREGSET:&nbsp;r&nbsp;=&nbsp;</code><code class="cpp string">"PTRACE_SETREGSET"</code><code class="cpp plain">;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number68 index67 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number69 index68 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">default</code><code class="cpp plain">:&nbsp;snprintf(rb,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(rb),&nbsp;</code><code class="cpp string">"%d"</code><code class="cpp plain">,&nbsp;request);&nbsp;r&nbsp;=&nbsp;rb;</code></div><div class="line number70 index69 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"ptrace&nbsp;[%s]&nbsp;error&nbsp;[%s]&nbsp;on&nbsp;request&nbsp;[%s]"</code><code class="cpp plain">,&nbsp;debug,&nbsp;e,&nbsp;r);</code></div><div class="line number73 index72 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number74 index73 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret&nbsp;==&nbsp;-1&nbsp;&amp;&amp;&nbsp;(</code><code class="cpp functions bold">errno</code>&nbsp;<code class="cpp plain">==&nbsp;ESRCH))&nbsp;{</code></div><div class="line number75 index74 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"ptrace&nbsp;remote_stop/retry"</code><code class="cpp plain">);</code></div><div class="line number76 index75 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(remote_stop_ptr&nbsp;!=&nbsp;NULL)&nbsp;{</code></div><div class="line number77 index76 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop_ptr();</code></div><div class="line number78 index77 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number79 index78 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number82 index81 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number83 index82 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">ret;</code></div><div class="line number84 index83 alt1"><code class="cpp plain">}</code></div><div class="line number85 index84 alt2">&nbsp;</div><div class="line number86 index85 alt1"><code class="cpp comments">/*</code></div><div class="line number87 index86 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;This&nbsp;method&nbsp;will&nbsp;open&nbsp;/proc/&lt;pid&gt;/maps&nbsp;and&nbsp;search&nbsp;for&nbsp;the&nbsp;specified</code></div><div class="line number88 index87 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;library&nbsp;base&nbsp;address.</code></div><div class="line number89 index88 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number90 index89 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">findLibrary(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*library,&nbsp;pid_t&nbsp;pid)&nbsp;{</code></div><div class="line number91 index90 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">filename[0xFF]&nbsp;=&nbsp;{&nbsp;0&nbsp;},&nbsp;buffer[1024]&nbsp;=&nbsp;{&nbsp;0&nbsp;};</code></div><div class="line number92 index91 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">FILE</code>&nbsp;<code class="cpp plain">*fp&nbsp;=&nbsp;NULL;</code></div><div class="line number93 index92 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">address&nbsp;=&nbsp;0;</code></div><div class="line number94 index93 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">isFind&nbsp;=&nbsp;</code><code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number95 index94 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">sprintf</code><code class="cpp plain">(filename,&nbsp;</code><code class="cpp string">"/proc/%d/maps"</code><code class="cpp plain">,&nbsp;pid&nbsp;==&nbsp;-1&nbsp;?&nbsp;_pid&nbsp;:&nbsp;pid);</code></div><div class="line number96 index95 alt1">&nbsp;</div><div class="line number97 index96 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">fp&nbsp;=&nbsp;</code><code class="cpp functions bold">fopen</code><code class="cpp plain">(filename,&nbsp;</code><code class="cpp string">"rt"</code><code class="cpp plain">);</code></div><div class="line number98 index97 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(fp&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number99 index98 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"findLibrary&nbsp;fopen&nbsp;error&nbsp;%s&nbsp;%s&nbsp;"</code><code class="cpp plain">,library,filename);</code></div><div class="line number100 index99 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">goto</code>&nbsp;<code class="cpp plain">done;</code></div><div class="line number101 index100 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number102 index101 alt1">&nbsp;</div><div class="line number103 index102 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code>&nbsp;<code class="cpp plain">(</code><code class="cpp functions bold">fgets</code><code class="cpp plain">(buffer,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(buffer),&nbsp;fp))&nbsp;{</code></div><div class="line number104 index103 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(</code><code class="cpp functions bold">strstr</code><code class="cpp plain">(buffer,&nbsp;library))&nbsp;{</code></div><div class="line number105 index104 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">address&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;</code><code class="cpp functions bold">strtoul</code><code class="cpp plain">(buffer,&nbsp;NULL,&nbsp;16);</code></div><div class="line number106 index105 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">isFind&nbsp;=&nbsp;</code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number107 index106 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">goto</code>&nbsp;<code class="cpp plain">done;</code></div><div class="line number108 index107 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code><code class="cpp plain">{</code></div><div class="line number109 index108 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG("printf&nbsp;map&nbsp;item&nbsp;%s&nbsp;",buffer);</code></div><div class="line number110 index109 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number111 index110 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number112 index111 alt1">&nbsp;</div><div class="line number113 index112 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">done:</code></div><div class="line number114 index113 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;if(!isFind){</code></div><div class="line number115 index114 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INJECTLOG("findLibrary&nbsp;not&nbsp;find&nbsp;[%s]&nbsp;in&nbsp;%s&nbsp;",library,filename);</code></div><div class="line number116 index115 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;}</code></div><div class="line number117 index116 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(fp)&nbsp;{</code></div><div class="line number118 index117 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">fclose</code><code class="cpp plain">(fp);</code></div><div class="line number119 index118 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number120 index119 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;if(address&nbsp;==&nbsp;0){</code></div><div class="line number121 index120 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INJECTLOG("findLibrary&nbsp;[%s]&nbsp;return&nbsp;0&nbsp;,not&nbsp;find&nbsp;addr&nbsp;",library);</code></div><div class="line number122 index121 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;}</code></div><div class="line number123 index122 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">address;</code></div><div class="line number124 index123 alt1"><code class="cpp plain">}</code></div><div class="line number125 index124 alt2">&nbsp;</div><div class="line number126 index125 alt1"><code class="cpp comments">/*</code></div><div class="line number127 index126 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Compute&nbsp;the&nbsp;delta&nbsp;of&nbsp;the&nbsp;local&nbsp;and&nbsp;the&nbsp;remote&nbsp;modules&nbsp;and&nbsp;apply&nbsp;it&nbsp;to&nbsp;the&nbsp;local&nbsp;address&nbsp;of&nbsp;the&nbsp;symbol&nbsp;...</code></div><div class="line number128 index127 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;计算本地和远程模块的增量，并将其应用于符号的本地地址。。。</code></div><div class="line number129 index128 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;BOOM,&nbsp;remote&nbsp;symbol&nbsp;address!</code></div><div class="line number130 index129 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;BOOM，远程符号地址！</code></div><div class="line number131 index130 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number132 index131 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;remote_findFunction(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;library,&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;local_addr)&nbsp;{</code></div><div class="line number133 index132 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(local_addr&nbsp;==&nbsp;nullptr){</code></div><div class="line number134 index133 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;%s&nbsp;location&nbsp;base&nbsp;%p"</code><code class="cpp plain">,library,(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)local_addr);</code></div><div class="line number135 index134 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number136 index135 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number137 index136 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_handle&nbsp;=&nbsp;findLibrary(&nbsp;library,&nbsp;-1&nbsp;);</code></div><div class="line number138 index137 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(remote_handle&nbsp;==&nbsp;0){</code></div><div class="line number139 index138 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;%s&nbsp;remote&nbsp;base&nbsp;==&nbsp;0&nbsp;"</code><code class="cpp plain">,library);</code></div><div class="line number140 index139 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number141 index140 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number142 index141 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">local_handle&nbsp;=&nbsp;findLibrary(&nbsp;library,&nbsp;getpid()&nbsp;);</code></div><div class="line number143 index142 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(local_handle&nbsp;==&nbsp;0){</code></div><div class="line number144 index143 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG("remote_findFunction&nbsp;local_handle&nbsp;==&nbsp;0&nbsp;%s&nbsp;loc&nbsp;&nbsp;%p&nbsp;&nbsp;%d&nbsp;%s&nbsp;",library,local_addr,getpid(),getprogname());</code></div><div class="line number145 index144 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Dl_info&nbsp;info;</code></div><div class="line number146 index145 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(dladdr(local_addr,&amp;info)){</code></div><div class="line number147 index146 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">local_handle&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)info.dli_fbase;</code></div><div class="line number148 index147 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code><code class="cpp plain">{</code></div><div class="line number149 index148 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;local_handle&nbsp;backup&nbsp;==&nbsp;0&nbsp;&nbsp;"</code><code class="cpp plain">);</code></div><div class="line number150 index149 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number151 index150 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number152 index151 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number153 index152 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">offset&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;local_addr&nbsp;-&nbsp;local_handle;</code></div><div class="line number154 index153 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_addr&nbsp;=&nbsp;remote_handle&nbsp;+&nbsp;offset;</code></div><div class="line number155 index154 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)remote_addr;</code></div><div class="line number156 index155 alt1"><code class="cpp plain">}</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp plain">uint64_t&nbsp;ms()&nbsp;{</code></div><div class="line number159 index158 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">timespec&nbsp;spec;</code></div><div class="line number160 index159 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">clock_gettime(CLOCK_MONOTONIC,&nbsp;&amp;spec);</code></div><div class="line number161 index160 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">(spec.tv_sec&nbsp;*&nbsp;1000)&nbsp;+&nbsp;(spec.tv_nsec&nbsp;/&nbsp;1.0e6);</code></div><div class="line number162 index161 alt1"><code class="cpp plain">}</code></div><div class="line number163 index162 alt2">&nbsp;</div><div class="line number164 index163 alt1"><code class="cpp comments">/*</code></div><div class="line number165 index164 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Make&nbsp;sure&nbsp;the&nbsp;remote&nbsp;process&nbsp;is&nbsp;stopped,&nbsp;or&nbsp;we&nbsp;get&nbsp;ESRCH&nbsp;errors</code></div><div class="line number166 index165 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number167 index166 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">remote_stop()&nbsp;{</code></div><div class="line number168 index167 alt1"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;INJECTLOG(&nbsp;"remote_stop"&nbsp;);</code></div><div class="line number169 index168 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">kill(&nbsp;_pid,&nbsp;SIGSTOP&nbsp;);</code></div><div class="line number170 index169 alt1">&nbsp;</div><div class="line number171 index170 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">status;</code></div><div class="line number172 index171 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">ret;</code></div><div class="line number173 index172 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">uint64_t&nbsp;start&nbsp;=&nbsp;ms();</code></div><div class="line number174 index173 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code>&nbsp;<code class="cpp plain">(&nbsp;(ret&nbsp;=&nbsp;waitpid(&nbsp;_pid,&nbsp;&amp;status,&nbsp;WUNTRACED&nbsp;||&nbsp;WNOHANG&nbsp;))&nbsp;!=&nbsp;-1&nbsp;)&nbsp;{</code></div><div class="line number175 index174 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret&nbsp;==&nbsp;_pid)&nbsp;{</code></div><div class="line number176 index175 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(WIFSIGNALED(status))&nbsp;{</code></div><div class="line number177 index176 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace&nbsp;(&nbsp;</code><code class="cpp string">"remote_stop"</code><code class="cpp plain">,&nbsp;PTRACE_CONT,&nbsp;NULL,&nbsp;WTERMSIG(status));</code></div><div class="line number178 index177 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(WIFSTOPPED(status))&nbsp;{</code></div><div class="line number179 index178 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number180 index179 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(WIFEXITED(status))&nbsp;{</code></div><div class="line number181 index180 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number182 index181 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number183 index182 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ms()&nbsp;-&nbsp;start&nbsp;&gt;&nbsp;128)&nbsp;{</code></div><div class="line number184 index183 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;assume&nbsp;stopped&nbsp;before&nbsp;remote_stop()&nbsp;was&nbsp;called,&nbsp;128ms&nbsp;is&nbsp;long</code></div><div class="line number185 index184 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number186 index185 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number187 index186 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">usleep(1);</code></div><div class="line number188 index187 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number189 index188 alt2"><code class="cpp comments">//&nbsp;&nbsp;&nbsp;&nbsp;INJECTLOG(&nbsp;"/remote_stop"&nbsp;);</code></div><div class="line number190 index189 alt1"><code class="cpp plain">}</code></div><div class="line number191 index190 alt2">&nbsp;</div><div class="line number192 index191 alt1"><code class="cpp comments">/*</code></div><div class="line number193 index192 alt2"><code class="cpp comments">*&nbsp;Read&nbsp;'blen'&nbsp;bytes&nbsp;from&nbsp;the&nbsp;remote&nbsp;process&nbsp;at&nbsp;'addr'&nbsp;address.</code></div><div class="line number194 index193 alt1"><code class="cpp comments">*/</code></div><div class="line number195 index194 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">remote_read(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;debug,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">addr,&nbsp;unsigned&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*buf,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">blen){</code></div><div class="line number196 index195 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop();</code></div><div class="line number197 index196 alt2">&nbsp;</div><div class="line number198 index197 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;</code></div><div class="line number199 index198 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">ret&nbsp;=&nbsp;0;</code></div><div class="line number200 index199 alt1">&nbsp;</div><div class="line number201 index200 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;blen;&nbsp;i&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)&nbsp;){</code></div><div class="line number202 index201 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ret&nbsp;=&nbsp;trace(&nbsp;debug,&nbsp;PTRACE_PEEKTEXT,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)(addr&nbsp;+&nbsp;i)&nbsp;);</code></div><div class="line number203 index202 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(&nbsp;ret&nbsp;==&nbsp;-1&nbsp;)&nbsp;{</code></div><div class="line number204 index203 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number205 index204 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number206 index205 alt1">&nbsp;</div><div class="line number207 index206 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memcpy</code><code class="cpp plain">(&nbsp;&amp;buf[i],&nbsp;&amp;ret,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(ret)&nbsp;);</code></div><div class="line number208 index207 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number209 index208 alt2">&nbsp;</div><div class="line number210 index209 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number211 index210 alt2"><code class="cpp plain">}</code></div><div class="line number212 index211 alt1">&nbsp;</div><div class="line number213 index212 alt2"><code class="cpp comments">/*</code></div><div class="line number214 index213 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Write&nbsp;'blen'&nbsp;bytes&nbsp;to&nbsp;the&nbsp;remote&nbsp;process&nbsp;at&nbsp;'addr'&nbsp;address.</code></div><div class="line number215 index214 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number216 index215 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">bool</code>&nbsp;<code class="cpp plain">remote_write(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;debug,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">addr,&nbsp;unsigned&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*buf,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">blen)&nbsp;{</code></div><div class="line number217 index216 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop();</code></div><div class="line number218 index217 alt1">&nbsp;</div><div class="line number219 index218 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;</code></div><div class="line number220 index219 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">long</code>&nbsp;<code class="cpp plain">ret;</code></div><div class="line number221 index220 alt2">&nbsp;</div><div class="line number222 index221 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;make&nbsp;sure&nbsp;the&nbsp;buffer&nbsp;is&nbsp;word&nbsp;aligned</code></div><div class="line number223 index222 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*ptr&nbsp;=&nbsp;(</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*)&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(blen&nbsp;+&nbsp;blen&nbsp;%&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">));</code></div><div class="line number224 index223 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memcpy</code><code class="cpp plain">(ptr,&nbsp;buf,&nbsp;blen);</code></div><div class="line number225 index224 alt2">&nbsp;</div><div class="line number226 index225 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;blen;&nbsp;i&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">))&nbsp;{</code></div><div class="line number227 index226 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ret&nbsp;=&nbsp;trace(&nbsp;debug,&nbsp;PTRACE_POKETEXT,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;(addr&nbsp;+&nbsp;i),&nbsp;*(</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">*)&nbsp;&amp;ptr[i]&nbsp;);</code></div><div class="line number228 index227 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret&nbsp;==&nbsp;-1)&nbsp;{</code></div><div class="line number229 index228 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">free</code><code class="cpp plain">(ptr);</code></div><div class="line number230 index229 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number231 index230 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number232 index231 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number233 index232 alt2">&nbsp;</div><div class="line number234 index233 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">free</code><code class="cpp plain">(ptr);</code></div><div class="line number235 index234 alt2">&nbsp;</div><div class="line number236 index235 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number237 index236 alt2"><code class="cpp plain">}</code></div><div class="line number238 index237 alt1">&nbsp;</div><div class="line number239 index238 alt2"><code class="cpp comments">//&nbsp;Get&nbsp;remote&nbsp;registers</code></div><div class="line number240 index239 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">trace_getregs(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;debug,&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">pt_regs&nbsp;*&nbsp;regs)&nbsp;{</code></div><div class="line number241 index240 alt2"><code class="cpp preprocessor">#if&nbsp;defined&nbsp;(__aarch64__)&nbsp;||&nbsp;defined(__x86_64__)</code></div><div class="line number242 index241 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">regset&nbsp;=&nbsp;NT_PRSTATUS;</code></div><div class="line number243 index242 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">iovec&nbsp;ioVec;</code></div><div class="line number244 index243 alt1">&nbsp;</div><div class="line number245 index244 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ioVec.iov_base&nbsp;=&nbsp;regs;</code></div><div class="line number246 index245 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ioVec.iov_len&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(*regs);</code></div><div class="line number247 index246 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;debug,&nbsp;PTRACE_GETREGSET,&nbsp;(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)regset,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)&amp;ioVec&nbsp;);</code></div><div class="line number248 index247 alt1"><code class="cpp preprocessor">#else</code></div><div class="line number249 index248 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;debug,&nbsp;PTRACE_GETREGS,&nbsp;0,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)regs&nbsp;);</code></div><div class="line number250 index249 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number251 index250 alt2"><code class="cpp plain">}</code></div><div class="line number252 index251 alt1">&nbsp;</div><div class="line number253 index252 alt2"><code class="cpp comments">//&nbsp;Set&nbsp;remote&nbsp;registers</code></div><div class="line number254 index253 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">trace_setregs(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;debug,&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">pt_regs&nbsp;*&nbsp;regs)&nbsp;{</code></div><div class="line number255 index254 alt2"><code class="cpp preprocessor">#if&nbsp;defined&nbsp;(__aarch64__)&nbsp;||&nbsp;defined(__x86_64__)</code></div><div class="line number256 index255 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">regset&nbsp;=&nbsp;NT_PRSTATUS;</code></div><div class="line number257 index256 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">iovec&nbsp;ioVec;</code></div><div class="line number258 index257 alt1">&nbsp;</div><div class="line number259 index258 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ioVec.iov_base&nbsp;=&nbsp;regs;</code></div><div class="line number260 index259 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ioVec.iov_len&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(*regs);</code></div><div class="line number261 index260 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;debug,&nbsp;PTRACE_SETREGSET,&nbsp;(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)regset,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)&amp;ioVec&nbsp;);</code></div><div class="line number262 index261 alt1"><code class="cpp preprocessor">#else</code></div><div class="line number263 index262 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;debug,&nbsp;PTRACE_SETREGS,&nbsp;0,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)regs&nbsp;);</code></div><div class="line number264 index263 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number265 index264 alt2"><code class="cpp plain">}</code></div><div class="line number266 index265 alt1">&nbsp;</div><div class="line number267 index266 alt2"><code class="cpp comments">/*</code></div><div class="line number268 index267 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Remotely&nbsp;call&nbsp;the&nbsp;remote&nbsp;function&nbsp;given&nbsp;its&nbsp;address,&nbsp;the&nbsp;number&nbsp;of</code></div><div class="line number269 index268 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;arguments&nbsp;and&nbsp;the&nbsp;arguments&nbsp;themselves.</code></div><div class="line number270 index269 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;给定远程函数的地址、参数数量和参数本身，远程调用该函数。</code></div><div class="line number271 index270 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number272 index271 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_call(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*function,&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">nargs,&nbsp;...)&nbsp;{</code></div><div class="line number273 index272 alt2"><code class="cpp preprocessor">#if&nbsp;defined(__arm__)&nbsp;||&nbsp;defined(__aarch64__)&nbsp;||&nbsp;defined(__i386__)&nbsp;||&nbsp;defined(__x86_64__)</code></div><div class="line number274 index273 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//暂停目标进程</code></div><div class="line number275 index274 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop();</code></div><div class="line number276 index275 alt1">&nbsp;</div><div class="line number277 index276 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">pt_regs&nbsp;regs,&nbsp;rbackup;</code></div><div class="line number278 index277 alt1">&nbsp;</div><div class="line number279 index278 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;get&nbsp;registers&nbsp;and&nbsp;backup&nbsp;them</code></div><div class="line number280 index279 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace_getregs(&nbsp;</code><code class="cpp string">"backup"</code><code class="cpp plain">,&nbsp;&amp;regs&nbsp;);</code></div><div class="line number281 index280 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;备份原始寄存器</code></div><div class="line number282 index281 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memcpy</code><code class="cpp plain">(&nbsp;&amp;rbackup,&nbsp;&amp;regs,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">pt_regs)&nbsp;);</code></div><div class="line number283 index282 alt2">&nbsp;</div><div class="line number284 index283 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;start&nbsp;copying&nbsp;parameters</code></div><div class="line number285 index284 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">va_list</code>&nbsp;<code class="cpp plain">vl;</code></div><div class="line number286 index285 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">va_start</code><code class="cpp plain">(vl,nargs);</code></div><div class="line number287 index286 alt2">&nbsp;</div><div class="line number288 index287 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;push&nbsp;parameters&nbsp;into&nbsp;registers&nbsp;and&nbsp;stacks,&nbsp;setup&nbsp;registers&nbsp;to&nbsp;perform&nbsp;the&nbsp;call</code></div><div class="line number289 index288 alt2">&nbsp;</div><div class="line number290 index289 alt1"><code class="cpp preprocessor">#if&nbsp;defined(__arm__)&nbsp;||&nbsp;defined(__aarch64__)</code></div><div class="line number291 index290 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;fill&nbsp;R0-Rx&nbsp;with&nbsp;the&nbsp;first&nbsp;4&nbsp;(32-bit)&nbsp;or&nbsp;8&nbsp;(64-bit)&nbsp;parameters</code></div><div class="line number292 index291 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;用前4个（32位）或8个（64位）参数填充R0&nbsp;Rx</code></div><div class="line number293 index292 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;arm里面寄存器是R0开始</code></div><div class="line number294 index293 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;nargs&nbsp;)&nbsp;&amp;&amp;&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;PARAMS_IN_REGS&nbsp;);&nbsp;++i&nbsp;)&nbsp;{</code></div><div class="line number295 index294 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.uregs[i]&nbsp;=&nbsp;</code><code class="cpp functions bold">va_arg</code><code class="cpp plain">(&nbsp;vl,&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number296 index295 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number297 index296 alt2">&nbsp;</div><div class="line number298 index297 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;push&nbsp;remaining&nbsp;parameters&nbsp;onto&nbsp;stack</code></div><div class="line number299 index298 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(nargs&nbsp;&gt;&nbsp;PARAMS_IN_REGS)&nbsp;{</code></div><div class="line number300 index299 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_sp&nbsp;-=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;*&nbsp;(nargs&nbsp;-&nbsp;PARAMS_IN_REGS);</code></div><div class="line number301 index300 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">stack&nbsp;=&nbsp;regs.ARM_sp;</code></div><div class="line number302 index301 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;PARAMS_IN_REGS;&nbsp;i&nbsp;&lt;&nbsp;nargs;&nbsp;++i&nbsp;)&nbsp;{</code></div><div class="line number303 index302 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">arg&nbsp;=&nbsp;</code><code class="cpp functions bold">va_arg</code><code class="cpp plain">(&nbsp;vl,&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number304 index303 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"params"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)stack,&nbsp;(uint8_t&nbsp;*)&amp;arg,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;);</code></div><div class="line number305 index304 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stack&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number306 index305 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number307 index306 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number308 index307 alt1">&nbsp;</div><div class="line number309 index308 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;return&nbsp;address&nbsp;to&nbsp;catch</code></div><div class="line number310 index309 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_lr&nbsp;=&nbsp;0;</code></div><div class="line number311 index310 alt2">&nbsp;</div><div class="line number312 index311 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;function&nbsp;address&nbsp;to&nbsp;call</code></div><div class="line number313 index312 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_pc&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)function;</code></div><div class="line number314 index313 alt1">&nbsp;</div><div class="line number315 index314 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;setup&nbsp;the&nbsp;current&nbsp;processor&nbsp;status&nbsp;register</code></div><div class="line number316 index315 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;设置当前处理器状态寄存器</code></div><div class="line number317 index316 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(&nbsp;regs.ARM_pc&nbsp;&amp;&nbsp;1&nbsp;)&nbsp;{</code></div><div class="line number318 index317 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;thumb</code></div><div class="line number319 index318 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_pc&nbsp;&amp;=&nbsp;(~1u);</code></div><div class="line number320 index319 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_cpsr&nbsp;|=&nbsp;CPSR_T_MASK;</code></div><div class="line number321 index320 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number322 index321 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;arm</code></div><div class="line number323 index322 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.ARM_cpsr&nbsp;&amp;=&nbsp;~CPSR_T_MASK;</code></div><div class="line number324 index323 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number325 index324 alt2"><code class="cpp preprocessor">#elif&nbsp;defined(__i386__)</code></div><div class="line number326 index325 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;push&nbsp;all&nbsp;params&nbsp;onto&nbsp;stack</code></div><div class="line number327 index326 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.esp&nbsp;-=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;*&nbsp;nargs;</code></div><div class="line number328 index327 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">stack&nbsp;=&nbsp;regs.esp;</code></div><div class="line number329 index328 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;nargs;&nbsp;++i&nbsp;)&nbsp;{</code></div><div class="line number330 index329 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">arg&nbsp;=&nbsp;</code><code class="cpp functions bold">va_arg</code><code class="cpp plain">(&nbsp;vl,&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number331 index330 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"params"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)stack,&nbsp;(uint8_t&nbsp;*)&amp;arg,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;);</code></div><div class="line number332 index331 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stack&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number333 index332 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number334 index333 alt1">&nbsp;</div><div class="line number335 index334 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;return&nbsp;address&nbsp;to&nbsp;catch</code></div><div class="line number336 index335 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">tmp_addr&nbsp;=&nbsp;0;</code></div><div class="line number337 index336 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.esp&nbsp;-=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number338 index337 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"return"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)regs.esp,&nbsp;(uint8_t&nbsp;*)&amp;tmp_addr,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;);</code></div><div class="line number339 index338 alt2">&nbsp;</div><div class="line number340 index339 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;function&nbsp;address&nbsp;to&nbsp;call</code></div><div class="line number341 index340 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.eip&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)function;</code></div><div class="line number342 index341 alt1"><code class="cpp preprocessor">#elif&nbsp;defined(__x86_64__)</code></div><div class="line number343 index342 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;align,&nbsp;rsp&nbsp;-&nbsp;8&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;16&nbsp;at&nbsp;function&nbsp;entry&nbsp;point</code></div><div class="line number344 index343 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number345 index344 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">space&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number346 index345 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(nargs&nbsp;&gt;&nbsp;6)&nbsp;space&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;*&nbsp;(nargs&nbsp;-&nbsp;6);</code></div><div class="line number347 index346 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code>&nbsp;<code class="cpp plain">(((regs.rsp&nbsp;-&nbsp;space&nbsp;-&nbsp;8)&nbsp;&amp;&nbsp;0xF)&nbsp;!=&nbsp;0)&nbsp;regs.rsp--;</code></div><div class="line number348 index347 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number349 index348 alt2">&nbsp;</div><div class="line number350 index349 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;fill&nbsp;[RDI,&nbsp;RSI,&nbsp;RDX,&nbsp;RCX,&nbsp;R8,&nbsp;R9]&nbsp;with&nbsp;the&nbsp;first&nbsp;6&nbsp;parameters</code></div><div class="line number351 index350 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;0;&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;nargs&nbsp;)&nbsp;&amp;&amp;&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;6&nbsp;);&nbsp;++i&nbsp;)&nbsp;{</code></div><div class="line number352 index351 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">arg&nbsp;=&nbsp;</code><code class="cpp functions bold">va_arg</code><code class="cpp plain">(&nbsp;vl,&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number353 index352 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code>&nbsp;<code class="cpp plain">(i)&nbsp;{</code></div><div class="line number354 index353 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">0:&nbsp;regs.rdi&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number355 index354 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">1:&nbsp;regs.rsi&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number356 index355 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">2:&nbsp;regs.rdx&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number357 index356 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">3:&nbsp;regs.rcx&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number358 index357 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">4:&nbsp;regs.r8&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number359 index358 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">5:&nbsp;regs.r9&nbsp;=&nbsp;arg;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number360 index359 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number361 index360 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number362 index361 alt1">&nbsp;</div><div class="line number363 index362 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;push&nbsp;remaining&nbsp;parameters&nbsp;onto&nbsp;stack</code></div><div class="line number364 index363 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(nargs&nbsp;&gt;&nbsp;6)&nbsp;{</code></div><div class="line number365 index364 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.rsp&nbsp;-=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;*&nbsp;(nargs&nbsp;-&nbsp;6);</code></div><div class="line number366 index365 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">stack&nbsp;=&nbsp;regs.rsp;</code></div><div class="line number367 index366 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i&nbsp;=&nbsp;6;&nbsp;i&nbsp;&lt;&nbsp;nargs;&nbsp;++i&nbsp;)&nbsp;{</code></div><div class="line number368 index367 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">arg&nbsp;=&nbsp;</code><code class="cpp functions bold">va_arg</code><code class="cpp plain">(&nbsp;vl,&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number369 index368 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"params"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)stack,&nbsp;(uint8_t&nbsp;*)&amp;arg,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;);</code></div><div class="line number370 index369 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">stack&nbsp;+=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number371 index370 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number372 index371 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number373 index372 alt2">&nbsp;</div><div class="line number374 index373 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;return&nbsp;address&nbsp;to&nbsp;catch</code></div><div class="line number375 index374 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">tmp_addr&nbsp;=&nbsp;0;</code></div><div class="line number376 index375 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.rsp&nbsp;-=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">);</code></div><div class="line number377 index376 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"return"</code><code class="cpp plain">,&nbsp;(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)regs.rsp,&nbsp;(uint8_t&nbsp;*)&amp;tmp_addr,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;);</code></div><div class="line number378 index377 alt1">&nbsp;</div><div class="line number379 index378 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;function&nbsp;address&nbsp;to&nbsp;call</code></div><div class="line number380 index379 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.rip&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)function;</code></div><div class="line number381 index380 alt2">&nbsp;</div><div class="line number382 index381 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;may&nbsp;be&nbsp;needed</code></div><div class="line number383 index382 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.rax&nbsp;=&nbsp;0;</code></div><div class="line number384 index383 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">regs.orig_rax&nbsp;=&nbsp;0;</code></div><div class="line number385 index384 alt2"><code class="cpp preprocessor">#endif</code></div><div class="line number386 index385 alt1">&nbsp;</div><div class="line number387 index386 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;end&nbsp;of&nbsp;parameters</code></div><div class="line number388 index387 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">va_end</code><code class="cpp plain">(vl);</code></div><div class="line number389 index388 alt2">&nbsp;</div><div class="line number390 index389 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;do&nbsp;the&nbsp;call</code></div><div class="line number391 index390 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace_setregs(&nbsp;</code><code class="cpp string">"call"</code><code class="cpp plain">,&nbsp;&amp;regs&nbsp;);</code></div><div class="line number392 index391 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;</code><code class="cpp string">"call"</code><code class="cpp plain">,&nbsp;PTRACE_CONT&nbsp;);</code></div><div class="line number393 index392 alt2">&nbsp;</div><div class="line number394 index393 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;catch&nbsp;the&nbsp;SIGSEGV&nbsp;caused&nbsp;by&nbsp;the&nbsp;0&nbsp;return&nbsp;address</code></div><div class="line number395 index394 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;捕获由0返回地址引起的SIGSEGV</code></div><div class="line number396 index395 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">status;</code></div><div class="line number397 index396 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code>&nbsp;<code class="cpp plain">(&nbsp;waitpid(&nbsp;_pid,&nbsp;&amp;status,&nbsp;WUNTRACED&nbsp;)&nbsp;==&nbsp;_pid&nbsp;)&nbsp;{</code></div><div class="line number398 index397 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(&nbsp;WIFSTOPPED(status)&nbsp;&amp;&amp;&nbsp;(WSTOPSIG(status)&nbsp;==&nbsp;SIGSEGV)&nbsp;)&nbsp;{</code></div><div class="line number399 index398 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number400 index399 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number401 index400 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;</code><code class="cpp string">"waitpid"</code><code class="cpp plain">,&nbsp;PTRACE_CONT&nbsp;);</code></div><div class="line number402 index401 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number403 index402 alt2">&nbsp;</div><div class="line number404 index403 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;get&nbsp;registers&nbsp;again&nbsp;for&nbsp;return&nbsp;value</code></div><div class="line number405 index404 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;再次获取返回值的寄存器</code></div><div class="line number406 index405 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace_getregs(&nbsp;</code><code class="cpp string">"return"</code><code class="cpp plain">,&nbsp;&amp;regs&nbsp;);</code></div><div class="line number407 index406 alt2">&nbsp;</div><div class="line number408 index407 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;restore&nbsp;original&nbsp;registers&nbsp;state</code></div><div class="line number409 index408 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;恢复原始寄存器状态</code></div><div class="line number410 index409 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace_setregs(&nbsp;</code><code class="cpp string">"restore"</code><code class="cpp plain">,&nbsp;&amp;rbackup&nbsp;);</code></div><div class="line number411 index410 alt2">&nbsp;</div><div class="line number412 index411 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;continue&nbsp;execution</code></div><div class="line number413 index412 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;继续执行</code></div><div class="line number414 index413 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;</code><code class="cpp string">"continue"</code><code class="cpp plain">,&nbsp;PTRACE_CONT&nbsp;);</code></div><div class="line number415 index414 alt2">&nbsp;</div><div class="line number416 index415 alt1"><code class="cpp preprocessor">#if&nbsp;defined(__arm__)&nbsp;||&nbsp;defined(__aarch64__)</code></div><div class="line number417 index416 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">regs.ARM_r0;</code></div><div class="line number418 index417 alt1"><code class="cpp preprocessor">#elif&nbsp;defined(__i386__)</code></div><div class="line number419 index418 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">regs.eax;</code></div><div class="line number420 index419 alt1"><code class="cpp preprocessor">#elif&nbsp;defined(__x86_64__)</code></div><div class="line number421 index420 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">regs.rax;</code></div><div class="line number422 index421 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number423 index422 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number424 index423 alt1"><code class="cpp preprocessor">#else</code></div><div class="line number425 index424 alt2"><code class="cpp preprocessor">#error&nbsp;ARCHITECTURE&nbsp;NOT&nbsp;SUPPORTED</code></div><div class="line number426 index425 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number427 index426 alt2"><code class="cpp plain">}</code></div><div class="line number428 index427 alt1">&nbsp;</div><div class="line number429 index428 alt2"><code class="cpp comments">//&nbsp;Allocate&nbsp;memory&nbsp;in&nbsp;remote&nbsp;process</code></div><div class="line number430 index429 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_calloc(</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">nmemb,&nbsp;</code><code class="cpp color1 bold">size_t</code>&nbsp;<code class="cpp plain">size)&nbsp;{</code></div><div class="line number431 index430 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">remote_call(_calloc,&nbsp;2,&nbsp;nmemb,&nbsp;size);</code></div><div class="line number432 index431 alt1"><code class="cpp plain">}</code></div><div class="line number433 index432 alt2">&nbsp;</div><div class="line number434 index433 alt1"><code class="cpp comments">//&nbsp;Free&nbsp;remotely&nbsp;allocated&nbsp;memory.</code></div><div class="line number435 index434 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">remote_free(</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">p)&nbsp;{</code></div><div class="line number436 index435 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_call(_free,&nbsp;1,&nbsp;p);</code></div><div class="line number437 index436 alt2"><code class="cpp plain">}</code></div><div class="line number438 index437 alt1">&nbsp;</div><div class="line number439 index438 alt2"><code class="cpp comments">//&nbsp;Copy&nbsp;a&nbsp;given&nbsp;string&nbsp;into&nbsp;the&nbsp;remote&nbsp;process&nbsp;memory.</code></div><div class="line number440 index439 alt1"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_string(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*s)&nbsp;{</code></div><div class="line number441 index440 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">mem&nbsp;=&nbsp;remote_calloc(</code><code class="cpp functions bold">strlen</code><code class="cpp plain">(s)&nbsp;+&nbsp;1,&nbsp;1);</code></div><div class="line number442 index441 alt1">&nbsp;</div><div class="line number443 index442 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_write(&nbsp;</code><code class="cpp string">"string"</code><code class="cpp plain">,&nbsp;mem,&nbsp;(unsigned&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*)&nbsp;s,&nbsp;</code><code class="cpp functions bold">strlen</code><code class="cpp plain">(s)&nbsp;+&nbsp;1);</code></div><div class="line number444 index443 alt1">&nbsp;</div><div class="line number445 index444 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">mem;</code></div><div class="line number446 index445 alt1"><code class="cpp plain">}</code></div><div class="line number447 index446 alt2">&nbsp;</div><div class="line number448 index447 alt1"><code class="cpp comments">//&nbsp;Remotely&nbsp;force&nbsp;the&nbsp;target&nbsp;process&nbsp;to&nbsp;dlopen&nbsp;a&nbsp;library.</code></div><div class="line number449 index448 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_dlopen(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*libname)&nbsp;{</code></div><div class="line number450 index449 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">pmem&nbsp;=&nbsp;remote_string(libname);</code></div><div class="line number451 index450 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">plib&nbsp;=&nbsp;remote_call(_dlopen,&nbsp;2,&nbsp;pmem,&nbsp;2);</code></div><div class="line number452 index451 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_free(pmem);</code></div><div class="line number453 index452 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">plib;</code></div><div class="line number454 index453 alt1"><code class="cpp plain">}</code></div><div class="line number455 index454 alt2">&nbsp;</div><div class="line number456 index455 alt1"><code class="cpp comments">//&nbsp;Get&nbsp;remote&nbsp;dlerror</code></div><div class="line number457 index456 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">remote_dlerror(</code><code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;error,&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">size)&nbsp;{</code></div><div class="line number458 index457 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">e&nbsp;=&nbsp;remote_call(_dlerror,&nbsp;0);</code></div><div class="line number459 index458 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_read(</code><code class="cpp string">"dlerror"</code><code class="cpp plain">,&nbsp;e,&nbsp;(unsigned&nbsp;</code><code class="cpp color1 bold">char</code><code class="cpp plain">*)error,&nbsp;size&nbsp;-&nbsp;1);</code></div><div class="line number460 index459 alt1"><code class="cpp plain">}</code></div><div class="line number461 index460 alt2">&nbsp;</div><div class="line number462 index461 alt1"><code class="cpp comments">//&nbsp;Find&nbsp;pid&nbsp;for&nbsp;process</code></div><div class="line number463 index462 alt2"><code class="cpp plain">pid_t&nbsp;find_pid_of(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;process)&nbsp;{</code></div><div class="line number464 index463 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">id;</code></div><div class="line number465 index464 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pid_t&nbsp;pid&nbsp;=&nbsp;-1;</code></div><div class="line number466 index465 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DIR*&nbsp;dir;</code></div><div class="line number467 index466 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">FILE</code>&nbsp;<code class="cpp plain">*fp;</code></div><div class="line number468 index467 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">filename[32];</code></div><div class="line number469 index468 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">cmdline[256];</code></div><div class="line number470 index469 alt1">&nbsp;</div><div class="line number471 index470 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">dirent&nbsp;*&nbsp;entry;</code></div><div class="line number472 index471 alt1">&nbsp;</div><div class="line number473 index472 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(process&nbsp;==&nbsp;NULL)</code></div><div class="line number474 index473 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-1;</code></div><div class="line number475 index474 alt2">&nbsp;</div><div class="line number476 index475 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dir&nbsp;=&nbsp;opendir(</code><code class="cpp string">"/proc"</code><code class="cpp plain">);</code></div><div class="line number477 index476 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(dir&nbsp;==&nbsp;NULL)</code></div><div class="line number478 index477 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-1;</code></div><div class="line number479 index478 alt2">&nbsp;</div><div class="line number480 index479 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code>&nbsp;<code class="cpp plain">((entry&nbsp;=&nbsp;readdir(dir))&nbsp;!=&nbsp;NULL)&nbsp;{</code></div><div class="line number481 index480 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">id&nbsp;=&nbsp;</code><code class="cpp functions bold">atoi</code><code class="cpp plain">(entry-&gt;d_name);</code></div><div class="line number482 index481 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(id&nbsp;!=&nbsp;0)&nbsp;{</code></div><div class="line number483 index482 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">sprintf</code><code class="cpp plain">(filename,&nbsp;</code><code class="cpp string">"/proc/%d/cmdline"</code><code class="cpp plain">,&nbsp;id);</code></div><div class="line number484 index483 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">fp&nbsp;=&nbsp;</code><code class="cpp functions bold">fopen</code><code class="cpp plain">(filename,&nbsp;</code><code class="cpp string">"r"</code><code class="cpp plain">);</code></div><div class="line number485 index484 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(fp)&nbsp;{</code></div><div class="line number486 index485 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">fgets</code><code class="cpp plain">(cmdline,&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(cmdline),&nbsp;fp);</code></div><div class="line number487 index486 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">fclose</code><code class="cpp plain">(fp);</code></div><div class="line number488 index487 alt1">&nbsp;</div><div class="line number489 index488 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(</code><code class="cpp functions bold">strcmp</code><code class="cpp plain">(process,&nbsp;cmdline)&nbsp;==&nbsp;0)&nbsp;{</code></div><div class="line number490 index489 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;process&nbsp;found&nbsp;*/</code></div><div class="line number491 index490 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//if(id&nbsp;&gt;&nbsp;pid){</code></div><div class="line number492 index491 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">////相同进程名时,&nbsp;使用进程ID最大的进程(最近启动的进程),&nbsp;避免在VMOS里查找到主机的进程</code></div><div class="line number493 index492 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;&nbsp;pid&nbsp;=&nbsp;id;</code></div><div class="line number494 index493 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//}</code></div><div class="line number495 index494 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pid&nbsp;=&nbsp;id;</code></div><div class="line number496 index495 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number497 index496 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number498 index497 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number499 index498 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number500 index499 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number501 index500 alt2">&nbsp;</div><div class="line number502 index501 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">closedir(dir);</code></div><div class="line number503 index502 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">pid;</code></div><div class="line number504 index503 alt1"><code class="cpp plain">}</code></div><div class="line number505 index504 alt2">&nbsp;</div><div class="line number506 index505 alt1">&nbsp;</div><div class="line number507 index506 alt2"><code class="cpp comments">//作用为解除zygote进程的阻塞状态</code></div><div class="line number508 index507 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*&nbsp;connect_to_zygote(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*arg)&nbsp;{</code></div><div class="line number509 index508 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">s,&nbsp;len;</code></div><div class="line number510 index509 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">sockaddr_un&nbsp;remote;</code></div><div class="line number511 index510 alt2">&nbsp;</div><div class="line number512 index511 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"[+]&nbsp;wait&nbsp;2s..."</code><code class="cpp plain">);</code></div><div class="line number513 index512 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">sleep(2);</code></div><div class="line number514 index513 alt1">&nbsp;</div><div class="line number515 index514 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/***</code></div><div class="line number516 index515 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;zygote进程启动后会进入一个死循环,&nbsp;用来接收AMS的请求连接,</code></div><div class="line number517 index516 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;当没有应用启动时,&nbsp;zygote进程一直处于阻塞状态。</code></div><div class="line number518 index517 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;为防止wait无法返回，因此主动发起一个zygote的连接，解除zygote阻塞状态。</code></div><div class="line number519 index518 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number520 index519 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">((s&nbsp;=&nbsp;socket(AF_UNIX,&nbsp;SOCK_STREAM,&nbsp;0))&nbsp;!=&nbsp;-1)&nbsp;{</code></div><div class="line number521 index520 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote.sun_family&nbsp;=&nbsp;AF_UNIX;</code></div><div class="line number522 index521 alt1"><code class="cpp preprocessor">#if&nbsp;defined(__arm__)</code></div><div class="line number523 index522 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcpy</code><code class="cpp plain">(remote.sun_path,&nbsp;</code><code class="cpp string">"/dev/socket/zygote"</code><code class="cpp plain">);</code></div><div class="line number524 index523 alt1"><code class="cpp preprocessor">#elif&nbsp;defined(__aarch64__)</code></div><div class="line number525 index524 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcpy</code><code class="cpp plain">(remote.sun_path,&nbsp;</code><code class="cpp string">"/dev/socket/zygote64"</code><code class="cpp plain">);</code></div><div class="line number526 index525 alt1"><code class="cpp preprocessor">#endif</code></div><div class="line number527 index526 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">len&nbsp;=&nbsp;</code><code class="cpp functions bold">strlen</code><code class="cpp plain">(remote.sun_path)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(remote.sun_family);</code></div><div class="line number528 index527 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"[+]&nbsp;start&nbsp;to&nbsp;connect&nbsp;zygote&nbsp;socket"</code><code class="cpp plain">);</code></div><div class="line number529 index528 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">connect(s,&nbsp;(</code><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">sockaddr&nbsp;*)&nbsp;&amp;remote,&nbsp;len);</code></div><div class="line number530 index529 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"[+]&nbsp;close&nbsp;socket"</code><code class="cpp plain">);</code></div><div class="line number531 index530 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">close(s);</code></div><div class="line number532 index531 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number533 index532 alt2">&nbsp;</div><div class="line number534 index533 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">NULL;</code></div><div class="line number535 index534 alt2"><code class="cpp plain">}</code></div><div class="line number536 index535 alt1">&nbsp;</div><div class="line number537 index536 alt2"><code class="cpp comments">//&nbsp;Load&nbsp;library&nbsp;in&nbsp;process&nbsp;pid,&nbsp;resolves&nbsp;JavaVM&nbsp;and&nbsp;passes&nbsp;it&nbsp;and&nbsp;param&nbsp;to&nbsp;loaded&nbsp;library,&nbsp;returns&nbsp;0&nbsp;on&nbsp;success</code></div><div class="line number538 index537 alt1"><code class="cpp comments">//&nbsp;在进程pid中加载库，解析JavaVM并将其和param传递给加载的库，成功时返回0</code></div><div class="line number539 index538 alt2"><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">injectvm(pid_t&nbsp;pid,&nbsp;</code><code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;library,&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;type,</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;param)&nbsp;{</code></div><div class="line number540 index539 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop_ptr&nbsp;=&nbsp;remote_stop;</code></div><div class="line number541 index540 alt2">&nbsp;</div><div class="line number542 index541 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">ret&nbsp;=&nbsp;1;</code></div><div class="line number543 index542 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_pid&nbsp;=&nbsp;pid;</code></div><div class="line number544 index543 alt1">&nbsp;</div><div class="line number545 index544 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;attach&nbsp;to&nbsp;target&nbsp;process</code></div><div class="line number546 index545 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(&nbsp;trace(&nbsp;</code><code class="cpp string">"attach"</code><code class="cpp plain">,&nbsp;PTRACE_ATTACH&nbsp;)&nbsp;!=&nbsp;-1)&nbsp;{</code></div><div class="line number547 index546 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;stop&nbsp;entire&nbsp;process,&nbsp;including&nbsp;non-main&nbsp;threads</code></div><div class="line number548 index547 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">kill(&nbsp;_pid,&nbsp;SIGSTOP);</code></div><div class="line number549 index548 alt2">&nbsp;</div><div class="line number550 index549 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;wait&nbsp;until&nbsp;we're&nbsp;stopped</code></div><div class="line number551 index550 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop();</code></div><div class="line number552 index551 alt1">&nbsp;</div><div class="line number553 index552 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;First&nbsp;thing&nbsp;first,&nbsp;we&nbsp;need&nbsp;to&nbsp;search&nbsp;these&nbsp;functions&nbsp;into&nbsp;the&nbsp;target</code></div><div class="line number554 index553 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;process&nbsp;address&nbsp;space.</code></div><div class="line number555 index554 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number556 index555 alt1">&nbsp;</div><div class="line number557 index556 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;We&nbsp;can&nbsp;resolve&nbsp;the&nbsp;references&nbsp;to&nbsp;LIBC&nbsp;easily,&nbsp;but&nbsp;dl*&nbsp;is&nbsp;tricky.&nbsp;On&nbsp;older&nbsp;Android</code></div><div class="line number558 index557 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;versions,&nbsp;libdl.so&nbsp;is&nbsp;commonly&nbsp;not&nbsp;loaded&nbsp;by&nbsp;the&nbsp;linker,&nbsp;and&nbsp;our&nbsp;dl*&nbsp;functions</code></div><div class="line number559 index558 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;come&nbsp;directly&nbsp;from&nbsp;the&nbsp;linker.</code></div><div class="line number560 index559 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*</code></div><div class="line number561 index560 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;On&nbsp;newer&nbsp;Android&nbsp;versions,&nbsp;libdl.so&nbsp;is&nbsp;directly&nbsp;loaded&nbsp;and&nbsp;dl*&nbsp;come&nbsp;from&nbsp;there.</code></div><div class="line number562 index561 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*</code></div><div class="line number563 index562 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*&nbsp;On&nbsp;even&nbsp;newer&nbsp;Android&nbsp;versions,&nbsp;the&nbsp;linker/libc/libdl&nbsp;have&nbsp;moved&nbsp;from&nbsp;/system&nbsp;to&nbsp;/bionic</code></div><div class="line number564 index563 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number565 index564 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//判断VMOS环境&nbsp;isVMOS!=0&nbsp;表示为VMOS环境</code></div><div class="line number566 index565 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">isVMOS&nbsp;=&nbsp;findLibrary(PATH_LIBC_VMOS,&nbsp;_pid);</code></div><div class="line number567 index566 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">isVMOSPRO&nbsp;=&nbsp;findLibrary(PATH_LIBC_VMOS_PRO,&nbsp;_pid);</code></div><div class="line number568 index567 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">isVMOSPRO2&nbsp;=&nbsp;findLibrary(PATH_LIBC_VMOS_PRO_2,&nbsp;_pid);</code></div><div class="line number569 index568 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">isTWOYI&nbsp;=&nbsp;findLibrary(PATH_LIBC_TWOYI,&nbsp;_pid);</code></div><div class="line number570 index569 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">isVPHONE&nbsp;=&nbsp;findLibrary(PATH_LIBC_VPHONE,&nbsp;_pid);</code></div><div class="line number571 index570 alt2">&nbsp;</div><div class="line number572 index571 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;libc&nbsp;=&nbsp;isVMOS!=0&nbsp;?&nbsp;PATH_LIBC_VMOS&nbsp;:&nbsp;(isVMOSPRO!=0&nbsp;?&nbsp;PATH_LIBC_VMOS_PRO&nbsp;:(isVMOSPRO2!=0&nbsp;?&nbsp;PATH_LIBC_VMOS_PRO_2&nbsp;:&nbsp;(&nbsp;isTWOYI!=0&nbsp;?&nbsp;PATH_LIBC_TWOYI&nbsp;:&nbsp;(&nbsp;isVPHONE!=0&nbsp;?&nbsp;PATH_LIBC_VPHONE&nbsp;:&nbsp;(access(&nbsp;PATH_LIBC_BIONIC,&nbsp;R_OK&nbsp;)&nbsp;==&nbsp;0&nbsp;?&nbsp;PATH_LIBC_BIONIC&nbsp;:&nbsp;PATH_LIBC)))));</code></div><div class="line number573 index572 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;libdl&nbsp;=&nbsp;isVMOS!=0&nbsp;?&nbsp;PATH_LIBDL_VMOS&nbsp;:&nbsp;(isVMOSPRO!=0&nbsp;?&nbsp;PATH_LIBDL_VMOS_PRO&nbsp;:(isVMOSPRO2!=0&nbsp;?&nbsp;PATH_LIBDL_VMOS_PRO_2&nbsp;:&nbsp;(&nbsp;isTWOYI!=0&nbsp;?&nbsp;PATH_LIBDL_TWOYI&nbsp;:(&nbsp;isVPHONE!=0&nbsp;?&nbsp;PATH_LIBDL_VPHONE&nbsp;:(access(&nbsp;PATH_LIBDL_BIONIC,&nbsp;R_OK&nbsp;)&nbsp;==&nbsp;0&nbsp;?&nbsp;PATH_LIBDL_BIONIC&nbsp;:&nbsp;PATH_LIBDL)))));</code></div><div class="line number574 index573 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;linker&nbsp;=&nbsp;isVMOS!=0&nbsp;?&nbsp;PATH_LINKER_VMOS&nbsp;:(isVMOSPRO!=0&nbsp;?&nbsp;PATH_LINKER_VMOS_PRO&nbsp;:(isVMOSPRO2!=0&nbsp;?&nbsp;PATH_LINKER_VMOS_PRO_2&nbsp;:&nbsp;(&nbsp;isTWOYI!=0&nbsp;?&nbsp;PATH_LINKER_TWOYI&nbsp;:(&nbsp;isVPHONE!=0&nbsp;?&nbsp;PATH_LINKER_VPHONE&nbsp;:(access(&nbsp;PATH_LINKER_BIONIC,&nbsp;R_OK&nbsp;)&nbsp;==&nbsp;0&nbsp;?&nbsp;PATH_LINKER_BIONIC&nbsp;:&nbsp;PATH_LINKER)))));</code></div><div class="line number575 index574 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG(&nbsp;"libc:%s",&nbsp;libc&nbsp;);</code></div><div class="line number576 index575 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG(&nbsp;"libdl:%s",&nbsp;libdl&nbsp;);</code></div><div class="line number577 index576 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG(&nbsp;"linker:%s",&nbsp;linker&nbsp;);</code></div><div class="line number578 index577 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//获取远端dlopen的地址</code></div><div class="line number579 index578 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_calloc&nbsp;=&nbsp;remote_findFunction(&nbsp;libc,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;</code><code class="cpp functions bold">calloc</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number580 index579 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_free&nbsp;=&nbsp;remote_findFunction(&nbsp;libc,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;</code><code class="cpp functions bold">free</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number581 index580 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">((findLibrary(&nbsp;libdl,&nbsp;-1&nbsp;)&nbsp;!=&nbsp;0)&nbsp;&amp;&amp;&nbsp;(findLibrary(&nbsp;libdl,&nbsp;_pid&nbsp;)&nbsp;!=&nbsp;0))&nbsp;{</code></div><div class="line number582 index581 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//ret&nbsp;=&nbsp;100+isVPHONE;</code></div><div class="line number583 index582 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;handle&nbsp;=&nbsp;dlopen(&nbsp;libdl,&nbsp;RTLD_LAZY&nbsp;);</code></div><div class="line number584 index583 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_dlopen&nbsp;=&nbsp;remote_findFunction(&nbsp;libdl,&nbsp;dlsym(&nbsp;handle,&nbsp;</code><code class="cpp string">"dlopen"</code>&nbsp;<code class="cpp plain">)&nbsp;);</code></div><div class="line number585 index584 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_dlerror&nbsp;=&nbsp;remote_findFunction(&nbsp;libdl,&nbsp;dlsym(&nbsp;handle,&nbsp;</code><code class="cpp string">"dlerror"</code>&nbsp;<code class="cpp plain">)&nbsp;);</code></div><div class="line number586 index585 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dlclose(&nbsp;handle&nbsp;);</code></div><div class="line number587 index586 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number588 index587 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//ret&nbsp;=&nbsp;200+isVPHONE;</code></div><div class="line number589 index588 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_dlopen&nbsp;=&nbsp;remote_findFunction(&nbsp;linker,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;dlopen&nbsp;);</code></div><div class="line number590 index589 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_dlerror&nbsp;=&nbsp;remote_findFunction(&nbsp;linker,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;dlerror&nbsp;);</code></div><div class="line number591 index590 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number592 index591 alt1">&nbsp;</div><div class="line number593 index592 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Resolve&nbsp;android::AndroidRuntime::mJavaVM,</code></div><div class="line number594 index593 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;this&nbsp;is&nbsp;tricky&nbsp;from&nbsp;the&nbsp;payload&nbsp;because</code></div><div class="line number595 index594 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;of&nbsp;linker&nbsp;namespaces&nbsp;(you&nbsp;can't&nbsp;load&nbsp;the&nbsp;lib,&nbsp;dlsym&nbsp;doesn't&nbsp;work&nbsp;right,&nbsp;and&nbsp;the&nbsp;location</code></div><div class="line number596 index595 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;of&nbsp;the&nbsp;variable&nbsp;in&nbsp;memory&nbsp;is&nbsp;different&nbsp;between&nbsp;Android&nbsp;versions),&nbsp;but&nbsp;no&nbsp;such&nbsp;issue</code></div><div class="line number597 index596 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;exists&nbsp;from&nbsp;this&nbsp;injector.</code></div><div class="line number598 index597 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number599 index598 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//获取java&nbsp;vm,如果是vendor下面的拿runtime可能失败</code></div><div class="line number600 index599 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//因为runtime是在system分区下面</code></div><div class="line number601 index600 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;runtime&nbsp;=&nbsp;dlopen(&nbsp;PATH_LIBANDROID_RUNTIME,&nbsp;RTLD_NOW&nbsp;&nbsp;);</code></div><div class="line number602 index601 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;javavm&nbsp;=&nbsp;dlsym(&nbsp;runtime,&nbsp;</code><code class="cpp string">"_ZN7android14AndroidRuntime7mJavaVME"</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number603 index602 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;_javavm&nbsp;=&nbsp;remote_findFunction(&nbsp;PATH_LIBANDROID_RUNTIME,&nbsp;javavm&nbsp;);</code></div><div class="line number604 index603 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dlclose(runtime);</code></div><div class="line number605 index604 alt2">&nbsp;</div><div class="line number606 index605 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"calloc:%p&nbsp;free:%p&nbsp;dlopen:%p&nbsp;dlerror:%p&nbsp;javavm:%p"</code><code class="cpp plain">,&nbsp;_calloc,&nbsp;_free,&nbsp;_dlopen,&nbsp;_dlerror,&nbsp;_javavm&nbsp;);</code></div><div class="line number607 index606 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"inject&nbsp;elf&nbsp;path&nbsp;%s&nbsp;"</code><code class="cpp plain">,&nbsp;library&nbsp;);</code></div><div class="line number608 index607 alt1">&nbsp;</div><div class="line number609 index608 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;once&nbsp;we&nbsp;have&nbsp;the&nbsp;addresses,&nbsp;we&nbsp;can&nbsp;proceed&nbsp;to&nbsp;inject</code></div><div class="line number610 index609 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(&nbsp;remote_dlopen(library)&nbsp;!=&nbsp;0&nbsp;)&nbsp;{</code></div><div class="line number611 index610 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"remote&nbsp;dlopen&nbsp;[%s]&nbsp;success&nbsp;!&nbsp;"</code><code class="cpp plain">,library);</code></div><div class="line number612 index611 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;payload&nbsp;=&nbsp;dlopen(&nbsp;library,&nbsp;RTLD_LAZY&nbsp;);</code></div><div class="line number613 index612 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(payload&nbsp;==&nbsp;nullptr){</code></div><div class="line number614 index613 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"remote&nbsp;dlopen&nbsp;error&nbsp;%s&nbsp;"</code><code class="cpp plain">,&nbsp;library);</code></div><div class="line number615 index614 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number616 index615 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;LocDoRunSym&nbsp;=&nbsp;dlsym(payload,&nbsp;</code><code class="cpp string">"doRun"</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number617 index616 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(LocDoRunSym&nbsp;==&nbsp;nullptr){</code></div><div class="line number618 index617 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"not&nbsp;find&nbsp;doRun&nbsp;sym&nbsp;"</code>&nbsp;<code class="cpp plain">);</code></div><div class="line number619 index618 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number620 index619 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Dl_info&nbsp;info;</code></div><div class="line number621 index620 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">dladdr(LocDoRunSym,&amp;info);</code></div><div class="line number622 index621 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(</code><code class="cpp string">"loc&nbsp;doRun&nbsp;info&nbsp;[%s]&nbsp;fbase&nbsp;-&gt;&nbsp;%p&nbsp;&nbsp;offset&nbsp;%p&nbsp;"</code><code class="cpp plain">,</code></div><div class="line number623 index622 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">info.dli_fname,info.dli_fbase,(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)((</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)LocDoRunSym-(</code><code class="cpp color1 bold">size_t</code><code class="cpp plain">)info.dli_fbase)</code></div><div class="line number624 index623 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">);</code></div><div class="line number625 index624 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;remoteDoRunSym&nbsp;=&nbsp;remote_findFunction(library,&nbsp;LocDoRunSym);</code></div><div class="line number626 index625 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(LocDoRunSym&nbsp;!=&nbsp;NULL&nbsp;&amp;&amp;&nbsp;remoteDoRunSym&nbsp;!=&nbsp;NULL)&nbsp;{</code></div><div class="line number627 index626 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG("start&nbsp;call&nbsp;doRun&nbsp;-&gt;&nbsp;%p&nbsp;-&gt;&nbsp;[%s]",&nbsp;remoteDoRunSym,&nbsp;param);</code></div><div class="line number628 index627 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">pdata&nbsp;=&nbsp;remote_string(param);</code></div><div class="line number629 index628 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">ptype&nbsp;=&nbsp;remote_string(type);</code></div><div class="line number630 index629 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//remote_call(remoteDoRunSym,&nbsp;2,&nbsp;_javavm,&nbsp;pmem);</code></div><div class="line number631 index630 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//return&nbsp;0&nbsp;is&nbsp;success&nbsp;~!</code></div><div class="line number632 index631 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">call_dorun_ret&nbsp;=&nbsp;remote_call(remoteDoRunSym,&nbsp;2,ptype,&nbsp;pdata);</code></div><div class="line number633 index632 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//auto&nbsp;call_dorun_ret&nbsp;=&nbsp;remote_call(remoteDoRunSym,&nbsp;0);</code></div><div class="line number634 index633 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_free(pdata);</code></div><div class="line number635 index634 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_free(ptype);</code></div><div class="line number636 index635 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG("doRun&nbsp;call&nbsp;finish&nbsp;%lu&nbsp;%p",call_dorun_ret,(void*)call_dorun_ret);</code></div><div class="line number637 index636 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ret&nbsp;=&nbsp;call_dorun_ret;</code></div><div class="line number638 index637 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number639 index638 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number640 index639 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">error[1024]&nbsp;=&nbsp;{&nbsp;0&nbsp;};</code></div><div class="line number641 index640 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_dlerror(error,&nbsp;1024);</code></div><div class="line number642 index641 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"remote_dlopen&nbsp;failed:&nbsp;%s"</code><code class="cpp plain">,&nbsp;error&nbsp;);</code></div><div class="line number643 index642 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number644 index643 alt1">&nbsp;</div><div class="line number645 index644 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;detach&nbsp;from&nbsp;target&nbsp;process</code></div><div class="line number646 index645 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">remote_stop();</code></div><div class="line number647 index646 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">trace(&nbsp;</code><code class="cpp string">"detach"</code><code class="cpp plain">,&nbsp;PTRACE_DETACH&nbsp;);</code></div><div class="line number648 index647 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;let&nbsp;all&nbsp;threads&nbsp;in&nbsp;the&nbsp;target&nbsp;process&nbsp;continue</code></div><div class="line number649 index648 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">kill(&nbsp;_pid,&nbsp;SIGCONT&nbsp;);</code></div><div class="line number650 index649 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&nbsp;ptrace&nbsp;finish&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;"</code><code class="cpp plain">);</code></div><div class="line number651 index650 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number652 index651 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOG(&nbsp;</code><code class="cpp string">"Failed&nbsp;to&nbsp;attach&nbsp;to&nbsp;process&nbsp;%d"</code><code class="cpp plain">,&nbsp;_pid);</code></div><div class="line number653 index652 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number654 index653 alt1">&nbsp;</div><div class="line number655 index654 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">ret;</code></div><div class="line number656 index655 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这段代码编译成一个注入器 ，输入路径就是对应的pid和你要注入的so文件 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>整体思路就是ptrace attach到目标进程 。然后让目标进程调用dlopen去打开指定的so文件 ，实现我们自己的逻辑的初始化。</strong></span></p><blockquote><hr><p style="line-height:1; margin-top:0.8em;"><span><em><span><strong><span><span style="text-decoration:underline;"><span>下面说的远端函数指的是被注入的进程的函数地址。</span></span></span></strong></span></em></span></p></blockquote><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_3"><span>1、所以我们需要得到目标进程dlopen，malloc （用于分配字符串）的地址 。</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>先算出来dlopen相对libc的偏移 ，我们先在可执行程序里面打开libc，计算出来dlopen的偏移 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>然后注入进程以后，在目标进程打开libc ，在目标进程地址libc+ 获取到的偏移 ，就是目标进程的dlopen地址 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>同样的方式去获取dlopen ，dlerror ，malloc ，free 等地址 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">/*</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;Compute&nbsp;the&nbsp;delta&nbsp;of&nbsp;the&nbsp;local&nbsp;and&nbsp;the&nbsp;remote&nbsp;modules&nbsp;and&nbsp;apply&nbsp;it&nbsp;to&nbsp;the&nbsp;local&nbsp;address&nbsp;of&nbsp;the&nbsp;symbol&nbsp;...</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;计算本地和远程模块的增量，并将其应用于符号的本地地址。。。</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;BOOM,&nbsp;remote&nbsp;symbol&nbsp;address!</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*&nbsp;BOOM，远程符号地址！</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;</code><code class="cpp comments">*/</code></div><div class="line number7 index6 alt2"><code class="cpp keyword bold">static</code>&nbsp;<code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;remote_findFunction(</code><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp color1 bold">char</code><code class="cpp plain">*&nbsp;library,&nbsp;</code><code class="cpp keyword bold">void</code><code class="cpp plain">*&nbsp;local_addr)&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(local_addr&nbsp;==&nbsp;nullptr){</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;%s&nbsp;location&nbsp;base&nbsp;%p"</code><code class="cpp plain">,library,(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)local_addr);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_handle&nbsp;=&nbsp;findLibrary(&nbsp;library,&nbsp;-1&nbsp;);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(remote_handle&nbsp;==&nbsp;0){</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;%s&nbsp;remote&nbsp;base&nbsp;==&nbsp;0&nbsp;"</code><code class="cpp plain">,library);</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">local_handle&nbsp;=&nbsp;findLibrary(&nbsp;library,&nbsp;getpid()&nbsp;);</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(local_handle&nbsp;==&nbsp;0){</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//INJECTLOG("remote_findFunction&nbsp;local_handle&nbsp;==&nbsp;0&nbsp;%s&nbsp;loc&nbsp;&nbsp;%p&nbsp;&nbsp;%d&nbsp;%s&nbsp;",library,local_addr,getpid(),getprogname());</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Dl_info&nbsp;info;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(dladdr(local_addr,&amp;info)){</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">local_handle&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)info.dli_fbase;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code><code class="cpp plain">{</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">INJECTLOGE(</code><code class="cpp string">"remote_findFunction&nbsp;local_handle&nbsp;backup&nbsp;==&nbsp;0&nbsp;&nbsp;"</code><code class="cpp plain">);</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">nullptr;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">offset&nbsp;=&nbsp;(</code><code class="cpp color1 bold">uintptr_t</code><code class="cpp plain">)&nbsp;local_addr&nbsp;-&nbsp;local_handle;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uintptr_t</code>&nbsp;<code class="cpp plain">remote_addr&nbsp;=&nbsp;remote_handle&nbsp;+&nbsp;offset;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">(</code><code class="cpp keyword bold">void</code><code class="cpp plain">*)remote_addr;</code></div><div class="line number31 index30 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>上面这段代码就是做我说的这件事 ，参数1先传入对应的so路径 ，参数2需要获取的函数比如dlopen地址（这个地址是我们本地进程的dlopen地址） &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>返回值是远端的dlopen地址 。实现方式主要如下 ：</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们可以先通过findLibrary 遍历自己的进程的比如libc.so文件开始地址 ，比如是0xABC 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>在获取目标进程libc的开始地址 。可以通过dladdr 函数里面的dli_fbase得到开始地址 比如是0x456</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这时候我们用本地进程的dlopen绝对地址， 减去我们自己的libc.so 开始地址0xABC ，得到dlopen的相对偏移 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>再用这个dlopen的相对偏移去加上0x456 ，就是目标进程的dlopen的绝对地址。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_4"><span>2、远端进程打开我们自己的SO文件</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>直接在远端进程调用dlopen函数指针 ，打开我们要注入的so文件 ，拿到so文件的句柄以后，在通过dlsym拿到我们导出的函数 &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>然后再调用远端进程 malloc 去分配一个字符串 ，分配完毕以后用作参数传到我们导出的函数 。实现初始化 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>详细代码可以参考 injectvm 函数 ，里面有详细的注入流程 &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_5"><span>3、Hack DRM</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这时候已经注入到目标进程，可以直接用inlinehook去hook 即可 。因为注入的分区主要在vendor下面 ，所以不能直接用system/lib下的so文件 。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">extern</code>&nbsp;<code class="cpp string">"C"</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number2 index1 alt1"><code class="cpp plain">__attribute__&nbsp;((visibility&nbsp;(</code><code class="cpp string">"default"</code><code class="cpp plain">)))</code></div><div class="line number3 index2 alt2"><code class="cpp color1 bold">int</code></div><div class="line number4 index3 alt1"><code class="cpp plain">doRun(</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*type,&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*data)&nbsp;{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(ERROR)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"start&nbsp;doRun&nbsp;&nbsp;!!!&nbsp;data&nbsp;-&gt;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;data;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(</code><code class="cpp functions bold">strcpy</code><code class="cpp plain">(type,&nbsp;</code><code class="cpp string">"hack_drm"</code><code class="cpp plain">))&nbsp;{</code></div><div class="line number7 index6 alt2"><code class="cpp preprocessor">#define&nbsp;SYM_THE_PATH&nbsp;"/vendor/lib64/libwvhidl.so"</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(ERROR)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"rep&nbsp;mock&nbsp;drm&nbsp;&nbsp;["</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;fake_wvdrm_hash&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"]&nbsp;orig&nbsp;["</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;data&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"]"</code><code class="cpp plain">;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">fake_wvdrm_hash&nbsp;=&nbsp;data;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!DrmIsHooked)&nbsp;{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//1.2&amp;1.3&amp;1.4</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">sym&nbsp;=&nbsp;getSymCompat(SYM_THE_PATH,</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"_ZN5wvdrm8hardware3drm4V1_28widevine11WVDrmPlugin20CdmIdentifierBuilder17getDeviceUniqueIdEPNSt3__112basic_stringIcNS6_11char_traitsIcEENS6_9allocatorIcEEEE"</code><code class="cpp plain">);</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(sym&nbsp;==&nbsp;nullptr)&nbsp;{</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">sym&nbsp;=&nbsp;getSymCompat(SYM_THE_PATH,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"_ZN5wvdrm8hardware3drm4V1_38widevine11WVDrmPlugin20CdmIdentifierBuilder17getDeviceUniqueIdEPNSt3__112basic_stringIcNS6_11char_traitsIcEENS6_9allocatorIcEEEE"</code><code class="cpp plain">);</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(sym&nbsp;==&nbsp;nullptr)&nbsp;{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">sym&nbsp;=&nbsp;getSymCompat(SYM_THE_PATH,</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"_ZN5wvdrm8hardware3drm4V1_48widevine11WVDrmPlugin20CdmIdentifierBuilder17getDeviceUniqueIdEPNSt3__112basic_stringIcNS6_11char_traitsIcEENS6_9allocatorIcEEEE"</code><code class="cpp plain">);</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(sym&nbsp;==&nbsp;nullptr)&nbsp;{</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(ERROR)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"!!!!!!!!!!&nbsp;mock&nbsp;drm&nbsp;error&nbsp;,not&nbsp;find&nbsp;sym&nbsp;&nbsp;!!!!!!!!&nbsp;"</code><code class="cpp plain">;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">1;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">ret&nbsp;=&nbsp;HookUtils::Hooker(sym,&nbsp;(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">*)&nbsp;new_getDeviceUniqueId,</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">(</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">**)&nbsp;&amp;orig_getDeviceUniqueId);</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ret)&nbsp;{</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DrmIsHooked&nbsp;=&nbsp;</code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(ERROR)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"hack&nbsp;drm&nbsp;is&nbsp;success&nbsp;!&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;ret;</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(ERROR)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"hack&nbsp;drm&nbsp;is&nbsp;error&nbsp;!&nbsp;"</code><code class="cpp plain">;</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG(INFO)&nbsp;&lt;&lt;&nbsp;</code><code class="cpp string">"realy&nbsp;is&nbsp;hack&nbsp;drm&nbsp;"</code>&nbsp;<code class="cpp plain">&lt;&lt;&nbsp;fake_wvdrm_hash;</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number40 index39 alt1"><code class="cpp plain">}</code></div><div class="line number41 index40 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_9"><span>Getprop指纹修改：</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>再讲这块之前，我们需要先科普一下一个基础知识，就是selinux关闭了会发生什么 ，这块还有一个很有意思的趣闻 。客户端如何反向投毒&amp;蜜罐服务端 ？</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">zeus:/&nbsp;$&nbsp;id</code></div><div class="line number2 index1 alt1"><code class="cpp plain">uid=2000(shell)&nbsp;gid=2000(shell)&nbsp;groups=2000(shell),1004(input),1007(</code><code class="cpp functions bold">log</code><code class="cpp plain">),1011(adb),1015(sdcard_rw),1028(sdcard_r),1078(ext_data_rw),1079(ext_obb_rw),3001(net_bt_admin),3002(net_bt),3003(inet),3006(net_bw_stats),3009(readproc),3011(uhid),3012(readtracefs)&nbsp;context=u:r:shell:s0</code></div><div class="line number3 index2 alt2"><code class="cpp plain">zeus:/&nbsp;$&nbsp;getprop&nbsp;|&nbsp;grep&nbsp;oem</code></div><div class="line number4 index3 alt1"><code class="cpp plain">[ro.fota.oem]:&nbsp;[Xiaomi]</code></div><div class="line number5 index4 alt2"><code class="cpp plain">[ro.ril.oem.imei]:&nbsp;[864489057004666]</code></div><div class="line number6 index5 alt1"><code class="cpp plain">[ro.ril.oem.imei1]:&nbsp;[864489057004666]</code></div><div class="line number7 index6 alt2"><code class="cpp plain">[ro.ril.oem.imei2]:&nbsp;[864489057004666]</code></div><div class="line number8 index7 alt1"><code class="cpp plain">[ro.ril.oem.meid]:&nbsp;[99001831350666]</code></div><div class="line number9 index8 alt2"><code class="cpp plain">[ro.ril.oem.psno]:&nbsp;[37331/21ZW02666]</code></div><div class="line number10 index9 alt1"><code class="cpp plain">[ro.ril.oem.sno]:&nbsp;[789752F14564695]</code></div><div class="line number11 index10 alt2"><code class="cpp plain">[sys.oem_unlock_allowed]:&nbsp;[0]</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>getprop 里面保存了一些变量，这些变量的Selinux权限很高 ，需要系统级别的group或者root级别的selinux全选组才可以拿到 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>但是如果你手机关闭了Selinux ,这些变量都可以随便拿 。这里面不仅仅有oem分区的值，还有一些历史开机时间 。这些都是比较隐蔽的设备指纹。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  bash"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">[persist.sys.boot.reason.</code><code class="bash functions">history</code><code class="bash plain">]:&nbsp;[reboot,userrequested,1716561955]</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>他可以直接通过getprop直接就把你手机全部信息都读走 ，我们其实是不希望这样的，</span><span><strong>所以selinux无论如何也要开启 ，否则你得手机就是在裸奔。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>对与修改这些环境变量方法更多了，直接用magisk自带的magisk resetprop 命令直接修改即可。比如下面的修改debug环境，一行命令行就是全局修改了。</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  bash"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">magisk&nbsp;resetprop&nbsp;ro.debuggable&nbsp;1</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>用起来也很方便 &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块就说上面的那个趣闻了 ，很多大厂他在采集数据的时候，</span><span><strong>根本没办法保证自己采集的数据是准确的</strong></span><span>，特别是这种oem分区的，在他觉得我能采到这个值就可以上报到服务端 。那好我们来个反向投毒 。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>我们直接把一台正常的手机，伪装成关闭selinux权限的 ，然后去故意暴露一个我修改过的ro.ril.oem.imei等，让目标App去读取 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>用这种方式差不点没给我笑死，竟然真的把一台已经封掉的手机给复活了。基本可以断定，很多大厂客户端采集的数据也没有确认 ，特别是 这种隐藏数据 。</span></p><p style="line-height:1; margin-top:0.8em;"><span>他也是尝试去拿，而我们也尝试去给你伪造的 。这种imei这种数据在大厂的风控设备指纹里面比重很大，完全不经过确认是真是假，就被列入了指纹。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>其实在大厂里面很多策略根本不懂技术 ，他们遇到了问题，只会想着问安全SDK的客户端，去帮忙查case，当查不到有任何问题的时候</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>头疼的就是他们了。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_4"><span>设备指纹采集反思&amp;总结：</span></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>前段时间在写hunter代码的时候 ，我忽然想到一个问题 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong>我们在做安全SDK客户端的数据采集的时候，应该如何确保我们拿到的字段是真实和安全的？</strong></span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_10"><span>1、我们可以自己去NDK里面把libc.so的动态库编译到我们自己的so里面 。而不走系统的libc 。</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>为什么不推荐使用系统的libc呢 ？其实这块有一个so文件字符串通杀的办法 。就是直接hook strlen这个函数 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>如果发现上级调用栈使我们自己的就直接返回 ，如果是目标So文件的我们就可以在这里进行替换和拦截。基本可以通杀市面上任何大厂 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>之前和牛头人做对抗的时候发现牛头人就是没有走标准的libc.so文件 ，一个libc.so函数没有被调用 。</span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_11"><span>2、我们应该尽可能的不要使用c++ 里面的string </span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>网上有很多字符串的开源库，如果使用了c++ 里面的string 就很难逃逸strlen的hook，因为string的构造里面无论如何也需要使用strlen 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>如果对方直接hook了你string的append函数 ，你也是没办法逃逸的。</span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_12"><span>3、单字段多形式获取</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如上面说的boot_id这种，我们应该尝试使用多种方式去获取，比如abc三种方式获取的值都是一样的，客户端在进行上报 。</span></p><h2 style="font-size:6; line-height:1.225; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h2_13"><span>4、基础环境检测</span></h2><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>设备指纹分为两部分，采集设备指纹相关字段，风险检测相关字段 。个人觉得 1/9比例是最好的 ，踩一个字段的前提下，应该把可能被修改的点</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>都想到，而不是只采集有效的字段 ，更多应该关注环境信息 ，比如在一些重点场景下可以采集一些用户的logcat日志上报。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>方便做攻击分析，很多黑产或者搞攻击的会忽略这块，其实检测就是细节上的对抗 ，logcat日志直接给你上报过去，发现指定日志直接封你号就行了。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>但是这块也有弊端，logcat这种属于大数据 ，通过什么地方上报是个问题，如果是同步上报过去，肯定会很耗时 ，所以这块</span></p><p style="line-height:1; margin-top:0.8em;"><span>可能还需要去设计，在制定场景下去通过socket这种发包的方式取上报拦截。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_5"><span>一机多号实现：</span></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>上面说了这么多，还有一个地方没有说 ，就是如何实现IO重定向呢？我们知道一个App可以写入的位置只有两个地方 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>一个是/sdcard 和 /data/data/包名 。我们只需要把这些进行保存的位置进行IO重定向。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>SD卡里面还有/sdcard/Android/data/包名这些都是隶属于/sdcard下面的，但是他们两个的挂载位置是完全不一样的，所属的selinux权限也不一样 。</span></p><p style="line-height:1; margin-top:0.8em;"><span>/sdcard 这种属于 Fuse（文件系统用户空间），但是/sdcard/Android/data/是属于F2FS（闪存友好文件系统）的 。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这块有两种比较好的实现方式</span></p><ul style="margin-top:0.8em; margin-bottom:0.8em; padding-left:30px; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><li><p style="line-height:1; margin-bottom:0.5rem;"><span>内核模块去实现系统级别IO重定向。</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>直接使用Mount命令</span></p></li></ul><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>现在你已经有Root环境 ，如果在开发syscall hook实现成本也挺大的 ，可以推荐用方案1 ，通过Apatch模块在内核里面直接进行全局的IO重定向即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>但是需要测试 。我这边使用的是Mount命令，更轻量化 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>他这个命令的主要是</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  bash"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash spaces">&nbsp;</code><code class="bash functions">mount</code>&nbsp;<code class="bash plain">--bind&nbsp;源文件目录&nbsp;目标文件目录</code></div></div></td></tr></tbody></table><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>比如我希望对/data/data/包名、这个目录 进行IO重定向 mount --bind &nbsp;【/abc/AAA用户/data目录】 ，【 /data/data/包名】</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>这样执行的话当目标App往 &nbsp;/data/data/包名目录写入东西的时候，也会同步到/abc/AAA用户/data目录 这个目录 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>当我们umount取消挂载的时候 /abc/AAA用户/data目录文件内容还是会存在 。即可实现全局的IO重定向。具体实现如下 。包名以脱敏。记得修改文件权限，小心selinux规则限制哦 ，</span><span><strong>不过限制了也无所谓，Magisk模块支持修改自定义selinux规则。</strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><strong><br></strong></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span style="min-width:10px; min-height:10px; font-family:monospace; width:1140px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934_RE32GQR6X2GU87W.webp" referrerpolicy="no-referrer" class="div_message_boxShadow" style="cursor: zoom-in;"></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><br></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>每个用户下面保存着 </span></p><ul style="margin-top:0.8em; margin-bottom:0.8em; padding-left:30px; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><li><p style="line-height:1; margin-bottom:0.5rem;"><span>当前用户的设备指纹相关数据</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>SD卡相关数据 （重定向目录）</span></p></li><li><p style="line-height:1; margin-bottom:0.5rem;"><span>/data/data/包名相关数据（重定向目录） </span></p></li></ul><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>三个目录即可 ，如果切换到指定用户，只需要把当前用户的设备指纹相关数据进行读取，把mock的保存到内存里即可。在设置mock的设备指纹读取这个内存中的值即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_6"><span>对抗总结：</span></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>通过上面连续操作我们即可实现在客户端不注入一行代码的情况下，实现设备指纹的全量修改。虽然我们对目标进程进行对抗 ，但是我们一行代码也没有修改 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>我们改的也都是系统本身的值 。但是客户端获取的都是被修改过的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_6"><span>问题1：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>因为你使用了mount命令 ，我可以直接检测你挂载文件 ，如果有人遍历了你mount挂载文件检测你怎么办呢？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>这块其实很简单，直接不让他读或者在内核写个模块把这个文件特征抹掉就好了，内核你都能随便修改了，整个手机规则的缔造者。</span></p><p style="line-height:1; margin-top:0.8em;"><span>啥文件还不能修改呢。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_7"><span>问题2：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>magisk模块本身也不是会注入到目标进程么？难道就一点痕迹没有么？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>这个问题其实很简单，注入归注入，修改归修改，注入了什么也没修改 内存是无痕迹的 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>我们只需要在magisk模块加载完毕以后调用</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>api_-&gt;setOption(zygisk::Option::DLCLOSE_MODULE_LIBRARY);</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>把magisk模块so移除掉即可 。可能移除掉以后目标的Application还没开始执行调用就已经关闭了。</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span><strong>我们在目标进程没有修改任何代码，所以不存在函数跳转地址 ，我也没有inlinehook当前进程的任何so文件 。</strong></span></p><p style="line-height:1; margin-top:0.8em;"><span><strong>内存里面也就不会再内存里面存在任何执行的段 ，并且任何SO文件的CRC也不发生变化。</strong></span></p></blockquote></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_8"><span>问题3：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>你手机既然root了，我检测你解锁或者root不行么？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>其实这块有一个很恶心的事情，就是shamiko+magisk修改包名 ，可以过掉国内99.999%的App root检测 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>shamiko会用chroot给你一个新的环境 ，是任何root痕迹都没有的 ，root检测其实很难的 ，解锁的手机也没办法直接封号 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>（之前老版本的shamiko可能有一些漏洞可以钻，但是新版本里面我找了很久也没找到好的洞 。）</span></p><p style="line-height:1; margin-top:0.8em;"><span>因为现在市面上解锁的手机占比还是很大的 。解锁了也不一定代表作弊了。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_9"><span>问题4：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>你客户端不注入一行代码，如何拿到Apk里面的数据呢？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>办法有很多 ，可以直接用自动点击的软件配合OCR文字识别即可 。看什么样的数据，如果是大文本数据可以直接通过抓包或者路由代理等直接解密即可 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>最次办法直接客户端注入lsplant直接hook对应函数，拿到数据 &nbsp;。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>这块lsplant hook crc也不一定发生变化的，因为我之前把他inlinehook那块注释掉，发现hook还是生效的，他那个inlinehook主要是为了解决</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>一些被oat了短指令的函数 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em;"><span>这块还有一个新的技术点可以用内核里面的硬件断点去实现inlinehook 。也是无痕的hook方式一种，不过好像hook的方法数量有限。</span></p><p style="line-height:1; margin-top:0.8em;"><span>这里感谢B哥提供的硬段思路，B哥太强了！</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h3 style="font-size:6; line-height:1.43; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h3_10"><span>问题5：</span></h3><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>你那么多台手机都聚集在一起不怕被封么？</span></p><blockquote><p style="line-height:1; margin-bottom:0.8em;"><span>可以把手机放在全国各地，连接上USB能实现自动点击即可 &nbsp;, 流量使用物联卡的流量即可。</span></p><p style="line-height:1; margin-top:0.8em;"><span>解决聚集性策略。这块需要逐步发展，手机数量是在之前满足的情况下，在进行扩增。</span></p></blockquote><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><br></p><h1 style="font-size:6; line-height:1.2; color:rgb(51, 51, 51); font-family:none;" id="msg_header_h1_7"><span>结尾：</span></h1><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>感谢读到这里 ，各位读到这里也是有e点收获的 。最起码方向有了 ，如果本文里面，有哪些错误地方或者不认同有更好的方案也可以随时在下面回复即可。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>有时间的情况下，我每一条都会看的。 </span> &nbsp;</p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>再次感谢lsplant的开源项目和Apatch的项目开源 。</span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/elink@94cK9s2c8@1M7s2y4Q4x3@1q4Q4x3V1k6Q4x3V1k6Y4K9i4c8Z5N6h3u0Q4x3X3g2U0L8$3#2Q4x3V1k6x3f1#2m8G2M7$3g2V1i4K6u0r3e0q4y4b7L8r3q4F1N6l9%60.%60.">https://github.com/LSPosed/LSPlant</a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span><a href="https://bbs.kanxue.com/elink@e3eK9s2c8@1M7s2y4Q4x3@1q4Q4x3V1k6Q4x3V1k6Y4K9i4c8Z5N6h3u0Q4x3X3g2U0L8$3#2Q4x3V1k6T1L8h3q4^5x3e0t1I4i4K6u0r3b7g2m8S2N6r3y4Z5">https://github.com/bmax121/APatch</a></span></p><p style="line-height:1; margin-top:0.8em; margin-bottom:0.8em; color:rgb(51, 51, 51); font-family:none; font-size:16px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---- 2024/5/25日阴。</span></p><p><br></p>							
<br>
<p><a class="bbs_thread" target="_blank" href="https://www.kanxue.com/book-section_list-173.htm">[培训]内核驱动高级班，冲击BAT一流互联网大厂工作，每周日13:00-18:00直播授课</a></p>

		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2024-7-31 23:30		
				被珍惜Any编辑
				
		，原因： 图片丢失		
	</div>
<div class="my-3">
		<a href="https://bbs.kanxue.com/forum-161-1-120.htm" class="hidden-sm hidden-md small px-2 py-1 mr-2 " style="border-radius: 3px; background-color: #daf2ff; color: #0099ee;">#协议分析</a>
		<a href="https://bbs.kanxue.com/forum-161-1-118.htm" class="hidden-sm hidden-md small px-2 py-1 mr-2 " style="border-radius: 3px; background-color: #daf2ff; color: #0099ee;">#逆向分析</a>
		<a href="https://bbs.kanxue.com/forum-161-1-117.htm" class="hidden-sm hidden-md small px-2 py-1 mr-2 " style="border-radius: 3px; background-color: #daf2ff; color: #0099ee;">#基础理论</a>
	</div>					

														
							
							
							

													</div>

						<div>
													</div>

						<div style="height: 33px; line-height: 33px; border-top: 1px solid #ddd;">
																				</div>
					</div>
				</div>

				<div id="collection_thumb" style="text-align:center;padding:5px 0px 30px; margin-bottom: 1rem;">
					<div style="width:auto;display:inline-block;">

						<div class="card_collection" style=" height: 65px;line-height:30px">
							<div>
																<a href="javascript:void(0);" class="d-inline-block favorite" style="box-shadow: 0 4px 16px 0 rgba(13,39,91,.1); border-radius: 100%; width: 40px; height: 40px;line-height: 40px;">
									<i class="icon-star-o color515a6e"></i>
								</a>
															</div>
							<div>
								收藏
								<span class="likes_box likes_box_show" style="font-size: 13px;">・<span class="likes">124</span></span>
							</div>
						</div>
						<div class="card_collection" style=" height: 65px;line-height:30px">
							<div>
																<a href="javascript:void(0);" data-toggle="modal" data-target="#thumbModal" class="d-inline-block thumb thumbsBox" style="box-shadow: 0 4px 16px 0 rgba(13,39,91,.1); border-radius: 100%; width: 40px; height: 40px;line-height: 40px;">
									<i class="icon-thumbs-o-up color515a6e"></i>
								</a>
								
							</div>
							<div>
								<span class="text-cycler" style="">免费</span>
								<span class="thumbs_num_box" style="font-size: 13px;">・<span class="thumbs_num">49</span></span>
							</div>

						</div>
						<div class="card_collection" style=" height: 65px;line-height:30px">
							<div>
								<a href="javascript:void(0);" class="modal-title d-inline-block" id="exampleModalLabel" style="box-shadow: 0 4px 16px 0 rgba(13,39,91,.1); border-radius: 100%; width: 40px; height: 40px;line-height: 40px;" data-toggle="modal" data-target=".reward">
									<!-- <i class="icon-rmb color515a6e"></i> -->
									<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-battery-charging" style="vertical-align: middle;"><path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3.19M15 6h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3.19"></path><line x1="23" y1="13" x2="23" y2="11"></line><polyline points="11 6 7 12 13 12 9 18"></polyline></svg>
								</a>
							</div>
							<div>
								支持
							</div>
						</div>
						<div class="card_collection position-relative" style=" height: 65px;line-height:30px">
							<div class="bbsshare_btn" style="cursor: pointer;">
								<div>
									<a href="javascript:void(0);" class="modal-title d-inline-block" style="box-shadow: 0 4px 16px 0 rgba(13,39,91,.1); border-radius: 100%; width: 40px; height: 40px; line-height: 40px;">
										<!-- <i class="icon-share color515a6e"></i> -->
										<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link" style="vertical-align: middle;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
									</a>
								</div>
								<div>
									分享
								</div>
							</div>
							<div class="bd-bbsshare-modal-sm bbsshare_modal bg-white" style="display: none; width: 146px; box-shadow: 0 0 3px 0.5px #eee;">
								<div class="px-2 py-4">
									<div class="text-center" style="color: #5C5C5C;"><i class="icon icon-wechat "></i> 分享到微信
									</div>
									<div class="wechat_img py-2">
										<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d281889_2ehtm.htm" style="width: 100%;">
									</div>
									<div onclick="shareTo(&#39;qq&#39;)" class="text-center" style="color: #5C5C5C; cursor: pointer;"><i class="icon icon-qq"></i> 分享到QQ</div>
									<!-- <div class="text-center" style="color: #5C5C5C; cursor: pointer;"><i class="icon icon-wechat"></i> 分享到空间</div> -->
									<div onclick="shareTo(&#39;sina&#39;)" class="text-center" style="color: #5C5C5C; cursor: pointer;"><i class="icon icon-weibo"></i> 分享到微博</div>

								</div>
							</div>
						</div>

					</div>
				</div>
			</div>
							<div class="card thumb_list_box" style="">
					<div class="card-body thumb_list_body">
						<div class="pb-2" style="font-weight: bolder;">赞赏记录</div>
						<div class="row mx-0 pb-3 pt-2" style="font-weight: 600;">
							<div style="width: 100px;">参与人</div>
							<div style="width: 100px; text-align: center;">雪币</div>
							<div class="col px-2">留言</div>
							<div style="width: 120px; text-align: left;">时间</div>
	
						</div>
						<div class="thumb_list">
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_cyxmlyju</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">你的分享对大家帮助很大，非常感谢！</div>
								<div style="width: 120px; text-align: left;">2025-1-19 21:57</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">阿福哦哦</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">这个讨论对我很有帮助，谢谢！</div>
								<div style="width: 120px; text-align: left;">2024-12-28 13:45</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">gladly</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">你的分享对大家帮助很大，非常感谢！</div>
								<div style="width: 120px; text-align: left;">2024-11-26 11:48</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">简单的简单</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+1</div>
								<div class="col px-2 text-muted">感谢你分享这么好的资源！</div>
								<div style="width: 120px; text-align: left;">2024-11-17 17:19</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_xvkmqsug</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">感谢你的积极参与，期待更多精彩内容！</div>
								<div style="width: 120px; text-align: left;">2024-11-14 19:29</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">xiran210</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞！</div>
								<div style="width: 120px; text-align: left;">2024-11-8 17:24</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">blue_sky</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞！</div>
								<div style="width: 120px; text-align: left;">2024-10-23 20:08</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">wx_倾尽天下</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">期待更多优质内容的分享，论坛有你更精彩！</div>
								<div style="width: 120px; text-align: left;">2024-10-22 21:51</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">xdcs100</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">非常支持你的观点！</div>
								<div style="width: 120px; text-align: left;">2024-10-14 13:35</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">falconnnn</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">谢谢你的细致分析，受益匪浅！</div>
								<div style="width: 120px; text-align: left;">2024-10-10 20:04</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_eflgweyp</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">你的分享对大家帮助很大，非常感谢！</div>
								<div style="width: 120px; text-align: left;">2024-9-12 16:19</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">山竹笠</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+3</div>
								<div class="col px-2 text-muted">感谢你的积极参与，期待更多精彩内容！</div>
								<div style="width: 120px; text-align: left;">2024-9-12 13:54</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">东方玻璃</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">感谢你分享这么好的资源！</div>
								<div style="width: 120px; text-align: left;">2024-9-4 22:19</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">daliands</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+5</div>
								<div class="col px-2 text-muted">期待更多优质内容的分享，论坛有你更精彩！</div>
								<div style="width: 120px; text-align: left;">2024-8-12 18:37</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">养只猫不好么</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+2</div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-8-8 18:29</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">xiaoxiaojing</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+1</div>
								<div class="col px-2 text-muted">你的帖子非常有用，感谢分享！</div>
								<div style="width: 120px; text-align: left;">2024-8-6 17:44</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">genliese</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+5</div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-7-12 13:49</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">wx_Lyg_548</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">非常支持你的观点！</div>
								<div style="width: 120px; text-align: left;">2024-7-10 10:51</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">sinker_</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">你的分享对大家帮助很大，非常感谢！</div>
								<div style="width: 120px; text-align: left;">2024-6-26 14:48</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_psivnlna</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">谢谢你的细致分析，受益匪浅！</div>
								<div style="width: 120px; text-align: left;">2024-6-6 11:09</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">我是大古队长</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">你的分享对大家帮助很大，非常感谢！</div>
								<div style="width: 120px; text-align: left;">2024-6-4 11:07</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_8225963</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-6-1 11:25</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">百事可乐就好</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">感谢你的贡献，论坛因你而更加精彩！</div>
								<div style="width: 120px; text-align: left;">2024-5-31 16:09</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">Editor</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">谢谢你的细致分析，受益匪浅！</div>
								<div style="width: 120px; text-align: left;">2024-5-31 13:54</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">0xK4ws</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-29 17:36</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">asm_zhang</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-29 11:26</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">Payne-Wu</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-28 17:02</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">iamshy</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-28 14:42</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">Himeko</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-28 09:28</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">你瞒我瞒</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 15:01</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">咸鱼……</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 14:31</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">令狐双</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 14:03</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_skfgafxa</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 11:45</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_uvyukvot</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 11:04</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">发烧小孩</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 11:04</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">bmax</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 10:58</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">alienhe</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 10:14</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">Ram98</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 09:56</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">0xEA</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-27 09:55</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">Simp1er</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-26 18:21</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">随风而行aa</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-26 12:50</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">程序原</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-26 09:28</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">vay</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-26 08:54</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_fqpgmjss</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 23:35</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">mb_lpcoesnt</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 22:10</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">东关之南</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 18:04</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">科学上网</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 17:42</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">KerryS</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 17:07</div>
							</div>
														<div class="row mx-0 py-3 thumb_list_item" style="border-top: 1px dashed #cecece;">
								<div class="text-truncate" style="width: 100px;">珍惜Any</div>
								<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
								<div class="col px-2 text-muted">为你点赞~</div>
								<div style="width: 120px; text-align: left;">2024-5-25 16:37</div>
							</div>
													</div>
						<div class="py-3" id="thumbShowMore" style="border-top: 1px solid rgb(206, 206, 206); display: block;">
							<a href="javascript:;" style="color: #0099ee;">查看更多</a>
						</div>
					</div>
				</div>
							                
                                <style>
                    .reward_logo-list-1 {
                        max-width: 52px;
                        text-align: center;
                        white-space: nowrap;
                        overflow: hidden;
                        margin-left: 0.6rem !important;
                        margin-right: 0.6rem !important;
                    }
                    .avatar {
                        width: 3.5rem;
                        height: 3.5rem;
                    }
                    .mob_reward tbody td {
                        border: none!important;
                        
                    }
                    .mob_reward ._reward_tr {
                        
                        border-bottom: 1px dashed rgba(217, 229, 237, 0.59) !important;
                    }
                    @media screen and (max-width: 998px) {
                        .mob_reward {
                            display: none !important;
                        }
                        .avatar {
                            width: 2rem;
                                height: 2rem;
                        }
                        .reward_logo-list-1 {
                            max-width: 35px;
                            white-space: nowrap;
                            overflow: hidden;
                            margin-left: 0.2rem !important;
                            margin-right: 0.2rem !important;
                        }
                    }
                    </style>
                    <div class="card px-2 px-md-5 py-5" style="border: 1px solid #fff;">
                        <div>
                            <div class="text-center">
                                <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/dashanglogo.png" style="width: 18px;">
                                <div class="d-inline-block pl-1" style="height: 28px; line-height: 28px;">
                                    <span class="color4A4A4A" style="font-size: 13px;">打赏</span>
                                    <span style="color:#0eaaf1;">+&nbsp;15.00雪花</span>
                                </div>
                            </div>
                            <div class="pt-5 text-center">
                                                                                                                    <div class="d-inline-block mb-3 reward_logo-list-1 text-center px-0">
                                            <a style="border-radius: 5rem;" data-toggle="tooltip" data-html="true" title="" href="https://passport.kanxue.com/user-center-602912.htm" data-original-title="赞赏5.00雪花&lt;br&gt;orz1ruo">
                                                <img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/602912.png">
                                            </a> 
                                            <div class="text-center small mt-1"><a href="https://passport.kanxue.com/user-center-602912.htm" title="orz1ruo">orz1ruo</a></div>
                                        </div>
                                        
                                        
                                                                                <div class="d-inline-block mb-3 reward_logo-list-1 text-center px-0">
                                            <a style="border-radius: 5rem;" data-toggle="tooltip" data-html="true" title="" href="https://passport.kanxue.com/user-center-917768.htm" data-original-title="赞赏10.00雪花&lt;br&gt;憨豆爆发">
                                                <img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/917768.png">
                                            </a> 
                                            <div class="text-center small mt-1"><a href="https://passport.kanxue.com/user-center-917768.htm" title="憨豆爆发">憨豆爆发</a></div>
                                        </div>
                                        
                                        
                                                                                                        </div>
                            
                            <div class="mt-3 mob_reward">
                                <table class="table mb-0">
                                    <tbody>
                                        <tr><td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;" width="150">打赏次数<span style="color:#0eaaf1;">&nbsp;2</span></td>
                                        <td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;" width="100">雪花<span style="color:#0eaaf1;">&nbsp;+&nbsp;15.00</span></td>
                                        <td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;"><hr></td>
                                        <td class="p-0 text-right" style="border-bottom: 0;height: 24px;line-height: 24px;" width="100">
                                            <span class="collapse_btn" style="cursor: pointer;" data-toggle="collapse" href="#collapse_reward" aria-expanded="true" aria-controls="collapse_reward">
                                                <span>收起</span>&nbsp;<i class="icon icon-angle-up"></i>
                                            </span>
                                        </td>
                                    </tr></tbody>
                                </table>
                            </div>
                            <div class="collapse mob_reward show" id="collapse_reward">
                                <table class="table">
                                    <tbody>
                                                                                                                            <tr class="_reward_tr">
                                            <td class="px-0 py-3" width="150">
                                                <a href="https://passport.kanxue.com/user-center-602912.htm">
                                                    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/602912.png" alt="赞赏" style="width: 1.6rem;height: 1.6rem;border-radius: 1.6rem;">&nbsp;
                                                    <span>orz1ruo</span>
                                                </a>
                                            </td>
                                            <td class="px-0 py-3" width="100"><span style="color:#0eaaf1;">&nbsp; +5.00</span></td>
                                            <td class="px-0 py-3 text-muted">2024/05/25</td>
                                            <td class="px-0 py-3 text-muted">助人为乐～</td>
                                        </tr>
                                                                                    <tr class="_reward_tr">
                                            <td class="px-0 py-3" width="150">
                                                <a href="https://passport.kanxue.com/user-center-917768.htm">
                                                    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/917768.png" alt="赞赏" style="width: 1.6rem;height: 1.6rem;border-radius: 1.6rem;">&nbsp;
                                                    <span>憨豆爆发</span>
                                                </a>
                                            </td>
                                            <td class="px-0 py-3" width="100"><span style="color:#0eaaf1;">&nbsp; +10.00</span></td>
                                            <td class="px-0 py-3 text-muted">2024/05/25</td>
                                            <td class="px-0 py-3 text-muted"></td>
                                        </tr>
                                                                                                                            
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                
                <!--赞赏支持-->
                <div class="modal fade reward" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="exampleModalLabel">赞赏</h4>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">×</span>
                                            </button>
                                        </div>
                                        <form action="https://bbs.kanxue.com/thread-281889.htm" method="post" id="pay_kx" onsubmit="return topay()">
                                                <div class="modal-body ">
                                                        <div class="form-group mb-0">
                                                                <input name="ureward" type="hidden" value="819934">
                                                                <input type="hidden" name="reward_articleid" value="281889">
                                                                <div class="mb-3 text-center">
                                                                    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/dashang.png" class="avatar-3" alt="100">
                                                                </div>
                                                                
                                                                <div class="text-center mb-3">
                                                                    <div data-toggle="buttons">
                                                                        <label class="btn btn-outline-danger active" style="width:120px">
                                                                            <input type="radio" class="d-none" value="1" name="reward_rmbs" id="option1" autocomplete="off" checked="">1 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="5" name="reward_rmbs" id="option2" autocomplete="off">5 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="10" name="reward_rmbs" id="option3" autocomplete="off">10 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="20" name="reward_rmbs" id="option4" autocomplete="off">20 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="50" name="reward_rmbs" id="option5" autocomplete="off">50 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="80" name="reward_rmbs" id="option6" autocomplete="off">80 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="100" name="reward_rmbs" id="option7" autocomplete="off">100 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="150" name="reward_rmbs" id="option8" autocomplete="off">150 雪花
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="200" name="reward_rmbs" id="option9" autocomplete="off">200 雪花
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div>
                                                                    <label id="alipay_lab">
                                                                        <span>支付方式：</span>
                                                                        <input type="radio" value="1" checked="checked" name="reward_type" style="display:inline">
                                                                        <span class="alipay-bg"></span>
                                                                    </label>
                                                                    <label class="ml-3">
                                                                        <input type="radio" value="3" name="reward_type">
                                                                        <i class="icon icon-weixin" style="font-size:17px;color:#49BE38"></i> 微信支付
                                                                    </label>
                                                                                                                                        <label class="ml-3"><input type="radio" value="2" name="reward_type"> 余额（余额 0.00雪花）</label>
                                                                                                                                    </div>
                                                        </div>
                                                </div>
                                                <div class="px-3 mb-3">
                                                    <div class="mb-2">赞赏留言：
                                                        <select class="form-control form-control-sm reward_reason d-inline-block" style="max-width: 90px;">
                                                            <option value="0">快捷留言</option>
                                                            <option value="感谢分享～">感谢分享～</option>
                                                            <option value="精品文章～">精品文章～</option>
                                                            <option value="原创内容～">原创内容～</option>
                                                            <option value="精彩转帖～">精彩转帖～</option>
                                                            <option value="助人为乐～">助人为乐～</option>
                                                            
                                                        </select>
                                                    </div>
                                                    <textarea class="form-control reward_reason_textarea" name="brief" rows="1" readonly="">感谢分享～</textarea>
                                                    
                                                </div>
                                                <div class="modal-footer">
                                                        <button id="pay_submit" type="submit" class="btn btn-primary btn-pay kx-pay" data-loading-text="正在提交...">立即支付</button>
                                                </div>
                                        </form>
                                </div>
                        </div>
                </div>			<div class="card p-1">
				<div class="card-body">
					<table class="table postlist mb-0">
						<thead>
							<tr>
								<th colspan="2" class="pa-0  pb-1">
									<dl class="row">
										<dt>
											<b style="font-size: 16px;">最新回复</b> (<span class="posts">60</span>)
										</dt>
										<dd style="text-align: right;">
											

																						<nav class="text-right pagination-sm d-inline-block" style="height: 27px;">
												<ul class="pagination mt-0 mb-0"><li class="page-item active"><a href="https://bbs.kanxue.com/thread-281889-1.htm" class="page-link">1</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-2.htm" class="page-link">2</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-3.htm" class="page-link">3</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-2.htm" class="page-link">▶</a></li></ul>
											</nav>
											
										</dd>
									</dl>
								</th>
							</tr>
						</thead>
						<tbody>

															
				
																			
										
					

																													
										<tr class="post" data-pid="1768262">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-844633.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="844633">KerryS</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													2682													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/10.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-10" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(5223)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_104"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV4，RANK：40 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3180541" data-desc="883 小时，  19 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-844633.htm" class="item-count" style="font-size:1.1rem;">
												13												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-844633.htm" class="item-count" style="font-size:1.1rem;">
												53</a></div><a href="https://bbs.kanxue.com/user-post-844633.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-844633.htm" class="item-count" style="font-size:1.1rem;">
												20</a></div><a href="https://bbs.kanxue.com/user-fans-844633.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="844633">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=KerryS" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_104"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm">KerryS</a>
										
										<span class="huoyue_num iconfont icon-a-10"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768262" id="1768262" class="text-grey"><span class="floor">2</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								我怎么感觉直接去逆向分析风控sdk，看它上传了什么信息，更加简洁一点								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-25 17:07</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768262" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768262" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="844633" name="praised_uid">
		<input type="hidden" value="1768262" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">1</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768262" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768262" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768269">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/983172.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/983172.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-983172.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="983172">hacker521</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													1132													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/7.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-7" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(1872)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="548469" data-desc="152 小时，  6 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-983172.htm" class="item-count" style="font-size:1.1rem;">
												6												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-983172.htm" class="item-count" style="font-size:1.1rem;">
												79</a></div><a href="https://bbs.kanxue.com/user-post-983172.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-983172.htm" class="item-count" style="font-size:1.1rem;">
												24</a></div><a href="https://bbs.kanxue.com/user-fans-983172.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="983172">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=hacker521" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm">hacker521</a>
										
										<span class="huoyue_num iconfont icon-a-7"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768269" id="1768269" class="text-grey"><span class="floor">3</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								珍惜大佬出品，必属精品<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/3.gif" class="face" style="cursor: zoom-in;">								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-25 18:55</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768269" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768269" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="983172" name="praised_uid">
		<input type="hidden" value="1768269" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768269" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768269" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768303">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="904969" href="https://bbs.kanxue.com/user-home-904969.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/904969.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="904969" href="https://bbs.kanxue.com/user-home-904969.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/904969.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-904969.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="904969">mb_fssslkzs</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													1238													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/7.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-7" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(1810)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="591223" data-desc="164 小时，  7 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-904969.htm" class="item-count" style="font-size:1.1rem;">
												3												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-904969.htm" class="item-count" style="font-size:1.1rem;">
												63</a></div><a href="https://bbs.kanxue.com/user-post-904969.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-904969.htm" class="item-count" style="font-size:1.1rem;">
												24</a></div><a href="https://bbs.kanxue.com/user-fans-904969.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="904969">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=mb_fssslkzs" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="904969" href="https://bbs.kanxue.com/user-home-904969.htm">mb_fssslkzs</a>
										
										<span class="huoyue_num iconfont icon-a-7"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768303" id="1768303" class="text-grey"><span class="floor">4</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								tql，好喜欢这种硬核的知识帖子了，不仅学了知识，又了解安卓的前世今生								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-26 22:57</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768303" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768303" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="904969" name="praised_uid">
		<input type="hidden" value="1768303" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768303" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768303" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768315">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="939264" href="https://bbs.kanxue.com/user-home-939264.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/939264.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="939264" href="https://bbs.kanxue.com/user-home-939264.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/939264.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-939264.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="939264">tmi</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													1059													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/7.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-7" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(1530)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="513071" data-desc="142 小时，  6 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-939264.htm" class="item-count" style="font-size:1.1rem;">
												6												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-939264.htm" class="item-count" style="font-size:1.1rem;">
												63</a></div><a href="https://bbs.kanxue.com/user-post-939264.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-939264.htm" class="item-count" style="font-size:1.1rem;">
												14</a></div><a href="https://bbs.kanxue.com/user-fans-939264.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="939264">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=tmi" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="939264" href="https://bbs.kanxue.com/user-home-939264.htm">tmi</a>
										
										<span class="huoyue_num iconfont icon-a-7"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768315" id="1768315" class="text-grey"><span class="floor">5</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								厉害								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 09:53</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768315" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768315" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="939264" name="praised_uid">
		<input type="hidden" value="1768315" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768315" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768315" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768316">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="991111" href="https://bbs.kanxue.com/user-home-991111.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/991111.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="991111" href="https://bbs.kanxue.com/user-home-991111.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/991111.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-991111.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="991111">王小翊i</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													21													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/2.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-2" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(36)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="1214" data-desc="0 小时，  0 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star_0.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-991111.htm" class="item-count" style="font-size:1.1rem;">
												0												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-991111.htm" class="item-count" style="font-size:1.1rem;">
												2</a></div><a href="https://bbs.kanxue.com/user-post-991111.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-991111.htm" class="item-count" style="font-size:1.1rem;">
												0</a></div><a href="https://bbs.kanxue.com/user-fans-991111.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="991111">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8E%8B%E5%B0%8F%E7%BF%8Ai" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="991111" href="https://bbs.kanxue.com/user-home-991111.htm">王小翊i</a>
										
										<span class="huoyue_num iconfont icon-a-2"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768316" id="1768316" class="text-grey"><span class="floor">6</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								珍惜出品，必属精品								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 09:54</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768316" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768316" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="991111" name="praised_uid">
		<input type="hidden" value="1768316" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768316" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768316" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768317">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="803133" href="https://bbs.kanxue.com/user-home-803133.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/803133.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="803133" href="https://bbs.kanxue.com/user-home-803133.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/803133.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-803133.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="803133">0xEA</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													3110													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/9.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-9" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(4252)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="1534027" data-desc="426 小时，  12 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-803133.htm" class="item-count" style="font-size:1.1rem;">
												4												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-803133.htm" class="item-count" style="font-size:1.1rem;">
												88</a></div><a href="https://bbs.kanxue.com/user-post-803133.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-803133.htm" class="item-count" style="font-size:1.1rem;">
												1</a></div><a href="https://bbs.kanxue.com/user-fans-803133.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="803133">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=0xEA" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="803133" href="https://bbs.kanxue.com/user-home-803133.htm">0xEA</a>
										
										<span class="huoyue_num iconfont icon-a-9"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768317" id="1768317" class="text-grey"><span class="floor">7</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								tql								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 09:54</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768317" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768317" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="803133" name="praised_uid">
		<input type="hidden" value="1768317" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768317" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768317" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768318">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="860121" href="https://bbs.kanxue.com/user-home-860121.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/860121.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="860121" href="https://bbs.kanxue.com/user-home-860121.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/860121.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-860121.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="860121">hzzheyang</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4928													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/9.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-9" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(3956)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="1339222" data-desc="372 小时，  11 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-860121.htm" class="item-count" style="font-size:1.1rem;">
												0												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-860121.htm" class="item-count" style="font-size:1.1rem;">
												20</a></div><a href="https://bbs.kanxue.com/user-post-860121.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-860121.htm" class="item-count" style="font-size:1.1rem;">
												3</a></div><a href="https://bbs.kanxue.com/user-fans-860121.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="860121">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=hzzheyang" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="860121" href="https://bbs.kanxue.com/user-home-860121.htm">hzzheyang</a>
										
										<span class="huoyue_num iconfont icon-a-9"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768318" id="1768318" class="text-grey"><span class="floor">8</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								珍惜大佬太强了								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 09:56</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768318" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768318" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="860121" name="praised_uid">
		<input type="hidden" value="1768318" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768318" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768318" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768319">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image0" data-uid="990506" href="https://bbs.kanxue.com/user-home-990506.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="990506" href="https://bbs.kanxue.com/user-home-990506.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-990506.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="990506">mb_zfqvurgb</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													6													</a>
												</span>
											</div>
																																	<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_101"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV1，RANK：0 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="308788" data-desc="85 小时，  4 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-990506.htm" class="item-count" style="font-size:1.1rem;">
												0												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-990506.htm" class="item-count" style="font-size:1.1rem;">
												32</a></div><a href="https://bbs.kanxue.com/user-post-990506.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-990506.htm" class="item-count" style="font-size:1.1rem;">
												1</a></div><a href="https://bbs.kanxue.com/user-fans-990506.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="990506">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=mb_zfqvurgb" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_101"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="990506" href="https://bbs.kanxue.com/user-home-990506.htm">mb_zfqvurgb</a>
										
										<span class="huoyue_num iconfont icon-a-0"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768319" id="1768319" class="text-grey"><span class="floor">9</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								牛逼								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 09:56</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768319" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768319" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="990506" name="praised_uid">
		<input type="hidden" value="1768319" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768319" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768319" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768321">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="865985" href="https://bbs.kanxue.com/user-home-865985.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="865985" href="https://bbs.kanxue.com/user-home-865985.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-865985.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="865985">alienhe</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													529													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/8.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-8" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(2746)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_103"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars02.gif" alt="">
												<span class="small text-muted">( LV3，RANK：30 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="1033305" data-desc="287 小时，  10 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-865985.htm" class="item-count" style="font-size:1.1rem;">
												2												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-865985.htm" class="item-count" style="font-size:1.1rem;">
												7</a></div><a href="https://bbs.kanxue.com/user-post-865985.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-865985.htm" class="item-count" style="font-size:1.1rem;">
												24</a></div><a href="https://bbs.kanxue.com/user-fans-865985.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="865985">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=alienhe" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_103"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars02.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="865985" href="https://bbs.kanxue.com/user-home-865985.htm">alienhe</a>
										
										<span class="huoyue_num iconfont icon-a-8"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768321" id="1768321" class="text-grey"><span class="floor">10</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								太顶了								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 10:14</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768321" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768321" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="865985" name="praised_uid">
		<input type="hidden" value="1768321" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768321" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768321" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768323">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-832784.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="832784">小黄鸭爱学习</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													2341													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/9.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-9" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(4737)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="2691138" data-desc="747 小时，  17 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-832784.htm" class="item-count" style="font-size:1.1rem;">
												13												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												273</a></div><a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												117</a></div><a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="832784">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E5%B0%8F%E9%BB%84%E9%B8%AD%E7%88%B1%E5%AD%A6%E4%B9%A0" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">小黄鸭爱学习</a>
										
										<span class="huoyue_num iconfont icon-a-9"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768323" id="1768323" class="text-grey"><span class="floor">11</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<p>1<br></p>								
		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2024-5-27 10:39		
				被小黄鸭爱学习编辑
				
		，原因： 		
	</div>
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 10:39</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768323" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768323" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="832784" name="praised_uid">
		<input type="hidden" value="1768323" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768323" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768323" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768324">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-832784.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="832784">小黄鸭爱学习</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													2341													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/9.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-9" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(4737)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="2691138" data-desc="747 小时，  17 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-832784.htm" class="item-count" style="font-size:1.1rem;">
												13												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												273</a></div><a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												117</a></div><a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="832784">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E5%B0%8F%E9%BB%84%E9%B8%AD%E7%88%B1%E5%AD%A6%E4%B9%A0" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">小黄鸭爱学习</a>
										
										<span class="huoyue_num iconfont icon-a-9"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768324" id="1768324" class="text-grey"><span class="floor">12</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-844633.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png" style="cursor: zoom-in;">

			KerryS

		</a>

		我怎么感觉直接去逆向分析风控sdk，看它上传了什么信息，更加简洁一点

		</blockquote>理论上是&nbsp;但是不通用&nbsp;假设sdk不断更新或者你要面对数个app采集的时候。<br>时间就是金钱，这属于用设备成本换开发时间了。<br>假设团队只用3个人去对抗300个人的安全团队做采集，我举得时间还是挺宝贵的。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 10:40</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768324" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768324" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="832784" name="praised_uid">
		<input type="hidden" value="1768324" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">2</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768324" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768324" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768337">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768337" id="1768337" class="text-grey"><span class="floor">13</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-832784.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png" style="cursor: zoom-in;">

			小黄鸭爱学习

		</a>

		理论上是 但是不通用 假设sdk不断更新或者你要面对数个app采集的时候。
时间就是金钱，这属于用设备成本换开发时间了。
假设团队只用3个人去对抗300个人的安全团队做采集，我举得时间还是挺宝贵的 ... 

		</blockquote>有明白人，通用最好。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 15:30</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768337" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768337" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768337" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768337" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768337" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768348">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-832784.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="832784">小黄鸭爱学习</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													2341													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/9.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-9" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(4737)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="2691138" data-desc="747 小时，  17 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-832784.htm" class="item-count" style="font-size:1.1rem;">
												13												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												273</a></div><a href="https://bbs.kanxue.com/user-post-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												117</a></div><a href="https://bbs.kanxue.com/user-fans-832784.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="832784">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E5%B0%8F%E9%BB%84%E9%B8%AD%E7%88%B1%E5%AD%A6%E4%B9%A0" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="832784" href="https://bbs.kanxue.com/user-home-832784.htm">小黄鸭爱学习</a>
										
										<span class="huoyue_num iconfont icon-a-9"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768348" id="1768348" class="text-grey"><span class="floor">14</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-819934.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png" style="cursor: zoom-in;">

			珍惜Any

		</a>

		有明白人，通用最好。

		</blockquote>问题5：<br>你那么多台手机都聚集在一起不怕被封么？<br><br>这里能做的事情还是很多的，包括模拟日常使用。手机的高度陀螺仪检测，日常的使用电量模拟都能作为风控的指标。<br><br>自动化的触摸行为方式也要谨慎处理。<br><br>我的建议是做成一个手机仿真日常大模型去对抗大厂的风控大模型。<br>用大数据对抗大数据，用大模型对抗大模型，用AI对抗AI。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 16:48</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768348" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768348" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="832784" name="praised_uid">
		<input type="hidden" value="1768348" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768348" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768348" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768351">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768351" id="1768351" class="text-grey"><span class="floor">15</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-832784.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png" style="cursor: zoom-in;">

			小黄鸭爱学习

		</a>

		问题5：
你那么多台手机都聚集在一起不怕被封么？

这里能做的事情还是很多的，包括模拟日常使用。手机的高度陀螺仪检测，日常的使用电量模拟都能作为风控的指标。

自动化的触摸行为方式也要谨慎处 ... 

		</blockquote>嗯嗯&nbsp;感谢提醒&nbsp;，陀螺仪一般没权限去读的&nbsp;。电量hook了都是随机的。还有一些基础的也都模拟了。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 17:10</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768351" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768351" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768351" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768351" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768351" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768352">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-844633.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="844633">KerryS</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													2682													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/10.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-10" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(5223)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_104"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV4，RANK：40 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3180541" data-desc="883 小时，  19 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-844633.htm" class="item-count" style="font-size:1.1rem;">
												13												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-844633.htm" class="item-count" style="font-size:1.1rem;">
												53</a></div><a href="https://bbs.kanxue.com/user-post-844633.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-844633.htm" class="item-count" style="font-size:1.1rem;">
												20</a></div><a href="https://bbs.kanxue.com/user-fans-844633.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="844633">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=KerryS" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_104"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="844633" href="https://bbs.kanxue.com/user-home-844633.htm">KerryS</a>
										
										<span class="huoyue_num iconfont icon-a-10"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768352" id="1768352" class="text-grey"><span class="floor">16</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-832784.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/832784.png" style="cursor: zoom-in;">

			小黄鸭爱学习

		</a>

		理论上是 但是不通用 假设sdk不断更新或者你要面对数个app采集的时候。
时间就是金钱，这属于用设备成本换开发时间了。
假设团队只用3个人去对抗300个人的安全团队做采集，我举得时间还是挺宝贵的 ... 

		</blockquote>悟了，难怪标题说是四两拨千斤								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-27 17:59</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768352" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768352" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="844633" name="praised_uid">
		<input type="hidden" value="1768352" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768352" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768352" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768413">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="690300" href="https://bbs.kanxue.com/user-home-690300.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="690300" href="https://bbs.kanxue.com/user-home-690300.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-690300.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="690300">Gordonhat</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/5.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-5" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(499)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="215011" data-desc="59 小时，  3 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-690300.htm" class="item-count" style="font-size:1.1rem;">
												3												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-690300.htm" class="item-count" style="font-size:1.1rem;">
												15</a></div><a href="https://bbs.kanxue.com/user-post-690300.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-690300.htm" class="item-count" style="font-size:1.1rem;">
												2</a></div><a href="https://bbs.kanxue.com/user-fans-690300.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="690300">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=Gordonhat" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="690300" href="https://bbs.kanxue.com/user-home-690300.htm">Gordonhat</a>
										
										<span class="huoyue_num iconfont icon-a-5"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768413" id="1768413" class="text-grey"><span class="floor">17</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								请教下，magisk+lsposed&nbsp;去hook&nbsp;server进程有什么风险吗，还是说为了适配高版本的android，才自己实现一个lsposed								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-29 10:06</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768413" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768413" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="690300" name="praised_uid">
		<input type="hidden" value="1768413" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768413" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768413" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768415">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768415" id="1768415" class="text-grey"><span class="floor">18</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-690300.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png" style="cursor: zoom-in;">

			Gordonhat

		</a>

		请教下，magisk+lsposed 去hook server进程有什么风险吗，还是说为了适配高版本的android，才自己实现一个lsposed

		</blockquote>没任何风险，hook&nbsp;server&nbsp;不会涉及目标Apk进程hook所以没任何风险&nbsp;。为啥自己实现一个Lsposed，是为了定制化，根据自己逻辑去完善。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-29 10:33</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768415" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768415" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768415" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768415" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768415" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768420">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/983172.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/983172.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-983172.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="983172">hacker521</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													1132													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/7.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-7" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(1872)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="548469" data-desc="152 小时，  6 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-983172.htm" class="item-count" style="font-size:1.1rem;">
												6												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-983172.htm" class="item-count" style="font-size:1.1rem;">
												79</a></div><a href="https://bbs.kanxue.com/user-post-983172.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-983172.htm" class="item-count" style="font-size:1.1rem;">
												24</a></div><a href="https://bbs.kanxue.com/user-fans-983172.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="983172">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=hacker521" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="983172" href="https://bbs.kanxue.com/user-home-983172.htm">hacker521</a>
										
										<span class="huoyue_num iconfont icon-a-7"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768420" id="1768420" class="text-grey"><span class="floor">19</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-690300.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png" style="cursor: zoom-in;">

			Gordonhat

		</a>

		请教下，magisk+lsposed 去hook server进程有什么风险吗，还是说为了适配高版本的android，才自己实现一个lsposed

		</blockquote>lsposed&nbsp;国外大神接手的开源版本已经兼容到Android&nbsp;15了								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-29 15:11</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768420" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768420" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="983172" name="praised_uid">
		<input type="hidden" value="1768420" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768420" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768420" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768426">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768426" id="1768426" class="text-grey"><span class="floor">20</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-983172.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/983172.png" style="cursor: zoom-in;">

			hacker521

		</a>

		lsposed 国外大神接手的开源版本已经兼容到Android 15了

		</blockquote>可以尝试自己搞搞，没几行代码，lsplant支持15的。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-29 16:34</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768426" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768426" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768426" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768426" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768426" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768565">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="788622" href="https://bbs.kanxue.com/user-home-788622.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/788622.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="788622" href="https://bbs.kanxue.com/user-home-788622.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/788622.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-788622.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="788622">初恒</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													816													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/7.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-7" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(1943)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_103"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars02.gif" alt="">
												<span class="small text-muted">( LV3，RANK：20 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="1128451" data-desc="313 小时，  10 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-788622.htm" class="item-count" style="font-size:1.1rem;">
												5												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-788622.htm" class="item-count" style="font-size:1.1rem;">
												43</a></div><a href="https://bbs.kanxue.com/user-post-788622.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-788622.htm" class="item-count" style="font-size:1.1rem;">
												14</a></div><a href="https://bbs.kanxue.com/user-fans-788622.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="788622">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E5%88%9D%E6%81%92" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_103"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars02.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="788622" href="https://bbs.kanxue.com/user-home-788622.htm">初恒</a>
										
										<span class="huoyue_num iconfont icon-a-7"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768565" id="1768565" class="text-grey"><span class="floor">21</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								珍惜大佬,&nbsp;app厂商上&nbsp;tee怎么破。<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/40.gif" class="face" style="cursor: zoom-in;">								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-31 18:50</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768565" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768565" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="788622" name="praised_uid">
		<input type="hidden" value="1768565" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768565" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768565" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768592">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768592" id="1768592" class="text-grey"><span class="floor">22</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-788622.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/788622.png" style="cursor: zoom-in;">

			初恒

		</a>

		珍惜大佬, app厂商上 tee怎么破。[em_40]

		</blockquote>很好的问题，目前就tee解锁验证,github有一个项目，是hook密钥的方式去绕过的，还有一种办法是直接在内核tee这块进行处理&nbsp;。								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-5-31 21:57</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768592" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768592" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768592" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768592" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768592" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768668">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/796003.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/796003.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-796003.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="796003">霸业</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													7													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/5.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-5" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(496)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="220917" data-desc="61 小时，  3 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-796003.htm" class="item-count" style="font-size:1.1rem;">
												0												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-796003.htm" class="item-count" style="font-size:1.1rem;">
												17</a></div><a href="https://bbs.kanxue.com/user-post-796003.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-796003.htm" class="item-count" style="font-size:1.1rem;">
												4</a></div><a href="https://bbs.kanxue.com/user-fans-796003.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="796003">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E9%9C%B8%E4%B8%9A" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm">霸业</a>
										
										<span class="huoyue_num iconfont icon-a-5"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768668" id="1768668" class="text-grey"><span class="floor">23</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<p>难搞:)</p>								
		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2024-6-1 17:14		
				被霸业编辑
				
		，原因： 		
	</div>
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-6-1 13:55</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768668" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768668" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="796003" name="praised_uid">
		<input type="hidden" value="1768668" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768668" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768668" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768679">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image2" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-819934.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="819934">珍惜Any</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													4592													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/12.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-12" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(14363)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_109"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
												<span class="small text-muted">( LV9，RANK：230 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-819934.htm" class="item-count" style="font-size:1.1rem;">
												30												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												396</a></div><a href="https://bbs.kanxue.com/user-post-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												1312</a></div><a href="https://bbs.kanxue.com/user-fans-819934.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-followed w-100 follow_btn" data-cuid="819934">
													已关注
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_109"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars03.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
										
										<span class="huoyue_num iconfont icon-a-12"></span>
									</span>
																			<a href="https://bbs.kanxue.com/user-819934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 3</span>
										</a>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768679" id="1768679" class="text-grey"><span class="floor">24</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-796003.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/796003.png" style="cursor: zoom-in;">

			霸业

		</a>

		佬，drm指纹，tee应该是keystone，这些 binder通信服务， 您是怎么知道哪个进程响应客户端的请求呢。
我之前想在kernel里面拦截binder流量做所有，mock，难搞:)

		</blockquote>不要想了，死路一条。drm直接ptrace，他是走的native的binder								
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-6-1 16:28</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768679" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768679" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="819934" name="praised_uid">
		<input type="hidden" value="1768679" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768679" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768679" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
																			
										
					

																													
										<tr class="post" data-pid="1768685">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<div class="position-relative avatar_hover">
								<a class="d-inline-block position-relative avatar_box photo_frame photo_frame_image1" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm" tabindex="-1">
									<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/796003.png">
								</a>
								<div class="position-absolute thread-poptip-box bg-white text-left p-4">
									<div class="row mx-0">
										<div>
											<a class="d-inline-block avatar_box" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm">
												<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/796003.png">
											</a>
										</div>
										<div class="col">
											<div class="pb-2">
												<a href="https://bbs.kanxue.com/user-home-796003.htm">
												<span style="font-size: 16px; font-weight: bolder;" class="username_box" data-uid="796003">霸业</span>
												</a>
											</div>
											<div class="pb-2 position-relative">
												<span class="small text-muted">雪&nbsp;&nbsp;&nbsp;&nbsp;币：</span>
												<span class="small text-muted">
													<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
													7													</a>
												</span>
											</div>
																																	<div class="pb-2 position-relative">
												<span class="small text-muted">活跃值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<!-- <img class="position-absolute huoyue_num" src="/view/img/rank/5.png" width="22" alt="活跃值"> -->
												<span class="position-absolute huoyue_num iconfont icon-a-5" style="top:-3px"></span>
											</a>
												<span class="small text-muted" style="margin-left: 25px;">(496)</span>
											</div>
																						<div class="pb-2 small">
												<span class="small text-muted">能力值：</span>
												<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted">
												<svg class="icon" aria-hidden="true">
													<use xlink:href="#icon-group_102"></use>
												</svg>
												</a>
												<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars01.gif" alt="">
												<span class="small text-muted">( LV2，RANK：10 )</span>
												
											</div>
											<div class="pb-2" style="font-size: 0;">
												<span class="small text-muted" style="vertical-align: middle;">在线值：</span>
												<a href="https://bbs.kanxue.com/thread-249442.htm">
													<span class="post_online_time" style="vertical-align: middle;" data-online_time="220917" data-desc="61 小时，  3 级"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
												</a>
												<span class="post_online_time1 text-muted small" style="vertical-align: middle;"></span>
											</div>
										</div>
										
									</div>
									
									<div class="pb-3 pt-2 row mx-0 text-muted text-center">
										<div class="col">
											<div class="small mb-2">发帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-796003.htm" class="item-count" style="font-size:1.1rem;">
												0												</a>
											</div>
										</div>
										<div class="col" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
											<div class="small mb-2">回帖</div>
											<div>
												<a href="https://bbs.kanxue.com/user-post-796003.htm" class="item-count" style="font-size:1.1rem;">
												17</a></div><a href="https://bbs.kanxue.com/user-post-796003.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										<div class="col">
											<div class="small mb-2">粉丝</div>
											<div>
												<a href="https://bbs.kanxue.com/user-fans-796003.htm" class="item-count" style="font-size:1.1rem;">
												4</a></div><a href="https://bbs.kanxue.com/user-fans-796003.htm" class="item-count" style="font-size:1.1rem;">
												</a>
										</div>
										
										
									</div>
									<div class="row mx-0">
										<!--当前用户是否关注了$_post['user']['uid'] -->
																														<div class="col-6">
																							<a class="btn btn-0099ee w-100 follow_btn" data-cuid="796003">
													<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus" style="vertical-align: middle; color: #fff;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
													<span style="vertical-align: middle;display: inline-block;">关注</span>
												</a>
																						
										</div>
										<div class="col-6">
											<a href="https://www.kanxue.com/pm-send.htm?name=%E9%9C%B8%E4%B8%9A" class="btn bg-white w-100" style="border: 1px solid #0099ee; color:#0099ee;">
												私信
											</a>
										</div>

									</div>
								</div>
							</div>
							<div class="mt-2">
								
								<svg class="icon" aria-hidden="true">
									<use xlink:href="#icon-group_102"></use>
								</svg>
							</div>
							<!-- <div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="//bbs.kanxue.com/view/img/stars01.gif" alt=""> </div>
							</div> -->
							
							
						</td>
						<td class="px-0">
							<dl class="row ">
								<dt>
									
									<div>
									<span class="username font-weight-bold">
										<a class="username_box" data-uid="796003" href="https://bbs.kanxue.com/user-home-796003.htm">霸业</a>
										
										<span class="huoyue_num iconfont icon-a-5"></span>
									</span>
																		
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1 small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										

									</div>
																		<a href="https://bbs.kanxue.com/thread-281889-1.htm#1768685" id="1768685" class="text-grey"><span class="floor">25</span> 楼</a>
									
	
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-2 break-all">
																								<blockquote class="blockquote">

		<a href="https://bbs.kanxue.com/user-819934.htm" class="text-small text-muted user">

			<img class="avatar-1" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png" style="cursor: zoom-in;">

			珍惜Any

		</a>

		不要想了，死路一条。drm直接ptrace，他是走的native的binder

		</blockquote>								
		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2024-6-1 17:14		
				被霸业编辑
				
		，原因： 		
	</div>
																																
								
							</div>
							<div class="row mx-0 mt-3">
								<div class="col px-0">
									<span class="date text-grey small ml-1">2024-6-1 17:12</span>
								</div>
								<div class="small">
									<div class="check_input_box d-inline-block"></div>
									<div class="d-none d-lg-inline-block">
																																						
										
																				<a href="javascript:void(0)" tid="281889" pid="1768685" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										
										
																			
										

	

										
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768685" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
									
										<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="281889" name="threadid">
		<input type="hidden" value="796003" name="praised_uid">
		<input type="hidden" value="1768685" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																																						<a href="javascript:void(0)" tid="281889" pid="1768685" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="281889" data-pid="1768685" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
																	</div>
							</div>
						</td>
					</tr>
								
				
														<tr class="post">
								<td class="td-avatar" aria-hidden="true">
									<a class="d-inline-block position-relative  photo_frame photo_frame_image0" href="https://bbs.kanxue.com/user-1021299.htm" aria-hidden="true" tabindex="-1">
										<img class="avatar-3" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/avatar.png">
									</a>
								</td>
								<td class="p-l-0">
									<form action="https://bbs.kanxue.com/post-create-281889-1.htm" method="post" id="quick_reply_form">
										<input type="hidden" name="doctype" value="1">
										<input type="hidden" name="return_html" value="1">
										<input type="hidden" name="quotepid" value="0">
										<dl class="row small text-muted">
											<dt class="username ">mb_zwojibcx</dt>
											<dd class="text-right text-grey">
																									<span style="color: #ee3000;">温馨提示：点击 <strong>引用</strong> 按钮再回帖，可回复并 <strong>短消息</strong> 提示对方</span>
																							</dd>
										</dl>
										<div class="message mt-1">
											<fieldset class="form-group mb-0">
																								<textarea class="form-control" placeholder="内容" name="message" id="message"></textarea>
																							</fieldset>
										</div>
										<div class="text-muted mt-3 small face_open">
											<dl class="row">
												<dt>
													
													<button type="submit" class="btn btn-sm btn-primary px-3" id="submit" data-loading-text="正在提交...">回帖</button>
													
													<span class="emotion ml-3">表情</span>
													<span class="ml-3 d-none d-lg-inline-block"><a href="https://bbs.pediy.com/thread-247709.htm" target="_bank" style="color: #0099ee;">雪币赚取及消费</a></span>
												</dt>
												<dd class="text-right vtop">
																										
													<a class="icon-mail-reply text-muted senior_reply" href="javascript:void(0);" id="advanced_reply"> 高级回复</a>
													
																									</dd>
											</dl>
										</div>
									</form>
								</td>
							</tr>
													</tbody>
					</table>
				</div>
			</div>
			

						<nav class="text-right">
				<ul class="pagination my-1 justify-content-center"><li class="page-item active"><a href="https://bbs.kanxue.com/thread-281889-1.htm" class="page-link">1</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-2.htm" class="page-link">2</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-3.htm" class="page-link">3</a></li><li class="page-item"><a href="https://bbs.kanxue.com/thread-281889-2.htm" class="page-link">▶</a></li></ul>
			</nav>
					
			
			
			
			<a role="button" class="btn btn-secondary btn-block xn-back my-3 mx-auto" style="max-width: 50%;" href="javascript:history.back();">返回</a>
		</div>
	</div>
	<div class="col-lg-3 pr-0 hidden-sm hidden-md" style="padding-left: 15px;">
		<div class="right_content positionSticky position-sticky" style="top:80px;">
			<div class="rightbox_card_hidden">
				<div class="card mb-3 position-relative ">
					<div class="py-4 px-4">
						<div class="row mx-0">
							<div>
								<!-- <a class="d-inline-block position-relative photo_frame photo_frame_image2" href="user-home-819934.htm" aria-hidden="true" tabindex="-1"> -->
								<a class="d-inline-block position-relative avatar_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm" aria-hidden="true" tabindex="-1">
									<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/819934.png" style="width: 4.5rem; height:  4.5rem; border-radius: 5rem;">
								</a>
							</div>
							
							<div class="col pr-0">
								<div>
									<span style="font-size: 16px;" class="font-weight-bold">
										<a class="username_box" data-uid="819934" href="https://bbs.kanxue.com/user-home-819934.htm">珍惜Any</a>
									</span>
																		<div class="d-inline-block" style="font-size: 1rem; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
										<a href="https://bbs.kanxue.com/user-819934-1-1.htm">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger">
												3</span>
										</a>
									</div>
																	</div>
								<div class="mt-1">
									<span class="huoyue_num iconfont icon-a-12" data-desc="活跃值：14363，12级" onmouseenter="show_online_level(event)"></span>
									
									<a href="https://bbs.kanxue.com/thread-260144.htm" class="text-muted" data-desc="能力值：230， LV9" onmouseenter="show_online_level(event)">
										<svg class="icon" aria-hidden="true">
											<use xlink:href="#icon-group_109">
											</use>
										</svg>
									</a>
									<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/stars03.gif" alt="">
								</div>
								<div class="mt-1">
									<span class="post_online_time" style="vertical-align: middle;" data-online_time="3629111" data-desc="1008 小时，  20 级" onmouseenter="show_online_level(event)"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>

								</div>
							</div>
						</div>
						<div class="row mx-0 my-4 text-center">
							<div class="col px-0">
								<div style="font-size: 1.4rem;">
									<a class="item-count" href="https://bbs.kanxue.com/homepage-819934.htm" target="_blank">
										30									</a>
								</div>
								<div class="small" style="color: #888888;">发帖</div>
							</div>
							<div class="col px-0" style="border-left: 1px solid #e6e8eb;border-right: 1px solid #e6e8eb;">
								<div style="font-size: 1.4rem;">
									<a class="item-count" href="https://bbs.kanxue.com/homepage-post-819934.htm" target="_blank">
										396									</a>
								</div>
								<div class="small" style="color: #888888;">回帖</div>
							</div>
							<div class="col px-0">
								<div style="font-size: 1.4rem;">
									<a class="item-count" href="https://bbs.kanxue.com/thread-260144.htm" target="_blank">
										230									</a>
								</div>
								<div class="small" style="color: #888888;">RANK</div>
							</div>
						</div>
						<div class="px-1 row mx-0">
							<div class="col-6">
																<a class="btn btn-followed w-100 follow_btn py-1" data-cuid="819934">
									已关注
								</a>
															</div>
							<div class="col-6">
								<a href="https://www.kanxue.com/pm-send.htm?name=%E7%8F%8D%E6%83%9CAny" class="btn bg-white w-100 py-1" style="border: 1px solid #0099ee; color:#0099ee;">
									<!-- <i class="icon-envelope"></i> -->
									私信
								</a>
							</div>

						</div>
					</div>
				</div>

				<div class="card mb-3 py-3 show_tocbot " style="display: block;">
					<div id="js-toc" class="js-toc"><ol class="toc-list "><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_0" class="toc-link node-name--H1 ">自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤？</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_1" class="toc-link node-name--H1 ">背景：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_2" class="toc-link node-name--H1 ">模拟战争环境：</a><ol class="toc-list  is-collapsible"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_0" class="toc-link node-name--H2 ">对手模拟：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_1" class="toc-link node-name--H2 ">对抗模拟：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_2" class="toc-link node-name--H2 ">客户端架构：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_0" class="toc-link node-name--H3 ">设备指纹分类：</a></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_3" class="toc-link node-name--H2 ">设备指纹对抗：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_4" class="toc-link node-name--H2 ">前置准备 ：</a><ol class="toc-list  is-collapsible"><li class="toc-list-item is-active-li"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_1" class="toc-link node-name--H3  is-active-link">Magisk模块基础：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_2" class="toc-link node-name--H3 ">Magisk模块如何实现一个Xposed ?</a></li></ol></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_3" class="toc-link node-name--H1 ">设备指纹对抗：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_5" class="toc-link node-name--H2 ">设备指纹相关的对抗（system_service）</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_6" class="toc-link node-name--H2 ">其他Apk相关Hook :</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_7" class="toc-link node-name--H2 ">内核ID相关Hook：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_8" class="toc-link node-name--H2 ">Init进程设备指纹相关：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_3" class="toc-link node-name--H3 ">1、所以我们需要得到目标进程dlopen，malloc （用于分配字符串）的地址 。</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_4" class="toc-link node-name--H3 ">2、远端进程打开我们自己的SO文件</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_5" class="toc-link node-name--H3 ">3、Hack DRM</a></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_9" class="toc-link node-name--H2 ">Getprop指纹修改：</a></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_4" class="toc-link node-name--H1 ">设备指纹采集反思&amp;总结：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_10" class="toc-link node-name--H2 ">1、我们可以自己去NDK里面把libc.so的动态库编译到我们自己的so里面 。而不走系统的libc 。</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_11" class="toc-link node-name--H2 ">2、我们应该尽可能的不要使用c++ 里面的string</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_12" class="toc-link node-name--H2 ">3、单字段多形式获取</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h2_13" class="toc-link node-name--H2 ">4、基础环境检测</a></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_5" class="toc-link node-name--H1 ">一机多号实现：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_6" class="toc-link node-name--H1 ">对抗总结：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_6" class="toc-link node-name--H3 ">问题1：</a><ol class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_7" class="toc-link node-name--H3 ">问题2：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_8" class="toc-link node-name--H3 ">问题3：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_9" class="toc-link node-name--H3 ">问题4：</a></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h3_10" class="toc-link node-name--H3 ">问题5：</a></li></ol></li></ol></li><li class="toc-list-item"><a href="https://bbs.kanxue.com/thread-281889.htm#msg_header_h1_7" class="toc-link node-name--H1 ">结尾：</a></li></ol></div>
				</div>
			</div>
			<div class="card mb-3 pb-3" style="color: #bbbbbb;">
				<div class="py-2 px-3 mb-2" style="color: #333333;border-bottom: 1px solid #eeeeee; font-weight: 600;font-size: 16px;">
					<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-terminal" style="vertical-align: middle;"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg> 他的文章
				</div>
				<div class="px-3">
					<ul class="pl-4">
										<li class="mb-2">
						<a href="https://bbs.kanxue.com/thread-281889.htm" style="color: #494b4d; font-size: 13px;">[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤?</a>
						<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
						<span class="small">49664</span>
					</li>
										<li class="mb-2">
						<a href="https://bbs.kanxue.com/thread-278982.htm" style="color: #494b4d; font-size: 13px;">聊聊Android签名检测7种核心检测方案详解</a>
						<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
						<span class="small">69167</span>
					</li>
										<li class="mb-2">
						<a href="https://bbs.kanxue.com/thread-277637.htm" style="color: #494b4d; font-size: 13px;">[原创]聊聊大厂设备指纹其三&amp;如何在风控对抗这场“猫鼠游戏”中转换角色</a>
						<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
						<span class="small">73599</span>
					</li>
										<li class="mb-2">
						<a href="https://bbs.kanxue.com/thread-277402.htm" style="color: #494b4d; font-size: 13px;">[原创]聊聊大厂设备指纹其二&amp;Hunter环境检测思路详解!</a>
						<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
						<span class="small">129741</span>
					</li>
										<li class="mb-2">
						<a href="https://bbs.kanxue.com/thread-276842.htm" style="color: #494b4d; font-size: 13px;">il2cpp方法回溯监听&amp;Dump优化</a>
						<svg style="vertical-align: middle;" t="1732758196414" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12069" width="12" height="12"><path d="M947.949268 880.889756H76.050732c-18.481951 0-33.592195-14.985366-33.592195-33.592195V176.577561c0-18.481951 14.985366-33.592195 33.592195-33.592195 18.481951 0 33.592195 14.985366 33.592195 33.592195v637.252683h838.431219c18.481951 0 33.592195 14.985366 33.592195 33.592195-0.124878 18.481951-15.110244 33.467317-33.717073 33.467317z m0 0" fill="#797c80" p-id="12070"></path><path d="M210.54439 680.085854c-8.616585 0-17.108293-3.246829-23.601951-9.740488-13.112195-13.112195-13.112195-34.341463-0.124878-47.453659l167.336585-168.085853c6.243902-6.36878 14.860488-9.865366 23.72683-9.865366s17.482927 3.496585 23.726829 9.865366l110.392195 110.392195L823.69561 253.502439c13.112195-13.112195 34.341463-13.112195 47.453658 0s13.112195 34.341463 0 47.453659L535.726829 636.378537c-13.112195 13.112195-34.341463 13.112195-47.453658 0l-110.392195-110.392196-143.609756 144.234147c-6.618537 6.493659-15.110244 9.865366-23.72683 9.865366z m0 0" fill="#797c80" p-id="12071"></path></svg>
						<span class="small">17308</span>
					</li>
									</ul>
				</div>
			</div>
						<div class="bg-white mb-3 position-relative">
				<a id="thread_ad" data-thread_postdata="2_19_15" data-href="https://www.kanxue.com/book-leaflet-173.htm" href="javascript:void(0);">
					<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/_202407261723_F2TH9YM6E8YEUXE.jpg" class="w-100" alt="">
					<span id="diff_day" class="position-absolute" style="bottom: 1.6rem; left: 5rem; font-size: 40px; color: #00dfff;"></span>
				</a>
			</div>
						<div class="card mb-3 pb-0 ggBox">
				<!-- <ins class="adsbygoogle"
				style="display:block"
				data-ad-client="ca-pub-1585618761901261"
				data-ad-slot="9305151825"
				data-ad-format="auto"
				data-full-width-responsive="true"></ins> -->
				<ins class="adsbygoogle adsbygoogle-ablated-ad-slot" style="display: inline-block; width: 0px; height: 0px; margin: 0px auto;" data-ad-client="ca-pub-1585618761901261" data-ad-slot="9305151825" data-adsbygoogle-status="done" google_element_uid="1"></ins>

			</div>
			<div class="card mb-3 px-2 py-3">
				<div class="row mx-0 text-center small pb-3" style="border-bottom: 1px solid #ececec;">
					<div class="col-4 px-0" style="border-right: 1px solid #ececec;"><a class="text-muted" href="https://zhuanlan.kanxue.com/article-56.htm">关于我们</a></div>
					<div class="col-4 px-0" style="border-right: 1px solid #ececec;"><a class="text-muted" href="https://www.kanxue.com/user-online_sendmsg.htm">联系我们</a></div>
					<div class="col-4 px-0"><a class="text-muted" href="https://qifu.kanxue.com/">企业服务</a></div>
				</div>
				<div class="pt-3 small">
					<img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/gongzhonghao.png" style="max-width: 80px; float: left;" alt="">
					<div class="px-2 py-2 text-muted" style="overflow: hidden;">
						<div>看雪公众号</div>
						<div>专注于PC、移动、智能设备安全研究及逆向工程的开发者社区</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!--谁下载-->

<!-- 图片查看 -->
<style>
	#imageViewerOuterdiv .showDrawing {
		display: none;
		cursor: pointer;
	}
	#imageViewerInnerdiv:hover .showDrawing {
		display: inline-block;
	}
</style>
<div id="imageViewerOuterdiv" style="position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:2;width:100%;height:100%;display:none;">
	<div id="imageViewerInnerdiv" style="position:absolute;">
		<img id="bigimg" style="border:5px solid #fff; cursor: zoom-out;" src="https://bbs.kanxue.com/thread-281889.htm">
		<span class="px-3 showDrawing" style="border-radius: 10rem; position:absolute;z-index: 1; top: 10px; right: 10px; background: #0066cc;color: #fff;">看原图</span>
	</div>
</div>
<!-- 赞 -->
<div class="modal fade" id="thumbModal" tabindex="-1" aria-labelledby="thumbModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="exampleModalLabel">赞赏</h5>
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">×</span>
		  </button>
		</div>
		<div class="modal-body">
			<div class="row mx-0" style="flex-wrap: nowrap; align-items: center;">
			  	<div class="col-form-label pr-3">雪币:</div>
			  	<div>
					<div class="input-group">
						<input type="number" class="form-control" value="0" min="0" max="10" id="thumb-xb" style="max-width: 6rem;">
						<div class="input-group-append">
							<button class="btn btn-outline-secondary" type="button" id="addThumbXb">+</button>
						</div>
					</div>
				</div>
			</div>
			<div class="form-group mt-3">
			  <div class="col-form-label row mx-0">
				<div class="pr-3">留言:</div>
				<div class="col px-0 ">
					<select class="form-control form-control-sm reward_reason d-inline-block" style="max-width: 6rem;" data-gtm-form-interact-field-id="0">
						<option value="0">快捷留言</option>
					<option value="非常支持你的观点！">非常支持你的观点！</option><option value="这个讨论对我很有帮助，谢谢！">这个讨论对我很有帮助，谢谢！</option><option value="感谢你分享这么好的资源！">感谢你分享这么好的资源！</option><option value="谢谢你的细致分析，受益匪浅！">谢谢你的细致分析，受益匪浅！</option><option value="感谢你的积极参与，期待更多精彩内容！">感谢你的积极参与，期待更多精彩内容！</option><option value="感谢你的贡献，论坛因你而更加精彩！">感谢你的贡献，论坛因你而更加精彩！</option><option value="你的分享对大家帮助很大，非常感谢！">你的分享对大家帮助很大，非常感谢！</option><option value="期待更多优质内容的分享，论坛有你更精彩！">期待更多优质内容的分享，论坛有你更精彩！</option><option value="你的帖子非常有用，感谢分享！">你的帖子非常有用，感谢分享！</option><option value="请遵守论坛规则，避免发布广告内容！">请遵守论坛规则，避免发布广告内容！</option><option value="请注意发帖规范，保持良好的讨论环境！">请注意发帖规范，保持良好的讨论环境！</option></select>
				</div>
				<div><i class="icon icon-refresh text-muted thumb-text-refresh" style="cursor: pointer;"></i></div>
			  </div>
			  <div>
				<textarea class="form-control" id="thumb-text" readonly="">为你点赞！</textarea>
			  </div>
			  
			</div>
		</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
		  <button type="button" class="btn btn-primary thumbPost">确定</button>
		</div>
	  </div>
	</div>
</div>
<div class="modal fade" id="fullScreenModal" tabindex="-1" aria-labelledby="fullScreenModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-xl" style="width: 90%;max-width: 80%;">
		<div class="modal-content" style="background-color: #1b2426 !important;"></div>
	</div>
</div>



</div>

</main>


<div class="container px-0 pb-3">

<div class="row mx-0 bbs_footer_at_column hidden-sm hidden-md" style="text-align: center; height: 76px;">

    <div class="col-md-6 px-0" style="height: 100%;">

    <a href="https://bbs.kanxue.com/thread-280627.htm" style="height: 100%;" target="_blank">

    <!-- <p></p > -->

    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/_202402261148_83HQJQM8T2UNKHC.png" width="100%" height="100%">



    </a>

    </div>

    <div class="col-md-6 px-0" style="height: 100%;">

    <a href="https://www.kanxue.com/book-leaflet-83.htm" style="height: 100%;" target="_blank">

    <!-- <p></p > -->

    <img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/_202211071314_TJXM7FJJ2AJJ4H6.jpg" width="100%" height="100%">

    </a>

    </div>

</div>

</div>



<footer id="footer" style="background: #3b4348; color: #9ba4aa; height: auto;">
	<div class="container">
		<div class="row text-muted small my-3 mx-0" id="web_base_company_information">
			<div class="col-12 col-md-6">
				©2000-2025 看雪 | Based on <a href="http://bbs.xiuno.com/" target="_blank" class="text-muted">Xiuno BBS</a><br>
				域名：<a href="https://www.yunaq.com/" target="_blank" class="text-muted">加速乐</a> |
				SSL证书：<a href="https://www.trustasia.com/trustasia" target="_blank" class="text-muted">亚洲诚信</a> |
				<a href="http://dun.163.com/?from=kanxue_DDoS_2018&amp;hmsr=kanxue%C2%A0" target="_blank" class="text-muted">安全网易易盾</a>

			</div>
			<div class="col-12 col-md-6 pt-2 pt-md-0 text-md-right">
				
				<span><a class="text-muted" href="https://ce.kanxue.com/project-test_read-538.htm">看雪SRC</a></span> |
				<span><a class="text-muted" href="https://bbs.kanxue.com/thread-260116.htm">看雪APP</a></span> |
				<span>公众号：ikanxue</span> |
				<a class="text-muted" href="https://zhuanlan.kanxue.com/article-56.htm">关于我们</a> |
				<a class="text-muted" href="https://www.kanxue.com/user-online_sendmsg.htm">联系我们</a> |
				<a href="https://zhuanlan.kanxue.com/article-1.htm" class="text-muted">企业服务</a> <br>
				Processed: <b>0.065</b>s, SQL:
				<b>119</b> / <a class="text-muted" href="http://beian.miit.gov.cn/" target="_blank">沪ICP备2022023406号</a> / <a class="text-muted" href="http://www.beian.gov.cn/portal/registerSystemInfo?domainname=%27pediy.com%27&amp;recordcode=31011502006611" target="_blank">沪公网安备 31011502006611号</a>

			</div>
		</div>
		<!-- <div style="max-height: 100px; overflow-y:auto;">
					</div> -->
	</div>
</footer>



<!--[if lt IE 9]>
	<script>window.location = 'browser.htm';</script>
	<![endif]-->



<style>
@keyframes slideInLeft {
  0% { transform: translateX(0); } /* 初始状态，元素处于最右侧 */
  100% { transform: translateX(-100%); } /* 结束状态，元素移到原点位置 */
}
.changeThemeBox {
	border-radius: 5px;
	box-shadow: 0 1px 2px 0 #eee;
	overflow: hidden; cursor: pointer; position: fixed; bottom: 160px; right: 10px; z-index: 99;width: 60px; height: 60px;
}
.changeThemeBox .changeTheme, 
.changeThemeBox .changeTheme1,
.act_go_top .go_top, 
.act_go_top .go_top1 {
	transition: all 300ms;
}
.changeThemeBox:hover .changeTheme,
.changeThemeBox:hover .changeTheme1,
.act_go_top:hover .go_top, 
.act_go_top:hover .go_top1
 {
  transform: translateX(-100%);
}

</style>
<div class="changeThemeBox" data-theme="0">
	<a class="changeTheme" href="javascript:;" style="width: 60px; height: 60px;display: flex;
		align-items: center;
		justify-content: center; outline: none; text-align: center; color: #85888b; background: #fff;" title="切换主题">
		<svg t="1709278780043" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15308" width="32" height="32"><path d="M521.315 34.137L250.37 503.402v-5.272L0 425.2l5.118-8.752L250.37 0.05l2.508 2.508h242.898l25.539 31.578z" fill="#FFA47F" p-id="15309"></path><path d="M803.365 2.559L250.37 960.333V498.13l-24.515-7.114L502.84 11.26l137.11 169.917L784.173 2.559h19.192z" fill="#FFD67F" p-id="15310"></path><path d="M250.37 868.005l414.043-717.077L784.173 2.56h157.172l78.151 45.14-563.64 976.25H250.37V868.005z" fill="#FFFA7F" p-id="15311"></path><path d="M711.703 1023.949h-295.46l589.69-1021.39h21.138l2.508-2.508 138.03 234.3-455.906 789.598z" fill="#A1FF7F" p-id="15312"></path><path d="M1005.115 1023.949h-295.51l456.93-791.44L1280 425.199 1029.58 498.13v483.391l-24.464 42.428z" fill="#7FE9FF" p-id="15313"></path></svg>
	</a>
	<a class="changeTheme1" href="javascript:;" style="position: relative; top: -60px; right: -60px; width: 60px; height: 60px;display: flex;
		align-items: center;
		justify-content: center; outline: none; text-align: center; color: #fff; background: #0099ee;" title="切换主题">
		<span>切换<br>主题</span>
	</a>
</div>
<div class="act_go_top" style="overflow: hidden; cursor: pointer; border-radius: 5px; box-shadow: rgb(238, 238, 238) 0px 1px 2px 0px; position: fixed; bottom: 80px; right: 10px; z-index: 99; width: 60px; height: 60px;">
	<a class="go_top" href="javascript:;" style="width: 60px; height: 60px;display: flex;
		align-items: center;
		justify-content: center; outline: none; text-align: center; color: #85888b; background: #fff;" title="切换主题">
		<svg t="1709278113659" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2327" width="32" height="32"><path d="M4.621 514.463h98.188v327.301h98.188v-327.301h98.188v-65.449h-294.563z" fill="#3C3D3D" p-id="2328"></path><path d="M528.209 154.51l-163.446 196.347 327.273-0.219z" fill="#3C3D3D" p-id="2329"></path><path d="M331.907 841.765h327.286v-392.75h-327.286v392.75zM430.095 514.463h130.912v261.823h-130.912v-261.823z" fill="#3C3D3D" p-id="2330"></path><path d="M691.933 449.015v392.75h98.188v-163.651h229.1v-229.1h-327.286zM921.033 612.652h-130.912v-98.188h130.912v98.188z" fill="#3C3D3D" p-id="2331"></path></svg>
	</a>
	<a class="go_top1" href="javascript:;" style="position: relative; top: -60px; right: -60px; width: 60px; height: 60px;display: flex;
		align-items: center;
		justify-content: center; outline: none; text-align: center; color: #fff; background: #0099ee;" title="切换主题">
		返回<br>顶部
	</a>
</div>





<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bbs.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/jquery-3.1.0.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/popper.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bootstrap.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/xiuno.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/storagePlus.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bootstrap-plugin.js.下载"></script><script language="javascript" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/layer.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/async.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/form.js.下载"></script>
<script>
	// 用于个人中心 判断路由 center ，还是 pm
	var debug = DEBUG = 0;
	var url_rewrite_on = 1;
	var forumarr = {
    "177": "x64dbg插件区",
    "52": "OllyDbg插件区",
    "53": "IDA Pro插件区",
    "4": "软件逆向",
    "69": "经典问答",
    "102": "科锐培训",
    "141": "CrackMe存档区",
    "2": "社区版务",
    "76": "1)珠海金山2007逆向分析挑战赛",
    "99": "《加密与解密(第4版)》",
    "125": "奇虎360软件安全大赛答案提交区",
    "21": "《软件加密技术内幕》",
    "68": "2)PEDIY Crackme竞赛2007",
    "41": "编程技术",
    "95": "《0day:软件漏洞分析技术》",
    "88": "加壳脱壳",
    "91": "3)2008 Exploit Me挑战赛",
    "158": "移动安全",
    "3": "PC安全",
    "120": "4)腾讯公司2008软件安全竞赛",
    "123": "《微软.NET程序的加密与解密》",
    "127": "5)奇虎360软件安全比赛",
    "37": "CTF对抗",
    "140": "6)PEDIY Crackme竞赛2009",
    "116": "CTF",
    "150": "二进制漏洞",
    "163": "《C++反汇编与逆向分析技术》",
    "179": "软件广场",
    "155": "7)腾讯公司2010软件安全竞赛",
    "168": "《Android安全与逆向分析》",
    "157": "8)2011 Exploit Me赛",
    "121": "9）移动安全挑战赛（MSC）",
    "152": "问答版块",
    "129": "10）第2届移动安全挑战（MSC）",
    "136": "职场生活",
    "45": "茶余饭后",
    "161": "Android安全",
    "128": "智能设备",
    "171": "Pwn",
    "162": "安全资讯",
    "175": "《二万班安卓高级研修》",
    "47": "招聘专区",
    "97": "求助问答",
    "1": "站务管理/产品",
    "10": "安全工具",
    "137": "职业生涯",
    "151": "WEB安全",
    "176": "《三万班安卓高级研修》",
    "20": "付费问答",
    "132": "密码应用",
    "166": "iOS安全",
    "32": "外文翻译",
    "65": "安全图书",
    "172": "原创软件",
    "174": "International  vision",
    "178": "HarmonyOS",
    "78": "申请提交区",
    "122": "KCTF2024提交区(隐藏版块)"
};
	var fid = 161;
	var uid = 1021299;
	var gid = 101;
	$('[data-toggle="tooltip"]').tooltip();
	$('#search_form > input').on('click', function () {
		return false;
	});
</script>

<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/bbs(1).js.下载"></script>

<script>
// 版主管理：精华
$('.mod-button button.digest').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('digest', {"0": "取消精华", "1": "关注","2": "优秀", "3": "精华"});
	var radios2 = xn.form_radio('skill_type', {"0":"无", "7": "Reverse", "1": "PWN","2": "App", "3": "Web", "4": "IoT", "5":"Develop", "6":"MISC"});
	$.confirm("设置主题为精华", function() {
		var tids = xn.implode('_', modtid);
		var digest = $('input[name="digest"]').checked();
		var skill_type = $('input[name="skill_type"]').checked();
		var postdata = {digest: digest, skill_type:skill_type};
		
		$.xpost(xn.url('mod-digest-'+tids), postdata, function(code, message) {

			if(code != 0) return $.alert(message);
			// $.alert(message).delay(1000).location('');

			if(digest != 0){
				if(window.confirm('设置成功，是否入库?')){
					$.alert('请稍等文库打开中...');
					$('.chm_in').trigger('click');
				}else{
					location.reload();
				}
				// $.confirm("设置成功，是否入库", function() {
					
				// 	$.alert('设置成功，请稍等文库打开中...');

				// });
				// $.alert('设置成功，请稍等文库打开中...');
				// $('.chm_in').trigger('click');
			}else{
				$.alert(message).delay(1000).location('');
			}


		});
	}, {'body': '<p>'+"精华等级"+'：'+radios+'<br>技能方向：'+radios2+'</p>'});
})
</script><script>
function xn_read_unread(tids, tid) {
	
	// 当前时间
	var time = xn.time();
	
	// 多长时间内的主题为最新主题
	var time_range = 86400 * 3;
	
	// 三天内的 tids
	var recent_tids = $.pdata('recent_tids') || {};
	
	// 已读的 tids
	var view_tids = $.pdata('view_tids') || {};
	// 提取列表页的 tid
	function fetch_recent_tids(tids) {
		var changed = false;
		$.each(tids, function(tid, last_date) {
			if(time - last_date < time_range) {
				recent_tids[tid] = last_date;
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	// 清理最近的 tid
	function gc_recent_tids() {
		var changed = false;
		$.each(recent_tids, function(tid, last_date) {
			if(time - last_date > time_range) {
				delete recent_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	function gc_view_tids() {
		var changed = false;
		$.each(view_tids, function(tid, last_date) {
			if(!recent_tids[tid]) {
				delete view_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('view_tids', view_tids);
	}
	
	function save_view_tid(tid) {
		if(!recent_tids[tid]) return;
		view_tids[tid] = time;
		$.pdata('view_tids', view_tids);
	}
	
	if(tids) {
		fetch_recent_tids(tids);
		gc_recent_tids();
		//gc_view_tids();
	}
	if(tid) save_view_tid(tid);
	
	// 三天内的主题标记为已读
	
	// 遍历主题列表，标记最近的，并且未读的为加粗

	$('.thread').each(function() {
		var jthis = $(this);
		var tid = jthis.attr('tid') || jthis.data('tid');
		if(recent_tids[tid] && recent_tids[tid] > xn.intval(view_tids[tid])) {
			//jthis.find('div.subject').addClass('font-weight-bold');
			jthis.find('div.subject').append('<span class="icon-new"></span>');
			jthis.find('span.icon-post-grey').removeClass('icon-post-grey').addClass('icon-post-blue');
			// jthis.find('.icon-new').on('click',function(){

			// 	var tid = jthis.data('tid');
			// 	var pages = jthis.data('pages');
			// 	if(pages == 0 || pages == 1) {
			// 		window.open('thread-'+tid+'.htm')
			// 	} else {
			// 		window.open('thread-'+tid+'-'+pages+'.htm')
			// 	}
				
			// })
		}
	});

	// 首页未读
	$('.bbs_home_page_row_div').each(function() {
		var jthis = $(this);
		var tid = jthis.attr('tid') || jthis.data('tid');
		if(recent_tids[tid] && recent_tids[tid] > xn.intval(view_tids[tid])) {
			jthis.find('span.icon-post-grey').removeClass('icon-post-grey').addClass('icon-post-blue');
		}
	});
	// 列表页未读
	// ···
	// ···
	// ···
}

</script>

<script>
	$(function () {
		setTimeout(function () {
			$(".bbs_home_page_three_col .small_logo").each(function (index, element) {

				if ($(element).children("a").length == 0) {
					$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children(
						'div:first-child').removeClass("col-lg-8").addClass("col-lg-9");
					$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children(
						'div:last-child').removeClass("col-lg-4").addClass("col-lg-3");
					$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children(
						'div:first-child').children("span").css("width", "19rem");
				}
			})
		}, 2000);


		if (self != top) {
			$('#header').hide();
			$('#nav2').hide();
			$('#footer').hide();
		}

		// 导航
		var browser_width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
		if (browser_width <= 992) {
			var new_p = 0,
				start_scrollTop = 0;
			$(window).scroll(function (e) {
				new_p = $(this).scrollTop();

				if (start_scrollTop < new_p) { //下滚  
					$('.header_fiexd').css("display", "none");
				} else { //上滚  
					$('.header_fiexd').css("display", "block");
				}
				setTimeout(function () {
					start_scrollTop = new_p;
				}, 0);
			});
		}
		// 切换主题
		$('.changeThemeBox').click(function () {
			var theme = $(this).data('theme');
			if(theme != 1) {
				theme = 1
			} else {
				theme = 0
			}
			$.xpost('/user-setting_style.htm', {style:theme}, function (code, message) {
				if (code == 0) {
					$.msg(message);
					setTimeout(function(){
						window.location.href="/"
					},1000)
				}
			})
		});
		// 返回顶部
		if ($(window).scrollTop() >= 500) {
			$('.act_go_top').fadeIn(300);
		} else {
			$('.act_go_top').fadeOut(300);
		}
		$(window).scroll(function () {
			
			if ($(window).scrollTop() >= 500) {
				$('.act_go_top').fadeIn(300);
			} else {
				$('.act_go_top').fadeOut(300);
			}
		});

		$('.act_go_top').click(function () {
			$('html,body').animate({
				scrollTop: '0px'
			}, 100);
		});

		var d = new Date();
		var session_interval = d.getTime() - $.pdata('top-banner-session');

		if (session_interval > 3600000) {
			$.pdata('top-banner', 0);
		}
		if ($.pdata('top-banner') == 1) {
			$(".top-banner").hide();
		} else {
			$(".top-banner").slideDown();
		}
		$(".top-banner-section .closeBanner").on("click", function () {

			$.pdata('top-banner', 1);
			$.pdata('top-banner-session', d.getTime());
			$(".top-banner").animate({
				height: '0'
			})
		})


		// 退出登录
		$.xgpost = function (url, postdata, callback, progress_callback) {
			if ($.isFunction(postdata)) {
				callback = postdata;
				postdata = null;
			}
			$.ajax({
				type: 'POST',
				url: url,
				data: postdata,
				dataType: 'text',
				timeout: 6000000,
				xhrFields: {
					withCredentials: true
				},
				progress: function (e) {
					if (e.lengthComputable) {
						if (progress_callback) progress_callback(e.loaded / e.total * 100);
						//console.log('progress1:'+e.loaded / e.total * 100 + '%');
					}
				},
				success: function (r) {
					if (!r) return callback(-1, 'Server Response Empty!');
					var s = xn.json_decode(r);
					if (!s || s.code === undefined) return callback(-1,
						'Server Response Not JSON：' + r);
					if (s.code == 0) {
						return callback(0, s.message);
						//系统错误
					} else if (s.code < 0) {
						return callback(s.code, s.message);
					} else {
						return callback(s.code, s.message);
					}
				},
				error: function (xhr, type) {
					if (type != 'abort' && type != 'error' || xhr.status == 403) {
						return callback(-1000, "xhr.responseText:" + xhr.responseText + ', type:' +
							type);
					} else {
						return callback(-1001, "xhr.responseText:" + xhr.responseText + ', type:' +
							type);
						console.log("xhr.responseText:" + xhr.responseText + ', type:' + type);
					}
				}
			});
		};
		$('.nav_user_item .logout').click(function () {
			$.xpost('/user-logout.htm', {}, function (code, message) {
				if (code == 0) {
					$.msg(message);
					$.xgpost('//passport.kanxue.com/user-logout.htm', "", function (code, message) {

						setTimeout(function () {
							location.reload();
						}, 800)

					})
				}
			})
		});
	});
</script>

<script>
	(function () {
		var islogin = '1021299';
		if (islogin == 0) return;
		var pm_number = "/user-newpm.htm";
		$.xget(pm_number, function (code, message) {
			var pm_number = $(".pm_number");
			var sysm_number = $(".system_message_number");
			if (code == 0) {
				var newpms = parseInt(message.newpms);
				var system_pms = parseInt(message.system_pms);
				var pm_total = newpms + system_pms;
				if (pm_total != 0) {
					pm_total = pm_total > 99 ? "99+" : pm_total;
					if (newpms != 0) {
						$(".pm_message_btn").css("color", "#f44336");
					} else if (newpms == 0 && system_pms > 0) {
						$(".pm_message_btn").css("color", "#0099ee");

					}
					$(".newpms").html(newpms);
					$(".system_pms").html(system_pms);

					$(".pm_totals").html(pm_total);
				} else {
					// $(".pm_total_a").css("display","none");
				};
				if (message.newpms != 0) {
					pm_number.html(message.newpms);
					pm_number.addClass("pmmessage_number");
				} else {
					pm_number.css("display", "none");
				};
				if (message.system_pms != 0) {
					sysm_number.html(message.system_pms);
					sysm_number.addClass("pmmessage_number");
				} else {
					sysm_number.css("display", "none");
				};
				if (message.newpms != 0) {
					pm_number.html(message.newpms);
					pm_number.addClass("pm_numbers_");
				} else {
					pm_number.css("display", "none");
				};
				if (message.system_pms != 0) {
					sysm_number.html(message.system_pms);
					sysm_number.addClass("pm_numbers_");
				} else {
					sysm_number.css("display", "none");
				};


			} else {

				pm_number.css("display", "none");
				sysm_number.css("display", "none");

			}
		})

		$(".pm_message_box").on("mouseenter", function () {
			$(this).find(".dropdown-menu").addClass("show");
			$(this).addClass("active");
		})
		$(".pm_message_box").on("mouseleave", function () {
			$(this).find(".dropdown-menu").removeClass("show");
			$(this).removeClass("active");
		})

	})(jQuery);
</script>
<script>
	// 统计在线
	(function () {
		var uid = '1021299';
		var current_time = '1739534811';
		var last_time;
		if (uid > 0) {
			//10分钟以内不请求。
			last_time = storagePlus.get('last_active_time_' + uid) || 0;
			//大于5分钟请求接口。
			if ((current_time - last_time) / 60 > 5) {
				$.xpost('user-online_sumtime.htm', {}, function (code, msg) {
					if (code == 0) {
						storagePlus.set('last_active_time_' + uid, msg);
					} else {
						console.info('msg');
					}
				});
			}
		}
	})();

</script>

<script>
//     $(function(){
//         var www_domain = 'www.kanxue.com'
//         var uidNewArray = [];
//         $(".avatar_box").each(function(e){
// 			var uidIsHas = uidNewArray.indexOf($(this).data('uid'));
// 			if(uidIsHas == -1) {
// 				uidNewArray.push($(this).data('uid'));
// 			}
//         })

//         if(uidNewArray.length > 0) {
//             $.xpost('//'+www_domain+'/member-is_vip.htm',{'uids':uidNewArray.toString()},function(code,message){
//                 if(code == 0) {

//                     message.forEach(function(item, index){
//                         if(item.is_vip != 0) {
//                             $(".avatar_box[data-uid="+item.uid+"]").addClass("isVipX isVip"+item.is_vip)
//                             $(".username_box[data-uid="+item.uid+"]").addClass("isVipColor")
//                         }
//                     })
//                 }
//             })
//         }
        
//     })
</script>

<script>

var forumlist = [
    {
        "fid": "177",
        "fup": "10",
        "name": "x64dbg插件区",
        "rank": "40"
    },
    {
        "fid": "52",
        "fup": "10",
        "name": "OllyDbg插件区",
        "rank": "39"
    },
    {
        "fid": "53",
        "fup": "10",
        "name": "IDA Pro插件区",
        "rank": "38"
    },
    {
        "fid": "4",
        "fup": "3",
        "name": "软件逆向",
        "rank": "29"
    },
    {
        "fid": "69",
        "fup": "97",
        "name": "经典问答",
        "rank": "29"
    },
    {
        "fid": "102",
        "fup": "137",
        "name": "科锐培训",
        "rank": "29"
    },
    {
        "fid": "141",
        "fup": "140",
        "name": "CrackMe存档区",
        "rank": "29"
    },
    {
        "fid": "2",
        "fup": "1",
        "name": "社区版务",
        "rank": "28"
    },
    {
        "fid": "76",
        "fup": "37",
        "name": "1)珠海金山2007逆向分析挑战赛",
        "rank": "28"
    },
    {
        "fid": "99",
        "fup": "65",
        "name": "《加密与解密(第4版)》",
        "rank": "28"
    },
    {
        "fid": "169",
        "fup": "78",
        "name": "15PB培训",
        "rank": "28"
    },
    {
        "fid": "125",
        "fup": "127",
        "name": "奇虎360软件安全大赛答案提交区",
        "rank": "28"
    },
    {
        "fid": "21",
        "fup": "57",
        "name": "《软件加密技术内幕》",
        "rank": "27"
    },
    {
        "fid": "68",
        "fup": "37",
        "name": "2)PEDIY Crackme竞赛2007",
        "rank": "27"
    },
    {
        "fid": "41",
        "fup": "3",
        "name": "编程技术",
        "rank": "27"
    },
    {
        "fid": "95",
        "fup": "65",
        "name": "《0day:软件漏洞分析技术》",
        "rank": "27"
    },
    {
        "fid": "88",
        "fup": "3",
        "name": "加壳脱壳",
        "rank": "26"
    },
    {
        "fid": "91",
        "fup": "37",
        "name": "3)2008 Exploit Me挑战赛",
        "rank": "26"
    },
    {
        "fid": "158",
        "fup": "0",
        "name": "移动安全",
        "rank": "26"
    },
    {
        "fid": "3",
        "fup": "0",
        "name": "PC安全",
        "rank": "25"
    },
    {
        "fid": "120",
        "fup": "37",
        "name": "4)腾讯公司2008软件安全竞赛",
        "rank": "25"
    },
    {
        "fid": "57",
        "fup": "2",
        "name": "回收站",
        "rank": "25"
    },
    {
        "fid": "123",
        "fup": "57",
        "name": "《微软.NET程序的加密与解密》",
        "rank": "24"
    },
    {
        "fid": "127",
        "fup": "37",
        "name": "5)奇虎360软件安全比赛",
        "rank": "24"
    },
    {
        "fid": "37",
        "fup": "116",
        "name": "CTF对抗",
        "rank": "23"
    },
    {
        "fid": "140",
        "fup": "37",
        "name": "6)PEDIY Crackme竞赛2009",
        "rank": "23"
    },
    {
        "fid": "116",
        "fup": "0",
        "name": "CTF",
        "rank": "22"
    },
    {
        "fid": "150",
        "fup": "3",
        "name": "二进制漏洞",
        "rank": "22"
    },
    {
        "fid": "163",
        "fup": "65",
        "name": "《C++反汇编与逆向分析技术》",
        "rank": "22"
    },
    {
        "fid": "179",
        "fup": "0",
        "name": "软件广场",
        "rank": "21"
    },
    {
        "fid": "155",
        "fup": "37",
        "name": "7)腾讯公司2010软件安全竞赛",
        "rank": "21"
    },
    {
        "fid": "168",
        "fup": "65",
        "name": "《Android安全与逆向分析》",
        "rank": "21"
    },
    {
        "fid": "157",
        "fup": "37",
        "name": "8)2011 Exploit Me赛",
        "rank": "20"
    },
    {
        "fid": "121",
        "fup": "37",
        "name": "9）移动安全挑战赛（MSC）",
        "rank": "18"
    },
    {
        "fid": "152",
        "fup": "0",
        "name": "问答版块",
        "rank": "18"
    },
    {
        "fid": "129",
        "fup": "37",
        "name": "10）第2届移动安全挑战（MSC）",
        "rank": "17"
    },
    {
        "fid": "136",
        "fup": "0",
        "name": "职场生活",
        "rank": "12"
    },
    {
        "fid": "45",
        "fup": "136",
        "name": "茶余饭后",
        "rank": "6"
    },
    {
        "fid": "161",
        "fup": "158",
        "name": "Android安全",
        "rank": "6"
    },
    {
        "fid": "128",
        "fup": "158",
        "name": "智能设备",
        "rank": "5"
    },
    {
        "fid": "171",
        "fup": "116",
        "name": "Pwn",
        "rank": "5"
    },
    {
        "fid": "162",
        "fup": "136",
        "name": "安全资讯",
        "rank": "5"
    },
    {
        "fid": "175",
        "fup": "137",
        "name": "《二万班安卓高级研修》",
        "rank": "5"
    },
    {
        "fid": "47",
        "fup": "136",
        "name": "招聘专区",
        "rank": "4"
    },
    {
        "fid": "97",
        "fup": "152",
        "name": "求助问答",
        "rank": "4"
    },
    {
        "fid": "1",
        "fup": "0",
        "name": "站务管理/产品",
        "rank": "3"
    },
    {
        "fid": "10",
        "fup": "179",
        "name": "安全工具",
        "rank": "3"
    },
    {
        "fid": "137",
        "fup": "136",
        "name": "职业生涯",
        "rank": "3"
    },
    {
        "fid": "151",
        "fup": "116",
        "name": "WEB安全",
        "rank": "3"
    },
    {
        "fid": "160",
        "fup": "78",
        "name": "麦洛科菲培训",
        "rank": "3"
    },
    {
        "fid": "176",
        "fup": "137",
        "name": "《三万班安卓高级研修》",
        "rank": "3"
    },
    {
        "fid": "20",
        "fup": "152",
        "name": "付费问答",
        "rank": "2"
    },
    {
        "fid": "132",
        "fup": "116",
        "name": "密码应用",
        "rank": "2"
    },
    {
        "fid": "166",
        "fup": "158",
        "name": "iOS安全",
        "rank": "2"
    },
    {
        "fid": "170",
        "fup": "57",
        "name": "看雪产品",
        "rank": "2"
    },
    {
        "fid": "32",
        "fup": "136",
        "name": "外文翻译",
        "rank": "1"
    },
    {
        "fid": "65",
        "fup": "1",
        "name": "安全图书",
        "rank": "1"
    },
    {
        "fid": "172",
        "fup": "179",
        "name": "原创软件",
        "rank": "1"
    },
    {
        "fid": "174",
        "fup": "32",
        "name": "International  vision",
        "rank": "1"
    },
    {
        "fid": "178",
        "fup": "158",
        "name": "HarmonyOS",
        "rank": "1"
    },
    {
        "fid": "64",
        "fup": "136",
        "name": "会员专区",
        "rank": "0"
    },
    {
        "fid": "78",
        "fup": "2",
        "name": "申请提交区",
        "rank": "0"
    },
    {
        "fid": "122",
        "fup": "37",
        "name": "KCTF2024提交区(隐藏版块)",
        "rank": "0"
    },
    {
        "fid": "29",
        "fup": "2",
        "name": "论坛版主团队",
        "rank": "0"
    }
];

// 三级版块
function forum_tree(forumlist, template) {
	var template = template || '<option value="{fid}">{tab}{name}</option>'+"\r\n";
	var s = '';
	var forumlist1 = forumlist.filter(function(v) {return v.fup == 0});
	for(var i1=0; i1<forumlist1.length; i1++) {
		var v1 = forumlist1[i1];
		s += '►'+xn.template(template, {fid: v1.fid, name: v1.name, tab: "　"});
		var forumlist2 = forumlist.filter(function(v2) {return v2.fup == v1.fid});
		for(var i2=0; i2<forumlist2.length; i2++) {
			var v2 = forumlist2[i2];
			s += xn.template(template, {fid: v2.fid, name: v2.name, tab: "　　"});
			var forumlist3 = forumlist.filter(function(v3) {return v3.fup == v2.fid});
			for(var i3=0; i3<forumlist3.length; i3++) {
				var v3 = forumlist3[i3];
				s += xn.template(template, {fid: v3.fid, name: v3.name, tab: "　　　　"});
			}

		}
	}
	return s;
}


// 版主管理：移动 / moderator : move
$('.mod-button button.move').off('click').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var select = '<select name="fid">'+forum_tree(forumlist)+'</select>';
	$.confirm(lang.move_forum, function() {
		var tids = xn.implode('_', modtid);
		var newfid = $('select[name="fid"]').val();
		$.xpost(xn.url('mod-move-'+tids+'-'+newfid), function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+lang.choose_move_forum+'：'+select+'</p>'});
})

</script><script>

// 版主管理：审核
$('.mod-button button.audit').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('audit', {"1": "审核通过", "2": "审核不通过"});
	$.confirm('审核主题', function() {
		var tids = xn.implode('_', modtid);
		var audit = $('input[name="audit"]').checked();
		var postdata = {audit: audit};
		$.xpost(xn.url('mod-audit-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+'审核选项'+'：'+radios+'</p>'});
})

</script><script>

    // 版主管理：审核
    $('.mod-button button.limit').on('click', function() {
        var modtid = $('input[name="modtid"]').checked();
        if(modtid.length == 0) return $.alert(lang.please_choose_thread);
        var radios = xn.form_radio('limit', {"0": "验证通过", "1": "待验证"});
        $.confirm('验证主题', function() {
            var tids = xn.implode('_', modtid);
            var limit = $('input[name="limit"]').checked();
            var postdata = {audit: limit};
            $.xpost(xn.url('mod-newuser_audit-'+tids), postdata, function(code, message) {
                if(code != 0) return $.alert(message);
                $.alert(message).delay(1000).location('');
            });
        }, {'body': '<p>'+'验证选项'+'：'+radios+'</p>'});
    })

    </script>



<script>

$(function() {
	// 版主管理：删除 / moderator : delete
	$('.mod-button button.delete').off('click').on('click', function() {
		var modtid = $('input[name="modtid"]').checked();
		if(modtid.length == 0) return $.alert(lang.please_choose_thread);
		var radios = '';
				//var htmladd = '<br><br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 物理删除</label>';
		//htmladd += '<br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 恢复删除</label>';
		$.confirm(xn.lang('confirm_delete_thread', {n:modtid.length}) + '<br><br>'+radios, function() {
			var tids = xn.implode('_', modtid);
			var type = $('input[name="type"]').checked();
			$.xpost(xn.url('mod-delete-'+tids), {type: type}, function(code, message) {
				if(code != 0) return $.alert(message);
				$.alert(message).delay(1000).location('');
			});
		});
	})

	// 恢复逻辑删除的帖子
	$('body').on('click', '.post_recover', function() {
		var jthis = $(this);
		var href = jthis.data('href');
		var isfirst = jthis.attr('isfirst');
		if(window.confirm('确定恢复删除的帖子？')) {
			$.xpost(href, function(code, message) {
				var isfirst = jthis.attr('isfirst');
				if(code == 0) {
					if(isfirst == '1') {
						$.location('forum-161.htm');
					} else {
						window.location.reload();
					}
				} else {
					$.alert(message);
				}
			});
		}
		return false;
	});

})

</script>

<!-- Google tag (gtag.js) -->
<script async="" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-WG3E345FRQ');
</script>


<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/jump_prompt.js.下载"></script>	
<div class="modal fade appeal" id="appeal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        <h4 class="modal-title" id="exampleModalLabel">求助问答申诉</h4>
                        </div>
                        <form id="form_appeal" action="https://bbs.kanxue.com/post-appeal.htm" method="post">
	                        <div class="modal-body">
	                                <div class="form-group">
	                                	<input id="pid" name="pid" value="0" type="hidden">
	                                        <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请写明申诉的原因"></textarea>
	                                </div>
	                        </div>
	                        <div class="modal-footer">
	                                <button id="appeal_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">申请提交</button>
	                        </div>
	                </form>
                </div>
        </div>
</div><div class="modal fade report" id="report" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        
                        <h4 class="modal-title" id="exampleModalLabel">举报此帖</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        </div>
                        <form id="form_report" action="https://bbs.kanxue.com/post-report.htm" method="post">
                                <div class="modal-body">
                                        <div class="form-group">
                                                <input id="tid" name="tid" value="0" type="hidden">
                                                <input id="pid" name="pid" value="0" type="hidden">
                                                <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请确认您所举报此帖的内容涉及到语言挑衅和违犯论坛版规的内容， 版主将收到举报后审核该帖！"></textarea>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                        <button id="report_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">发送报告</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<div class="modal fade sqtj" id="sqtj" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        
                        <h4 class="modal-title" id="exampleModalLabel">申请推荐此帖</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        </div>
                        <form id="form_sqtj" action="https://bbs.kanxue.com/post-sqtj.htm" method="post">
                                <div class="modal-body">
                                        <div class="form-group">
                                                <input id="tid" name="tid" value="0" type="hidden">
                                                <input id="pid" name="pid" value="0" type="hidden">
                                                <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写推荐的理由，注意: 请确认您所申请推荐的内容， 版主将收到申请后审核该帖！"></textarea>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                        <button id="sqtj_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">发送申请</button>
                                </div>
                        </form>
                </div>
        </div>
</div>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/iconfont.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/face.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/qqLevel.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/feather.min.js.下载"></script>
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/kx_url_decrypt.js.下载"></script>
<script>
	$(document).ready(function() {
		// 解码链接start
		var markElements = $('.message mark');
		if(markElements.length > 0){
			markElements.each(function  () { 
				var originalContent = $(this).text(); 
				try {
					// var decodedContent = xn.urldecode(atob(originalContent)); 
					var decodedContent = xn.urldecode(kx_url_decrypt(originalContent)); 
					$(this).html(decodedContent); 
					$(this).contents().unwrap();  // 移除<mark>标签 
				} catch (e) { 
					console.log(' 解码错误：' + e.message);  
				} 
			});  
		}
		// 解码链接end

		// 获取当前URL中的锚点值
		var hash = window.location.hash;
		if (hash) {
			console.log('回帖')
			// 如果存在锚点值，则执行滚动操作
			// 移除原有的锚点值，确保只滚动到目标位置而不会重复加载相同内容
			history.replaceState('', document.title, window.location.pathname+window.location.search);
			
			// 设置滚动条位置
			$('html, body').animate({ scrollTop: $(hash).offset().top }, 'fast');
		}
	});
	feather.replace(); // feather icon 引入
	var thread_uid = '819934';
	var passport_domain = 'passport.kanxue.com';
	// 回复 操作按钮 手机端 显示隐藏方法 开始
	function mobile_more_operate(e) {
		$(".mobile_more_operate").hide();
		$(e.target).siblings(".mobile_more_operate").fadeIn();
	}
	$(document).scroll(function () {
		$(".mobile_more_operate").hide();
	})
	$(document).on("click", function (e) {

		if ($(e.target).parents(".mobile_more_operate_btn").length == 0 && !$(e.target).hasClass(
				'mobile_more_operate_btn')) {
			$(".mobile_more_operate").hide();
		}

	})
	// 回复 操作按钮 手机端 显示隐藏方法 结束

	function show_level(event) {
		var el = event.target;

		var usergid = $(el).attr("data-gid");
		$.tips('<span class="level-' + usergid + ' level"></span>', $(el), {
			tips: [3, '#fff'],
			time: 2000
		});
	}

	function show_online_level(event) {
		var el = event.target;

		var userdesc = $(el).attr("data-desc");

		$.tips('<span class="text-muted">' + userdesc + '</span>', $(el), {
			tips: [3, '#fff'],
			time: 2000
		});
	}

	function online_time_imgs(v) {

		var online_time = $(v).data('online_time');
		var level = qqLevel.getLevel(online_time);
		var imgs = qqLevel.getImg(level, [
			'//' + passport_domain + '/pc/view/img/star_0.gif',
			'//' + passport_domain + '/pc/view/img/star.gif',
			'//' + passport_domain + '/pc/view/img/moon.gif',
			'//' + passport_domain + '/pc/view/img/sun.gif',
			'//' + passport_domain + '/pc/view/img/king.gif',
		]);
		var desc = qqLevel.getDescBbs(online_time);
		$(v).attr('data-desc', desc);

		$(v).next(".post_online_time1").html('( ' + desc + ' )');
		$(v).html(imgs);
	}
	$(".post_online_time").each(function (k, v) {
		online_time_imgs(v)
	})

	// 快速回帖切换到高级回复时，编辑框文字保存一下来
	$('.senior_reply').on('click', function () {
		var quick_reply_message = $('#quick_reply_form').find('#message').val().trim();

		// quick_reply_message = quick_reply_message.replace(/\[em_([0-9]+)\]/g, '<img src="/view/img/face/$1.gif" class="face" style="cursor: pointer;">');

		function senior_reply_pdata(return_obj) {
			if (quick_reply_message.length == 0) {
				$.pdata('quick_reply_message', '');
			} else {
				$.pdata('quick_reply_message', quick_reply_message);
			}
			return return_obj();
		}

		function senior_reply_return() {
			window.location.href = 'post-create-281889.htm';
		};
		senior_reply_pdata(senior_reply_return);

	})


	function shareTo(stype) {
		var ftit = '';
		var flink = '';
		var lk = '';
		//获取文章标题
		ftit = $('.subject').text();
		//获取网页中内容的第一张图片
		flink = $('.message img').eq(0).attr('src');

		if (typeof flink == 'undefined') {
			flink = '';
		}
		//当内容中没有图片时，设置分享图片为网站logo
		if (flink == '') {
			lk = 'http://bbs.kanxue.com/plugin/kanxue/img/kanxuelogo.png';
		}
		//如果是上传的图片则进行绝对路径拼接
		if (flink.indexOf('upload/') != -1) {
			lk = 'http://bbs.kanxue.com/' + flink;
		}
		//qq空间接口的传参
		// if(stype=='qzone'){
		//弹出窗口的宽度;
		// var iw=800; 
		//弹出窗口的高度;
		// var ih=500; 
		//获得窗口的垂直位置;
		// var it = (window.screen.availHeight-30-ih)/4; 
		//获得窗口的水平位置;
		// 	var il = (window.screen.availWidth-10-iw)/4; 
		// 	var openurl = 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+document.location.href+'?sharesource=qzone&title='+ftit+'&pics='+lk+'&summary='+document.querySelector('meta[name="description"]').getAttribute('content');
		// 	window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
		// }

		//新浪微博接口的传参
		if (stype == 'sina') {
			var iw = 500; //弹出窗口的宽度;
			var ih = 500; //弹出窗口的高度;
			var it = (window.screen.availHeight - 30 - ih) / 4; //获得窗口的垂直位置;
			var il = (window.screen.availWidth - 10 - iw) / 4; //获得窗口的水平位置;
			var openurl = 'http://service.weibo.com/share/share.php?url=' + document.location.href +
				'?sharesource=weibo&title=' + ftit + '&pic=' + lk;
			window.open(openurl, "", "height=" + ih + ", width=" + iw + ", top=" + it + ", left=" + il);

		}
		//qq好友接口的传参
		if (stype == 'qq') {
			var iw = 800; //弹出窗口的宽度;
			var ih = 500; //弹出窗口的高度;
			var it = (window.screen.availHeight - 30 - ih) / 4; //获得窗口的垂直位置;
			var il = (window.screen.availWidth - 10 - iw) / 4; //获得窗口的水平位置;
			var openurl = 'http://connect.qq.com/widget/shareqq/index.html?url=' + document.location.href +
				'?sharesource=qzone&title=' + ftit + '&pics=' + lk + '&summary=' + document.querySelector(
					'meta[name="description"]').getAttribute('content') + '&desc=看雪学院，一个有情怀的安全开发者交流的网站'
			window.open(openurl, "", "height=" + ih + ", width=" + iw + ", top=" + it + ", left=" + il);
		}
		//生成二维码给微信扫描分享，php生成，也可以用jquery.qrcode.js插件实现二维码生成
		if (stype == 'wechat') {

			$.tips('<img width="150" src="bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d281889_2ehtm.htm">', $("#wxshare"), {
				tips: [2, '#eee'],
				time: 5000
			});
		}
	}
	$(function () {
		var threadUid= '819934';
		var uid = '1021299';
		var forum = '161'
		var jform = $('#quick_reply_form');
		var jsubmit = $('#submit');
		var postNum = $('.postlist .posts').text();
		jform.on('submit', function () {
			if(forum == '97' && parseInt(postNum) == 0 && uid == threadUid) {
				$.msg('不能顶自己的帖')
				return false
			}
			jform.reset();
			jsubmit.button('loading');
			var postdata = jform.serialize();
			$.xpost(jform.attr('action'), postdata, function (code, message) {
				if (code == 0) {
					var s = '<table>' + message + '</table>';
					var jtr = $(s).find('tr');
					jtr.insertBefore($('table.postlist tr').last());
					jsubmit.button('reset');
					$('#message').val('');

					// 楼层 +1
					var jfloor = jform.find('.floor');
					jfloor.html(xn.intval(jfloor.html()) + 1);

					// 回复数 +1
					var jposts = $('.posts');
					jposts.html(xn.intval(jposts.html()) + 1);

					// 属于回复可见的帖子，需要刷新
					if($('input#content_show').val() != 1) {
						window.location.reload();
					}
				} else if (code < 0) {
					$.alert(message);
					jsubmit.button('reset');
				} else {
					jform.find('[name="' + code + '"]').alert(message).focus();
					jsubmit.button('reset');
				}
			});
			return false;
		});

		//  显示隐藏 点赞收藏等功能
		var offset_top = $("#collection_thumb").offset().top - $(document).scrollTop();
		if (offset_top < document.documentElement.clientHeight) {
			$(".collection_thumb_left").hide();
		} else {
			$(".collection_thumb_left").show();
		}
		$(document).on("scroll", function () {
			var offset_top = $("#collection_thumb").offset().top - $(document).scrollTop();
			if (offset_top < document.documentElement.clientHeight) {
				$(".collection_thumb_left").hide();
			} else {
				$(".collection_thumb_left").show();
			}
		})
		//收藏功能
		var jfavorite = $('.favorite');
		var jlikesFirst = $('.likes:first');
		var jlikes = $('.likes');
		var jlikes_box = $('.likes_box');
		var likenums = jlikesFirst.text();
		if (parseInt(likenums) > 0) jlikes_box.removeClass("likes_box_hide").addClass("likes_box_show");
		jfavorite.on('click', function () {
			var likenum = jlikesFirst.text();
			likenum_plus = parseInt(likenum) + 1;
			likenum_sub = parseInt(likenum) - 1;
			if (likenum_sub < 0) likenum_sub = 0;
			$(".favorite i").addClass('shrink');
			$.xpost('thread-favorite-281889.htm', function (code, message) {
				if (code == 0) {
					$(".favorite i").removeClass('icon-star-o color515a6e').addClass('icon-star colorff842a');
					$(".favorite i").removeClass('shrink');
					// $(".favorite .icon-star").css('color','#ff842a');
					// var s = '<i class="icon-star shrink" style="color: #ff842a;"></i>';
					// jfavorite.html(s);
	
					jlikes.text(likenum_plus);
					jlikes_box.removeClass("likes_box_hide").addClass("likes_box_show");

				} else if (code == 1) {
					$(".favorite i").removeClass('icon-star colorff842a').addClass('icon-star-o color515a6e');
					$(".favorite i").removeClass('shrink');
					// var s = '<i class="icon-star-o color515a6e shrink"></i>';
					// jfavorite.html(s);
					// $(".favorite .icon-star").remove('shrink');
					// $(".favorite .icon-star-o").addClass('color515a6e');

					jlikes.text(likenum_sub);
					// if (likenum_sub == 0) jlikes_box.removeClass("likes_box_show").addClass("likes_box_hide");
				} else {
					$.alert(message);
				}
			});
			return false;
		});

		// 点赞
		var username = 'mb_zwojibcx';
		var page = '1';
		var thumbs_num_box = $('.thumbs_num_box');
		var thumbs_num_first = $(".thumbs_num:first").text();
		if (parseInt(thumbs_num_first) == 0) thumbs_num_box.hide();
		// 显示赞赏列表 最大20条
		let thumb_list_item  = $('.thumb_list_body .thumb_list_item');
		if(thumb_list_item.length > 0){
			$('.thumb_list_box').show()

			if (thumb_list_item.length > 20) {
				$('#thumbShowMore').show()
			}
			$('#thumbShowMore a').on('click',function(){
				for (var i = 20; i < thumb_list_item.length; i++) {
					$(thumb_list_item).css('display','flex')
				}
				$('#thumbShowMore').hide();
			})
			
		}
		$('#addThumbXb').on('click',function(){
			var maxValue = parseInt($('#thumb-xb').attr('max'));
			let thumbXbNum =  parseInt($('#thumb-xb').val()) + 1
			if (thumbXbNum > maxValue) {
				$('#thumb-xb').val(maxValue);
				$.tips('雪币数不超过'+maxValue, $(this), {
					tips: 1,
					time: 2000,
					tips: [1, '#748691']
				});
				return false
			}
			$('#thumb-xb').val(thumbXbNum)
		})
		$('#thumb-xb').on('input', function() {
			var maxValue = parseInt($(this).attr('max'));
			var enteredValue = parseInt($(this).val());
			
			if (enteredValue > maxValue) {
				$(this).val(maxValue);
				$.tips('雪币数不超过'+maxValue, $(this), {
					tips: 1,
					time: 2000,
					tips: [1, '#748691']
				});
			}
		});

		let thumbTextArr = ['非常支持你的观点！',
			'这个讨论对我很有帮助，谢谢！',
			'感谢你分享这么好的资源！',
			'谢谢你的细致分析，受益匪浅！',
			'感谢你的积极参与，期待更多精彩内容！',
			'感谢你的贡献，论坛因你而更加精彩！',
			'你的分享对大家帮助很大，非常感谢！',
			'期待更多优质内容的分享，论坛有你更精彩！',
			'你的帖子非常有用，感谢分享！',
			'请遵守论坛规则，避免发布广告内容！',
			'请注意发帖规范，保持良好的讨论环境！'];
		$.each(thumbTextArr, function(index, comment) {
			var option = $('<option>');
				option.text(comment);
				option.val(comment)
			$('#thumbModal .reward_reason').append(option);
		});

		let randomIndex = Math.floor(Math.random() * thumbTextArr.length-2);
		let randomElement = thumbTextArr[randomIndex];
		$('#thumb-text').val(randomElement);
		$('.thumb-text-refresh').on('click',function(){
			$('#thumbModal select.reward_reason').val(0);
			let _this = this
			$(this).addClass('rotate')
			let randomIndex2 = Math.floor(Math.random() * (thumbTextArr.length-2));
			let randomElement = thumbTextArr[randomIndex2];
			$('#thumb-text').val(randomElement)
			setTimeout(function () {
				$(_this).removeClass('rotate')
			}, 1000)
		})
		$('.thumbPost').click(function () {
			var threadid = `281889`;
			var type = 1;
			var num = parseInt(thumbs_num_first);

			var thumbxb = $('#thumb-xb').val();
			var thumbText = $('#thumb-text').val();

			var postdata = 'threadid=' + threadid + '&type=1&page=' + page+ '&golds=' + thumbxb+ '&comments=' + thumbText;
			var that = this;
			$.xpost('thumbs_up-thumbs.htm', postdata, function (code, message) {
				if (code == 0) {
					$('.collection_thumb_left .icon-thumbs-o-up, #collection_thumb .icon-thumbs-o-up').removeClass('icon-thumbs-o-up').addClass('icon-thumbs-up');
					$('.collection_thumb_left .icon-thumbs-up, #collection_thumb .icon-thumbs-up').css('color','#ff842a');
					$('.collection_thumb_left .icon-thumbs-up, #collection_thumb .icon-thumbs-up').parent('a').removeAttr('data-target');
					thumbs_num_box.show();
					$('.thumbs_num').text(num + 1);

					$('#thumbModal').modal('hide');

					let thumbListDemo = `<div class="row mx-0 py-3" style="border-top: 1px dashed #cecece;">
						<div class="text-truncate" style="width: 100px;">${username}</div>
						<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;">+${thumbxb}</div>
						<div class="col px-2 text-muted">${thumbText}</div>
						<div style="width: 120px; text-align: left;">刚刚</div>
					</div>`;
					if(Number(thumbxb) == 0 ) {
						thumbListDemo = `<div class="row mx-0 py-3" style="border-top: 1px dashed #cecece;">
						<div class="text-truncate" style="width: 100px;">${username}</div>
						<div class="px-3" style="width: 100px; text-align: center; color: #ee3000;"></div>
						<div class="col px-2 text-muted">${thumbText}</div>
						<div style="width: 120px; text-align: left;">刚刚</div>
					</div>`;
					}
					$(thumbListDemo).prependTo(".thumb_list_box .thumb_list");
					$('.thumb_list_box').show();

					if($('input#content_show').val() != 1) {
						window.location.reload();
					}
				} else if (code == 1) {
					thumbs_num_box.show();
					$.tips(message, $(that), {
						tips: 1,
						time: 2000,
						tips: [1, '#748691']
					});
				} else {
					$.tips(message, $(that), {
						tips: 1,
						time: 2000,
						tips: [1, '#748691']

					});
				}
			})
		})
		$('#collection_thumb, .collection_thumb_left').on('click','.thumbsBox .icon-thumbs-up', function(){
			event.stopPropagation();
			$.tips('已点赞过', $(this).parent('a'), {
				tips: 1,
				time: 2000,
				tips: [1, '#748691']
			});
		})
		$("#thumbModal select.reward_reason").change(function(){
			var reward_reason = $("#thumbModal select.reward_reason option:selected").val()
			console.log(reward_reason)
			if (reward_reason != 0) {
				$("#thumb-text").val($("#thumbModal select.reward_reason option:selected").val());
			}
		})
		let thumbtexts = ['免费','点赞'];
		let thumbTextCurrentIndex = 0;
		setInterval(() => {
			thumbTextCurrentIndex = (thumbTextCurrentIndex + 1) % thumbtexts.length;
			$('.text-cycler').fadeOut("1000",function(){
				$('.text-cycler').text(thumbtexts[thumbTextCurrentIndex])
				$('.text-cycler').fadeIn("1500")
				
			})	
		}, 2500);

		// 缩放图片，适应屏幕大小。
		function resize_image() {
			var jmessagelist = $('div.message');
			var first_width = jmessagelist.width(); // 815 : 746; //  734 746
			jmessagelist.each(function () {
				var jdiv = $(this);
				var maxwidth = jdiv.attr('isfirst') ? first_width : first_width - 79; //  734 746
				var jmessage_width = Math.min(jdiv.width(), maxwidth);
				jdiv.find('img, embed, iframe').each(function () {
					var jimg = $(this);
					//if(jimg.width() < 500) return;
					var img_width = this.org_width;
					var img_height = this.org_height;
					if (!img_width) {
						var img_width = jimg.width();
						var img_height = jimg.height();
						this.org_width = img_width;
						this.org_height = img_height;
					}
					//var percent = xn.min(100, xn.ceil((img_width / jmessage_width) * 100));
					if (img_width > jmessage_width) {
						if (this.tagName == 'IMG') {
							jimg.width(jmessage_width);
							jimg.css('height', 'auto');
						} else {
							jimg.width(jmessage_width);
							var height = (img_height / img_width) * jimg.width();
							jimg.height(height);
						}
					}

				});

				jdiv.find('p').each(function () {
					var jp = $(this);
					if ($.trim(jp.text()) == '') {
						jp.css('line-height', '1');
					}
				});
			});
		}
		// resize_image();
		// $(window).on('resize', resize_image);


		//---------by wang start------------------------//
		//取出tr的pid，赋值给tr使name为point_pid
		// $(".post").each(function() {
		// 	var cpid = $(this).attr("pid");
		// 	$(this).attr("id","point_"+ cpid);
		// });
		var url = window.location.toString();

		if (url.indexOf("#") != -1) {
			var cpid = url.split("#")[1];
			if (cpid) {
				$(".post").each(function (k, v) {
					if ($(v).attr("pid") == cpid) {
						var t = $(this).offset() ? $(this).offset().top : 0;
						//$("#frame_right").scrollTop(t);
						$("html,body").animate({
							scrollTop: t
						}, 800)
					}

				});

			}
		}

		//------------by wang end----------------------------//



		// 输入框自动伸缩
		var jmessage = $('#message');
		jmessage.on('focus', function () {
			if (jmessage.t) {
				clearTimeout(jmessage.t);
				jmessage.t = null;
			}
			jmessage.css('height', '6rem');
		});
		jmessage.on('blur', function () {
			jmessage.t = setTimeout(function () {
				jmessage.css('height', '2.5rem');
			}, 1000);
		});

		$('#nav_pc li[fid="161"]').addClass('active');
		$('#nav_mobile li[fid="161"]').addClass('active');

		$(function () {
			$('.emotion').qqFace({
				id: 'facebox',
				assign: 'message',
				path: 'view/img/face/'
			});
		});
		// 展示图片
		function imgShow(outerdiv, innerdiv, bigimg, _this){
    		var src = _this.attr("src");//获取当前点击的pimg元素中的src属性
    		$(bigimg).attr("src", src);//设置#bigimg元素的src属性

			/*获取当前点击图片的真实大小，并显示弹出层及大图*/
			$("<img/>").attr("src", src).on('load',function(){
				var windowW = $(window).width();//获取当前窗口宽度
				var windowH = $(window).height();//获取当前窗口高度
				var realWidth = this.width;//获取图片真实宽度
				var realHeight = this.height;//获取图片真实高度
				
				var imgWidth, imgHeight;
				var scale = 0.8;//缩放尺寸，当图片真实宽度和高度大于窗口宽度和高度时进行缩放
				if(realHeight>windowH*scale) {//判断图片高度
					imgHeight = windowH*scale;//如大于窗口高度，图片高度进行缩放
					imgWidth = imgHeight/realHeight*realWidth;//等比例缩放宽度
					if(imgWidth>windowW*scale) {//如宽度扔大于窗口宽度
						imgWidth = windowW*scale;//再对宽度进行缩放
					}
				} else if(realWidth>windowW*scale) {//如图片高度合适，判断图片宽度

					imgWidth = windowW*scale;//如大于窗口宽度，图片宽度进行缩放
					imgHeight = imgWidth/realWidth*realHeight;//等比例缩放高度
				} else {//如果图片真实高度和宽度都符合要求，高宽不变

					imgWidth = realWidth;
					imgHeight = realHeight;
				}
				
				$(bigimg).css("width",imgWidth);//以最终的宽度对图片缩放
				var w = (windowW-imgWidth)/2;//计算图片与窗口左边距
				var h = (windowH-imgHeight)/2;//计算图片与窗口上边距
				$(innerdiv).css({"top":h, "left":w});//设置#innerdiv的top和left属性
				$(outerdiv).fadeIn("fast");//淡入显示#outerdiv及.pimg
			});
			$(outerdiv).off('click').on('click',function(){//再次点击淡出消失弹出层
				$(this).fadeOut("fast");
			});
			$(outerdiv).find(".showDrawing").off('click').on('click',function(event){
				event.stopPropagation();
				window.open(src,'_blank')
			});
		}
		
		// $(bigimg).off('click').on('click',function(){
		// 	event.preventDefault();
		// 	var img_src = $(this).attr("src");
		// 	var img = new Image();
		// 	img.src = img_src;
		// 	img.onload = function () {
		// 		window.open(img_src);
		// 	};
		// })
		$("div.message img").css("cursor", "zoom-in");
		$("div.message img").on("click", function () {
			if (window.innerWidth > 768) {
				var _this = $(this);//将当前的img元素作为_this传入函数
				imgShow("#imageViewerOuterdiv", "#imageViewerInnerdiv", "#bigimg", _this);

			}
		})
		setTimeout(function () {
			$("div.message img").each(function (index, element) {
				if ($(element).width() >= 100) {
					$(element).addClass("div_message_boxShadow");
				}
			})
		}, 2000);

		function IsPC() {
			var userAgentInfo = navigator.userAgent;
			var Agents = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"];
			var flag = true;
			for (var v = 0; v < Agents.length; v++) {
				if (userAgentInfo.indexOf(Agents[v]) > 0) {
					flag = false;
					break;
				}
			}
			return flag;
		}

		// 弹出分享页面
		var outside = true;
		$(".bbsshare_btn").on('click', function (event) {
			outside = false;
			$(".bbsshare_modal").show();
		});
		document.body.addEventListener('click', function () {
			outside = true;
		}, true)
		document.body.addEventListener('click', function () {
			if (outside) {
				$(".bbsshare_modal").hide();
			}
		})
		// $(".bbsshare_btn").on('click', function(event){
		// 	$.open({
		// 		type: 1,
		// 		title: false,
		// 		content: $('.bd-bbsshare-modal-sm'),
		// 		offset: 'auto',
		// 		shadeClose: false,
		// 		shade: false,

		// 	});

		// });

		if ($.pdata('collapse_reward') && $.pdata('collapse_reward') == 1) {
			$("#collapse_reward").removeClass('show');
			$(".collapse_btn").find("span").html("展开");
			$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");

		} else if ($.pdata('collapse_reward') == 0 || $.pdata('collapse_reward') == '' || $.pdata(
				'collapse_reward') == null) {
			$("#collapse_reward").addClass('show');
			$(".collapse_btn").find("span").html("收起");
			$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");
		}
		$("#collapse_reward").on('hide.bs.collapse', function () {
			$.pdata('collapse_reward', 1)
			$(".collapse_btn").find("span").html("展开");
			$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");


		})
		$("#collapse_reward").on('show.bs.collapse', function () {
			$.pdata('collapse_reward', 0)
			$(".collapse_btn").find("span").html("收起");
			$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");

		})


		// $(".follow_btn_svg").on("click", function(){
		// 	var that = $(this);
		// 	$.xpost("user-follow.htm", {followed_uid: thread_uid}, function(code, message) {
		// 		if (code == 0) {
		// 			$.msg(message);
		// 			that.parent(".follow_btn_span").remove();
		// 		} else if (code == 1) {
		// 			$.msg(message);
		// 		}
		// 	})
		// })

		$(".follow_btn").on("click", function () {
			var that = $(this);
			var cuid = that.attr("data-cuid");
			$.xpost("user-follow.htm", {
				followed_uid: cuid
			}, function (code, message) {
				if (code == 0) {
					that.removeClass("btn-0099ee").addClass("btn-followed");
					that.html('已关注');
					$.msg(message);
				} else if (code == 1) {
					that.removeClass("btn-followed").addClass("btn-0099ee");
					that.html('<i class="icon icon-plus"></i> 关注');
					$.msg(message);
				} else if (code == -1) {
					$.msg(message);
				}
			})
		})
		$(".avatar_hover").on("mouseenter", function () {
			$(".thread-poptip-box").hide();
			$(this).find(".thread-poptip-box").show();
		})
		$(".avatar_hover").on("mouseleave", function () {
			$(".thread-poptip-box").hide();
		})

		// 右侧块 滚动到一定位置隐藏 开始

		var message_height = 0;
		
		var rightConHeight = $('.right_content.positionSticky').height();
		$(window).scroll(function () {
			var leftConHeight = $('.left_content').height();
			var message_height2 = $(".message_card .message").height();

			if (message_height2 != message_height) {
				message_height = message_height2;
			}
			if(leftConHeight > rightConHeight) {
				if (window.pageYOffset > message_height) {
					$(".rightbox_card_hidden").hide();
				} else {
					$(".rightbox_card_hidden").show();
				}
			}
			
		});
		// 右侧块 滚动到一定位置隐藏 结束
		//广告

		// function ad_count_request(data, type, adkey, num, func) {
		// 	$.xpost('//www.kanxue.com/advertisement-request.htm', "data=" + data + "&type=" + type +
		// 		"&adkey=" + adkey + "&num=" + num,
		// 		function (code, message) {
		// 			if (func) func();
		// 		})
		// }
		var adpostdata = $("#thread_ad").data('thread_postdata');
		var adkey = "ObC3bqE_2FEQvfQCW148XNXw_3D_3D";
		// ad_count_request(adpostdata, 1, adkey, 1);
		$("#thread_ad").click(function () {
			var that = $(this);
			var href = $(this).data('href');
			$(that).attr('target', "_blank");
			$(that).attr('href', href);
			// ad_count_request(adpostdata, 2, adkey, 0, function () {
			// 	$(that).attr('target', "_blank");
			// 	$(that).attr('href', href);

			// });

		});

		$(".fieldset .attachlist a.attach_li").on("click", function () {
			var _this = this;
			if ($(".down_golds").length > 0) {
				$.confirm($(".down_golds").text(), function () {
					window.open($(_this).attr("data-href"));
				})
			} else {
									window.open($(_this).attr("data-href")); 
							}
		})


		$("div.message").on("click", "table.syntaxhighlighter",function (event) {
			const rect = this.getBoundingClientRect();
            const afterX = rect.right + 105; // 调整伪元素的位置
            const afterY = rect.top + 125; // 调整伪元素的位置

            // 检查点击位置是否在伪元素的范围内
            if (event.clientX <= afterX && event.clientX >= rect.right && event.clientY <= afterY && event.clientY >= rect.top) {
				$('#fullScreenModal .modal-dialog .modal-content').html($(event.target).clone());
				$('#fullScreenModal').modal('show');
				
            }

		})
	});
</script>

<div style="position: absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);" class="modal fade bd-example-modal-sm" id="wxpay_modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">

    <div class="modal-content text-center ">
        <div class="" style="height: 55px; border-bottom: 1px solid rgba(204, 204, 204, 0.26); background-image: url(./view/img/pay_s.png); background-repeat: no-repeat; background-position: bottom center;">
            <button type="button" class="close mr-3" style="margin-top: 1.5rem;" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
        </div>
        <div class="wxpay_modal_body">

        </div>
    </div>
</div>
</div>
<script>
var jpay_form = $('#pay_kx');
var jkxpay = $('.kx-pay');
var rid = 0;
var check_handle = null;

function topay(){
    clearInterval(check_handle);
    check_handle = null;
    var valtype = $("input[name='reward_type']:checked").val();
    var rmbstype = $("input[name='reward_rmbs']:checked").val();
    if(!valtype) { alert('请您选择一个支付方式!'); return false; }
    if(rmbstype < 1) {
        alert("打赏金额不能少于1雪花");
        return false;
    }else if(valtype == 1){
        if(_is_weixin) {
            $.alert('请用其它浏览器打开再用赞赏功能!');
            return false;
        }

        window.Popup = window.open('about:blank', '_blank','width='+window.screen.width+',height='+window.screen.height+', ...');
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                
                Popup.blur();
                Popup.opener.focus();
                Popup.location = 'reward_pay-reward_alipay-'+ message +'.htm';
                jkxpay.button('reset');
                $('.reward').modal('hide');
                check_setInterval(message);
            } else if(code < 0) {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            } else {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 2){
        var postdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-reward_remainder.htm', postdata, function(code, message) {
            if(code == 0) {
                $.alert(message);
                jkxpay.button('reset');
                $('.reward').modal('hide');
                window.location.reload();
            } else if(code < 0) {
               $.alert(message);
                jkxpay.button('reset');
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 3) {

        // $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                //微信支付
                $.xget('reward_pay-wxpay-'+ message +'.htm',function(cd,msg) {
                    if(cd == 0) {
                        check_setInterval(message);

                        //$(".wxpay_code img").attr('src', 'http://paysdk.weixin.qq.com/example/qrcode.php?data='+ msg);
                        var wx_img = '<div class="pt-3 text-center"><img src="./view/img/wxpay2.png" style="height: 40px;"></div>\
                        <div class="modal-body wxpay_code pt-3 pb-3">\
                            <div  style="width: 80%;text-align:center; margin: 0 auto;">\
                                <span class="wx_img"><img alt="扫码支付" style="width: 60%;" src="//bbs.kanxue.com/reward_pay-wxcode-'+ xn.urlencode(msg) +'.htm"/></span>\
                                <span class="pay_success_shadow" style="display: none;"></span>\
                            </div>\
                            <div class="text-center text-muted mt-3">打开微信扫一扫，即可完成支付</div>\
                            <div class="swal2-icon swal2-success swal2-animate-success-icon">\
                                <span class="swal2-success-line-tip "></span>\
                                <span class="swal2-success-line-long "></span></div></div>';  
                        $(".wxpay_modal_body").html(wx_img);
                        jkxpay.button('reset');
                        $(".reward").modal('hide');
                        $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
                        $('#wxpay_modal').modal('show');
                    } else {
                        $.alert(msg);
                        jkxpay.button('reset');
                    }
                })
                return false;
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
      
        return false;

    }else{
        $('.reward').modal('hide');
        return false;
    }
}

function check_status(rid) {
  var val_type = $("input[name='reward_type']:checked").val();
  $.xpost('reward_pay-check.htm', {checkid: rid}, function(code, message) {
    if(code == 0) {
      if(val_type == 1) {
        Popup.close();
      }
      $.alert('恭喜您，赞赏成功！');
      setTimeout(function() {
                 window.location.reload();
      }, 3000);
      // if(check_handle) {
        clearInterval(check_handle);
        check_handle = null;
      // }
    } else {
      return false;
    }
  });
}

function check_setInterval(rid) {
  check_handle = setInterval(function() {
    check_status(rid);
  }, 3000);
}

window._is_weixin = function() {
  var _ua = window.navigator.userAgent.toLowerCase();
  if (_ua.match(/MicroMessenger/i) == 'micromessenger') {
      return true;
  } else {
      return false;
  }
}()


$("select.reward_reason").change(function(){

    console.log( $("select.reward_reason option:selected").val());
    var reward_reason = $("select.reward_reason option:selected").val()
    if (reward_reason != 0) {
        $(".reward_reason_textarea").val($("select.reward_reason option:selected").val());
    }
    
    
})

</script><script>
var jform_appeal = $('#form_appeal');
var appeal_submit = $('#appeal_submit');

appeal_submit.on('click', function() {
    jform_appeal.reset();
    appeal_submit.button('loading');
    var postdata = jform_appeal.serialize();
    
    $.xpost(jform_appeal.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	appeal_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 2000);
        } else {
    	$.alert(message);
    	appeal_submit.button('reset');
        }
    });
    return false;
});

 $('#appeal').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
	var pid = button.data('pid');
	var modal = $(this);
	modal.find('.modal-body #pid').val(pid);

})
</script><script>

var jform_report = $('#form_report');
var report_submit = $('#report_submit');

report_submit.on('click', function() {
    jform_report.reset();
    report_submit.button('loading');
    var postdata = jform_report.serialize();
    
    $.xpost(jform_report.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	report_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 1000);
        } else {
    	$.alert(message);
    	report_submit.button('reset');
        }
    });
    return false;
});

$('#report').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
    var tid = button.data('tid');
    var pid = button.data('pid');
    var modal = $(this);

    modal.find('.modal-body #tid').val(tid);
    modal.find('.modal-body #pid').val(pid);
})

var jform_sqtj = $('#form_sqtj');
var sqtj_submit = $('#sqtj_submit');

sqtj_submit.on('click', function() {
    jform_sqtj.reset();
    sqtj_submit.button('loading');
    var postdata = jform_sqtj.serialize();
    
    $.xpost(jform_sqtj.attr('action'), postdata, function(code, message) {
        if(code == 0) {
        $.alert(message);
        sqtj_submit.button('reset');
        setTimeout(function(){window.location.reload();
            }, 1000);
        } else {
        $.alert(message);
        sqtj_submit.button('reset');
        }
    });
    return false;
});

$('#sqtj').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget)
    var tid = button.data('tid');
    var pid = button.data('pid');
    var modal = $(this);

    modal.find('.modal-body #tid').val(tid);
    modal.find('.modal-body #pid').val(pid);
})
</script><!--游客下载附件关注微信公众号-->
<div class="modal fade download_code" id="download_code" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">游客下载提示</h5>
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                                <span aria-hidden="true">×</span>
	                        </button>
	                        
                        </div>
                        <form id="form_download" action="https://bbs.kanxue.com/thread-281889.htm" method="post" target="_blank">
                                <div class="modal-body text-center">
                                    <input id="aid" name="aid" value="0" type="hidden">
                                    <dl class="row">
                                    	<dd class="text-left" style="width:50%">
                                        	<div style="font-size:14px">
                                        		<div>1.请先关注公众号。</div>
                                        		<div>2.点击菜单"更多"。</div>
                                        		<div>3.选择获取下载码。</div>
                                        	</div>
                                    	</dd>
                                    	<dt><img src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/wxgz.jpg" width="80%"></dt>
                                    </dl>
                                    <fieldset class="form-group">
                						<input class="form-control" type="text" id="download_code" name="download_code" placeholder="请输入下载码" value="">
                					</fieldset>
                                </div>
                                <div class="modal-footer">
                                        <button id="download_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">下载</button>
                                </div>
                        </form>
                </div>
        </div>
</div>
<script>

var jform_download = $('#form_download');
var jdownload_submit = $('#download_submit');

    jdownload_submit.on('click', function() {
        jform_download.reset();
        jdownload_submit.button('loading');
        var postdata = jform_download.serialize();

        var aid2 = jform_download.find('.modal-body #aid').val();
        
        $.xpost(jform_download.attr('action'), postdata, function(code, message) {
            if(code == 0) {
    	       	jdownload_submit.button('下载中...');
    	       	var href = "attach-download-"+aid2+"-"+message+".htm";
    		window.location = href;
    		setTimeout(function() {
                        jdownload_submit.button('reset');
                        jform_download.find('.modal-body #download_code').val('');
                    }, 1500);
    		
            } else {
    	    	$.alert(message);
    	    	jdownload_submit.button('reset');
            }
        });
        return false;
    });

    $('#download_code').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget)
        var aid = button.data('aid');
        var modal = $(this);
        var down_action="attach-download_code-"+aid+".htm";

        modal.find('.modal-body #aid').val(aid);
        modal.find('#form_download').attr('action', down_action);
    })
</script><script>
var page = '1';
$('#thumb').click(function() {
	var threadid = '281889';
	var type = 1;
	var num = parseInt($('#thread_thumb_num').text());
	var postdata = 'threadid=' + threadid + '&type=1&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
		if(code == 0) {
			var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>&nbsp;<span style="color: #0099ee;">已赞</span>';
			$('#thumb').children('a').html(s);
			$('#thread_thumb_num').text(num + 1);
			$.tips('感谢您的赏识！您已向主题帖作者发送 '+message+' 个雪币，表达感谢', $(that), {
				tips:1,
				time: 2000,
				tips: [1,'#748691']

			});
		} else {
			$.tips(message, $(that), {
				tips: 1,
				time: 2000,
				tips: [1,'#748691']

			});
		}
	})
})
</script>

<script>
$(document).on('click','.reply_thumb',function(){
	
	var index = $('.reply_thumb').index(this);
	var threadid = $(this).find('input').eq(0).val();
	var praised_uid = $(this).find('input').eq(1).val();
	var pid = $(this).find('input').eq(2).val();
	var num = parseInt($('.thumb_num').eq(index).text());
	
	var postdata = 'threadid=' + threadid + '&praised_uid=' + praised_uid +'&pid=' + pid + '&type=2&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
    	if(code == 0) {
            var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>';
            var new_num = num + 1;
            $('.reply_thumb').eq(index).children('a').html(s);
	    $('.thumb_num').eq(index).text(num + 1);
	    	$.tips('英雄所见略同！您已向该回帖发送  '+message+' 个雪币，表达感谢', $(that), {
			tips: [1,'#748691'],
			time: 4000,
			
		});
        } else {
		$.tips(message, $(that), {
			
			time: 4000,
			tips: [1,'#748691']
		});
	}
	})
})
</script><script>
xn_read_unread({"281889": "1733930714"}, 281889);
</script><script>
jsearch_form = $('#search_form');
jsearch_form.on('submit', function() {
	var keyword = jsearch_form.find('input[name="keyword"]').val();
	var url = xn.url('search-'+xn.urlencode(keyword));
	window.location = url;
	return false;
});
</script><script>
// 语法高亮
if($('div.message pre').length > 0) {
	$.require_css('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.css');
	$.require('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.js', function() {
		SyntaxHighlighter.all();
	});
}
function quickCodeHandler(e) {
	var target = e.target,
		highlighterDiv = $(e.target).parents('.syntaxhighlighter'),
		container = $(e.target).parents('.container').eq(0),
		textarea = document.createElement('textarea'),
		highlighter;

	if (!container || !highlighterDiv || container.find('textarea').length > 0)
		return;

	// highlighter = getHighlighterById(highlighterDiv.id);

	
	// add source class name
	highlighterDiv.addClass('source')
	// Have to go over each line and grab it's text, can't just do it on the
	// container because Firefox loses all \n where as Webkit doesn't.
	var lines = container[0].childNodes,
		code = [];
		console.log(lines)
	for (var i = 0; i < lines.length; i++)
		code.push(lines[i].innerText || lines[i].textContent);

	// using \r instead of \r or \r\n makes this work equally well on IE, FF and Webkit
	code = code.join('\r');

	// For Webkit browsers, replace nbsp with a breaking space
	code = code.replace(/\u00a0/g, " ");

	// inject <textarea/> tag
	textarea.appendChild(document.createTextNode(code));
	container[0].appendChild(textarea);

	// preselect all text
	textarea.focus();
	textarea.select();

	// set up handler for lost focus
	$(textarea).off('blur').on('blur', function(e)
	{
		textarea.parentNode.removeChild(textarea);
		highlighterDiv.removeClass('source')
	})
	
};
$(".syntaxhighlighter .code").off('dblclick').on("dblclick",function(e){
	
	quickCodeHandler(e)
})
</script>

<!-- 目录生成JS -->
<script src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/tocbot.min.js.下载"></script>
<script>
	$(function () {
		// 目录生成 start
		var header_div = ['h1', 'h2', 'h3'];
		var show_tocbot = 0;
		for (var i = 0; i < header_div.length; i++) {
			var h_ob = $(".message_card .message " + header_div[i]);

			if (h_ob.length > 0) show_tocbot = 1;
			h_ob.each(function (index) {
				// $('.toc-tree a[href="#'+$(this).attr("id")+'"]')
				$(this).attr("id", "msg_header_" + header_div[i] + "_" + index);
			});
		}
		if (show_tocbot == 1) {
			$(".show_tocbot").show();
		}
		tocbot.init({
			// Where to render the table of contents.
			tocSelector: '.js-toc',
			// Where to grab the headings to build the table of contents.
			contentSelector: '.message_card .message',
			// Which headings to grab inside of the contentSelector element.
			headingSelector: 'h1, h2, h3',
			// For headings inside relative or absolute positioned containers within content.
			hasInnerContainers: true,
		});
		// $(window).on("scroll",function(){
		// 	console.log(1);
		// })

		// 选择需要观察变动的节点
		const targetNode = document.getElementById('js-toc');

		// 观察器的配置（需要观察什么变动）
		const config = {
			attributes: true,
			childList: true,
			subtree: true
		};

		// 当观察到变动时执行的回调函数
		const callback = function (mutationsList, observer) {
			// Use traditional 'for loops' for IE 11
			for (let mutation of mutationsList) {
				// if (mutation.type === 'childList') {
				// 	console.log('A child node has been added or removed.');
				// }
				// else 
				if (mutation.type === 'attributes') {
					targetNode.scrollTo(0, document.getElementsByClassName("is-active-li")[0].offsetTop);
				}
			}
		};

		// 创建一个观察器实例并传入回调函数
		const observer = new MutationObserver(callback);
		// 以上述配置开始观察目标节点
		observer.observe(targetNode, config);
		// 目录生成 end
		


	})
</script>

<script async="" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/f(1).txt" crossorigin="anonymous" data-checked-head="true"></script>
<script>
	if ($(window).width() > 1200) {
		(adsbygoogle = window.adsbygoogle || []).push({});
	}
</script>
<!-- 统计代码 -->
<script>
	(function() {
		var tracking_code = 'TC_1735530867_9693';
		var button_selector = '.bbs_thread';
		var page_url = 'https://bbs.kanxue.com/thread-284686.htm';

		// 曝光统计
		window.addEventListener('load', function() {
			$.xpost('//www.kanxue.com/track-exposure.htm', {
				tracking_code: tracking_code,
				page_url: page_url,
				type: 1
			},function(code, message) {});
		});
		// 点击统计
		if(document.querySelector(button_selector)) {
			document.querySelector(button_selector).addEventListener('click', function() {
				$.xpost('//www.kanxue.com/track-click.htm', {
					tracking_code: tracking_code,
					page_url: page_url,
					type: 2
				});
			});
		}
		
	})();
</script>
<ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;" data-ad-status="unfilled"><div id="aswift_0_host" style="border: none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" browsingtopics="true" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/ads.html" data-google-container-id="a!1" tabindex="0" title="Advertisement" aria-label="Advertisement" data-load-complete="true"></iframe></div></ins><iframe src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/aframe.html" width="0" height="0" style="display: none;"></iframe><div class="layui-layer-move"></div></body><iframe id="google_esf" name="google_esf" src="./[原创]自动化采集Android系统级设备指纹对抗&amp;如何四两拨千斤_-Android安全-看雪-安全社区_安全招聘_kanxue.com_files/zrt_lookup_fy2021.html" style="display: none;"></iframe></html>